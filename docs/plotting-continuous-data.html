<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>31 Plotting continuous data | R Handbook for Epidemiologists</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.15/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R Handbook for Epidemiologists</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome</a></li>
<li class="book-part">About this book</li>
<li><a class="" href="style-and-editorial-notes.html"><span class="header-section-number">2</span> Style and editorial notes</a></li>
<li><a class="" href="datasets-used.html"><span class="header-section-number">3</span> Datasets used</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">4</span> R Basics</a></li>
<li><a class="" href="importing-data.html"><span class="header-section-number">5</span> Importing data</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="errors-warnings-1.html"><span class="header-section-number">7</span> Errors &amp; Warnings</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data.html"><span class="header-section-number">8</span> Cleaning data</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with Dates</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">10</span> Missing data</a></li>
<li><a class="" href="groupingaggregating-data.html"><span class="header-section-number">11</span> Grouping/aggregating data</a></li>
<li><a class="" href="joining-matching-datasets.html"><span class="header-section-number">12</span> Joining &amp; matching datasets</a></li>
<li><a class="" href="charactersstrings.html"><span class="header-section-number">13</span> Characters/strings</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">14</span> De-duplication</a></li>
<li><a class="" href="ifelse-for-loops.html"><span class="header-section-number">15</span> if/else &amp; ‘for’ loops</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">16</span> Iteration</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="cat-analysis.html"><span class="header-section-number">17</span> Analysis</a></li>
<li><a class="" href="descriptive-analysis.html"><span class="header-section-number">18</span> Descriptive analysis</a></li>
<li><a class="" href="simple-statistical-tests.html"><span class="header-section-number">19</span> Simple statistical tests</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">20</span> Standardization</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">21</span> Moving averages</a></li>
<li><a class="" href="outbreak-detection.html"><span class="header-section-number">22</span> Outbreak detection</a></li>
<li><a class="" href="time-series-analysis.html"><span class="header-section-number">23</span> Time series analysis</a></li>
<li><a class="" href="epidemicmodels.html"><span class="header-section-number">24</span> Epidemic modeling</a></li>
<li><a class="" href="modeling.html"><span class="header-section-number">25</span> Modeling</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">26</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis-1.html"><span class="header-section-number">27</span> Survival analysis</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">28</span> GIS basics</a></li>
<li class="book-part">Data Vizualization</li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">29</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">30</span> Epidemic curves</a></li>
<li><a class="active" href="plotting-continuous-data.html"><span class="header-section-number">31</span> Plotting continuous data</a></li>
<li><a class="" href="plotting-discrete-variables.html"><span class="header-section-number">32</span> Plotting discrete variables</a></li>
<li><a class="" href="tables.html"><span class="header-section-number">33</span> Tables</a></li>
<li><a class="" href="age-pyramids.html"><span class="header-section-number">34</span> Age pyramids</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">35</span> Diagrams</a></li>
<li><a class="" href="combination-analysis.html"><span class="header-section-number">36</span> Combination analysis</a></li>
<li><a class="" href="heatmaps-density-plots.html"><span class="header-section-number">37</span> Heatmaps &amp; density plots</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">38</span> Transmission Chains</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">39</span> Phylogenetic trees</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">40</span> Interactive plots</a></li>
<li class="book-part">Advanced</li>
<li><a class="" href="advanced-rstudio.html"><span class="header-section-number">41</span> Advanced RStudio</a></li>
<li><a class="" href="relational-databases.html"><span class="header-section-number">42</span> Relational databases</a></li>
<li><a class="" href="routine-reports.html"><span class="header-section-number">43</span> Routine reports</a></li>
<li><a class="" href="r-markdown.html"><span class="header-section-number">44</span> R Markdown</a></li>
<li><a class="" href="shiny-basics.html"><span class="header-section-number">45</span> Shiny basics</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">46</span> Collaboration</a></li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">47</span> Writing functions</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">48</span> R on network drives</a></li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">49</span> Directory interactions</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="plotting-continuous-data" class="section level1 tabset tabset-fade" number="31">
<h1>
<span class="header-section-number">31</span> Plotting continuous data<a class="anchor" aria-label="anchor" href="#plotting-continuous-data"><i class="fas fa-link"></i></a>
</h1>
<p>For appropriate plotting of continuous data, e.g. age, clinical measurements, distance, etc.</p>
<!-- ======================================================= -->
<div id="overview-27" class="section level2 tabset tabset-fade" number="31.1">
<h2>
<span class="header-section-number">31.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview-27"><i class="fas fa-link"></i></a>
</h2>
<p>As usual, R has built-in functions for quick visualisations. You can opt to install additional packages with more functionality - this is often recommended for presentation-ready visualisations. Specifically, you can use:</p>
<ul>
<li>the <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> function from the <strong>graphics</strong> package (installed automatically with <strong>base R</strong>)</li>
<li>the <code>ggplot()</code> function from the <strong>ggplot2</strong> package, or</li>
</ul>
<p>Visualisations covered here include:</p>
<ul>
<li>
<p>Plots for one continuous variable:</p>
<ul>
<li>
<strong>Box plots</strong> (also called box and whisker), in which the box represents the 25th, 50th, and 75th percentile of a continuous variable, and the line outside of this represent tail ends of distribution of the the continuous variable, and dots represent outliers.</li>
<li>
<strong>Violin plots</strong>, which are similar to histograms in that they show the distribution of a continuous variable based on the symettrical width of the ‘violin’.</li>
<li>
<strong>Jitter plots</strong>, which visualise the distribution of a continuous variable by showing all values as dots, rather than collectively as one larger shape. Each dot is ‘jittered’ so that they can all (mostly) be seen, even where two have the same value.</li>
</ul>
</li>
<li><p><strong>Scatter plots</strong> for two continuous variables.</p></li>
</ul>
<pre><code>## Warning: Removed 88 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning: Removed 88 rows containing non-finite values (stat_ydensity).</code></pre>
<pre><code>## Warning: Removed 88 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-434-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-434-2.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-434-3.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-434-4.png" width="50%"></p>
<!-- ======================================================= -->
</div>
<div id="preparation-21" class="section level2 tabset tabset-fade" number="31.2">
<h2>
<span class="header-section-number">31.2</span> Preparation<a class="anchor" aria-label="anchor" href="#preparation-21"><i class="fas fa-link"></i></a>
</h2>
<p>Preparation includes ensuring you have the correct packages, (<code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("ggplot2")</a></code> if needed), and ensuring your data is the correct class and format.</p>
<p>Convert character outcomes to numeric as needed:</p>
<pre><code>linelist &lt;- linelist %&gt;% 
  mutate(age = as.numeric(age))</code></pre>
<!-- ======================================================= -->
</div>
<div id="plotting-with-base-graphics" class="section level2 tabset tabset-fade" number="31.3">
<h2>
<span class="header-section-number">31.3</span> Plotting with base graphics<a class="anchor" aria-label="anchor" href="#plotting-with-base-graphics"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Plotting one continuous variable</strong></p>
<p>The in-built graphics package comes with the boxplot() function, allowing straight-forward visualisation of a continuous variable for the whole dataset (A below) or within different groups (B and C below). Note how with C, <code>outcome</code> and <code>gender</code> are written as <code>outcome*gender</code> such that the boxplots are for the four combinations of the two columns.</p>
<div class="sourceCode" id="cb755"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># For total population</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span>,
                  main <span class="op">=</span> <span class="st">"A) One boxplot() for total dataset"</span><span class="op">)</span> <span class="co"># Plot title</span>


<span class="co"># By subgroup</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">outcome</span><span class="op">*</span><span class="va">gender</span>,
                  data <span class="op">=</span> <span class="va">linelist</span>, <span class="co"># Here 'data' is specified so no need to write 'linelist$age' in line above.</span>
                  main <span class="op">=</span> <span class="st">"B) boxplot() by subgroup"</span><span class="op">)</span>

<span class="co"># By crossed subgroups</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">outcome</span><span class="op">*</span><span class="va">gender</span>,
                  data <span class="op">=</span> <span class="va">linelist</span>, <span class="co"># Here 'data' is specified so no need to write 'linelist$age' in line above.</span>
                  main <span class="op">=</span> <span class="st">"C) boxplot() by crossed groups"</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-435-1.png" width="33%"><img src="_main_files/figure-html/unnamed-chunk-435-2.png" width="33%"><img src="_main_files/figure-html/unnamed-chunk-435-3.png" width="33%"></p>
<p>Some further options with <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> shown below are:</p>
<ul>
<li>Boxplot width proportional to sample size (A)</li>
<li>violin plots, with notched representing the median and x around it (B; TO DO)</li>
<li>Horizontal (C)</li>
</ul>
<div class="sourceCode" id="cb756"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Varying width by sample size </span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span> <span class="op">~</span> <span class="va">linelist</span><span class="op">$</span><span class="va">outcome</span>,
                  varwidth <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># width varying by sample size</span>
                  main<span class="op">=</span><span class="st">"A) Proportional boxplot() widths"</span><span class="op">)</span>

                  
<span class="co"># Notched (violin plot), and varying width</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">outcome</span>,
        data<span class="op">=</span><span class="va">linelist</span>,
        notch<span class="op">=</span><span class="cn">TRUE</span>,      <span class="co"># notch at median</span>
        main<span class="op">=</span><span class="st">"B) Notched boxplot()"</span>,
        col<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gold"</span>,<span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span>,
        xlab<span class="op">=</span><span class="st">"Suppliment and Dose"</span><span class="op">)</span>

<span class="co"># Horizontal</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">outcome</span>,
        data<span class="op">=</span><span class="va">linelist</span>,
        horizontal<span class="op">=</span><span class="cn">TRUE</span>,  <span class="co"># flip to horizontal</span>
        col<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gold"</span>,<span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span>,
        main<span class="op">=</span><span class="st">"C) Horizontal boxplot()"</span>,
        xlab<span class="op">=</span><span class="st">"Suppliment and Dose"</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-436-1.png" width="33%"><img src="_main_files/figure-html/unnamed-chunk-436-2.png" width="33%"><img src="_main_files/figure-html/unnamed-chunk-436-3.png" width="33%"></p>
<p><strong>Plotting two continuous variables</strong></p>
<p>Scatter plots are helpful for visualising the correlation between two continuous variables.</p>
<p>Using base R, they can simple be visualisation with the <code>plot</code> function.</p>
<div class="sourceCode" id="cb757"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-437-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
<div id="plotting-with-ggplot" class="section level2 tabset tabset-fade" number="31.4">
<h2>
<span class="header-section-number">31.4</span> Plotting with ggplot<a class="anchor" aria-label="anchor" href="#plotting-with-ggplot"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Code syntax</strong></p>
<p>Ggplot has extensive functionality, and the same code syntax can be used for many different plot types.</p>
<p>A basic breakdown of the ggplot code is as follows:</p>
<pre><code>ggplot(data = linelist,
       aes(x = col1, y = col2),
       fill = "color")+  
  geom_boxplot() </code></pre>
<ul>
<li>
<code>ggplot()</code> starts off the function. You can specify the data and aesthetics (see next point) within the ggplot bracket, unless you are combining different data sources or plot types into one</li>
<li>
<code>aes()</code> stands for ‘aesthetics’, and is where the columns used for the visualisation are specified. For instance <code>aes(x = col1, y = col2)</code> to specify the data used for the x and y values (where y is the continuous variable in these examples).</li>
<li>
<code>fill</code> specifies the colour of the boxplot areas. One could also write <code>color</code> to specify outline or point colour.</li>
<li>
<code>geom_XXX</code> specifies what type of plot. Options include:
<ul>
<li>
<code>geom_boxplot()</code> for a boxplot</li>
<li>
<code>geom_violin()</code> for a violin plot</li>
<li>
<code>geom_jitter()</code> for a jitter plot</li>
<li>
<code>geom_point()</code> for a scatter plot</li>
</ul>
</li>
</ul>
<p>For more see section on <a href="#ggplottips">ggplot tips</a>).</p>
<p><strong>Plotting one continuous variable</strong></p>
<p>Below is code for creating <strong>box plots</strong>, for an entire dataset and by sub group. Note that for the subgroup breakdowns, the ‘NA’ values are also removed using dplyr, otherwise ggplot plots the age distribution for ‘NA’ as a separate boxplot.</p>
<div class="sourceCode" id="cb759"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Simple boxplot of one numeric variable</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>  <span class="co"># only y variable given (no x variable)</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"A) Simple ggplot() boxplot"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Removed 88 rows containing non-finite values (stat_boxplot).</code></pre>
<div class="sourceCode" id="cb761"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># B) Box plot by group</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, 
       <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>,         <span class="co"># numeric variable</span>
           x <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>      <span class="co"># group variable</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gold"</span><span class="op">)</span><span class="op">+</span>   <span class="co"># create the boxplot and specify colour</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"B) ggplot() boxplot by gender"</span><span class="op">)</span>      <span class="co"># main title</span></code></pre></div>
<pre><code>## Warning: Removed 61 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-438-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-438-2.png" width="50%"></p>
<p>Below is code for creating <strong>violin plots</strong> (<code>geom_violin</code>) and <strong>jitter plots</strong> (<code>geom_jitter</code>). One can specify that the ‘fill’ or ’color’is also determined by the data, thereby inserting these options within the <code>aes</code> bracket.</p>
<div class="sourceCode" id="cb763"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Violin plot by group</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, 
       <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>,         <span class="co"># numeric variable</span>
           x <span class="op">=</span> <span class="va">outcome</span>,      <span class="co"># group variable</span>
           fill <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co"># fill variable (color of boxes)</span>
  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                            <span class="co"># create the violin plot</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"A) ggplot() violin plot by gender"</span><span class="op">)</span>      <span class="co"># main title</span></code></pre></div>
<pre><code>## Warning: Removed 61 rows containing non-finite values (stat_ydensity).</code></pre>
<div class="sourceCode" id="cb765"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># B) Jitter plot by group</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, 
       <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>,         <span class="co"># numeric variable</span>
           x <span class="op">=</span> <span class="va">outcome</span>,      <span class="co"># group variable</span>
           color <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co"># Color variable</span>
  <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                            <span class="co"># create the violin plot</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"B) ggplot() violin plot by gender"</span><span class="op">)</span>      <span class="co"># main title</span></code></pre></div>
<pre><code>## Warning: Removed 61 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-439-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-439-2.png" width="50%"></p>
<p>To examine further subgroups, one can ‘facet’ the graph. This means the plot will be recreased within specified subgroups. One can use:</p>
<ul>
<li>
<code>facet_wrap()</code> - this will recreate the sub-graphs and present them alphabetically (typically, unless stated otherwise). You can invoke certain options to determine the look of the facets, e.g. <code>nrow=1</code> or <code>ncol=1</code> to control the number of rows or columns that the faceted plots are arranged within. See plot A below.</li>
<li>
<code>facet_grid()</code> - this is suited to seeing subgroups for particular combinations of discrete variables. See plot B below.</li>
</ul>
<div class="sourceCode" id="cb767"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Facet by one variable</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, <span class="co"># filter retains non-missing gender/outcome</span>
       <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>, x <span class="op">=</span> <span class="va">outcome</span>, fill<span class="op">=</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"A) A ggplot() boxplot by gender and outcome"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">gender</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># B) Facet across two variables</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, <span class="co"># filter retains non-missing gender/outcome</span>
       <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"A) A ggplot() boxplot by gender and outcome"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">outcome</span><span class="op">~</span><span class="va">gender</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-440-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-440-2.png" width="50%"></p>
<p>To turn the plot horizontal, flip the coordinates with <code>coord_flip</code>.</p>
<div class="sourceCode" id="cb768"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># By subgroup</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, <span class="co"># filter retains non-missing gender/outcome</span>
       <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>, x <span class="op">=</span> <span class="va">outcome</span>, fill<span class="op">=</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"B) A horizontal ggplot() boxplot by gender and outcome"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">gender</span><span class="op">~</span><span class="va">.</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-441-1.png" width="100%"></div>
<p><strong>Plotting two continuous variables</strong></p>
<p>Following similar syntax, <code>geom_point</code> will allow one to plot two continuous variables against eachother in a <strong>scatter plot</strong>. Here we again use <code>facet_grid</code> to show the interaction between two different discrete variables.</p>
<div class="sourceCode" id="cb769"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># By subgroup</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, <span class="co"># filter retains non-missing gender/outcome</span>
       <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>, x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"A horizontal ggplot() boxplot by gender and outcome"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">gender</span><span class="op">~</span><span class="va">outcome</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-442-1.png" width="100%"></div>
<!-- ======================================================= -->
</div>
<div id="resources-20" class="section level2 tabset tabset-fade" number="31.5">
<h2>
<span class="header-section-number">31.5</span> Resources<a class="anchor" aria-label="anchor" href="#resources-20"><i class="fas fa-link"></i></a>
</h2>
<p>There is a huge amount of help online, especially with ggplot. see:</p>
<ul>
<li><a href="http://r-statistics.co/ggplot2-cheatsheet.html" class="uri">http://r-statistics.co/ggplot2-cheatsheet.html</a></li>
<li><a href="https://biostats.w.uib.no/the-ggplot2-cheat-sheet-by-rstudio/" class="uri">https://biostats.w.uib.no/the-ggplot2-cheat-sheet-by-rstudio/</a></li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="epidemic-curves.html"><span class="header-section-number">30</span> Epidemic curves</a></div>
<div class="next"><a href="plotting-discrete-variables.html"><span class="header-section-number">32</span> Plotting discrete variables</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#plotting-continuous-data"><span class="header-section-number">31</span> Plotting continuous data</a></li>
<li><a class="nav-link" href="#overview-27"><span class="header-section-number">31.1</span> Overview</a></li>
<li><a class="nav-link" href="#preparation-21"><span class="header-section-number">31.2</span> Preparation</a></li>
<li><a class="nav-link" href="#plotting-with-base-graphics"><span class="header-section-number">31.3</span> Plotting with base graphics</a></li>
<li><a class="nav-link" href="#plotting-with-ggplot"><span class="header-section-number">31.4</span> Plotting with ggplot</a></li>
<li><a class="nav-link" href="#resources-20"><span class="header-section-number">31.5</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R Handbook for Epidemiologists</strong>" was written by the handbook team. It was last built on 2021-02-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
