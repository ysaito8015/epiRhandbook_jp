<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>11 Joining &amp; matching datasets | R Handbook for Epidemiologists</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.15/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R Handbook for Epidemiologists</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">About this book</li>
<li><a class="" href="style-and-editorial-notes.html"><span class="header-section-number">1</span> Style and editorial notes</a></li>
<li><a class="" href="datasets-used.html"><span class="header-section-number">2</span> Datasets used</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> R Basics</a></li>
<li><a class="" href="importing-and-exporting.html"><span class="header-section-number">4</span> Importing and exporting</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">5</span> R projects</a></li>
<li><a class="" href="suggested-packages.html"><span class="header-section-number">6</span> Suggested packages</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data.html"><span class="header-section-number">7</span> Cleaning data</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">8</span> Working with dates</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">9</span> Missing data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">10</span> Grouping data</a></li>
<li><a class="active" href="joining-matching-datasets.html"><span class="header-section-number">11</span> Joining &amp; matching datasets</a></li>
<li><a class="" href="charactersstrings.html"><span class="header-section-number">12</span> Characters/strings</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">13</span> De-duplication</a></li>
<li><a class="" href="iteration-and-loops.html"><span class="header-section-number">14</span> Iteration and loops</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="descriptive-analysis.html"><span class="header-section-number">15</span> Descriptive analysis</a></li>
<li><a class="" href="simple-statistical-tests.html"><span class="header-section-number">16</span> Simple statistical tests</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">17</span> Standardization</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">18</span> Moving averages</a></li>
<li><a class="" href="outbreak-detection.html"><span class="header-section-number">19</span> Outbreak detection</a></li>
<li><a class="" href="time-series-analysis.html"><span class="header-section-number">20</span> Time series analysis</a></li>
<li><a class="" href="epidemicmodels.html"><span class="header-section-number">21</span> Epidemic modeling</a></li>
<li><a class="" href="modeling.html"><span class="header-section-number">22</span> Modeling</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">23</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis-1.html"><span class="header-section-number">24</span> Survival analysis</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">25</span> GIS basics</a></li>
<li class="book-part">Data Vizualization</li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">26</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">27</span> Epidemic curves</a></li>
<li><a class="" href="plotting-continuous-data.html"><span class="header-section-number">28</span> Plotting continuous data</a></li>
<li><a class="" href="plotting-categorical-variables.html"><span class="header-section-number">29</span> Plotting categorical variables</a></li>
<li><a class="" href="tables.html"><span class="header-section-number">30</span> Tables</a></li>
<li><a class="" href="age-pyramids.html"><span class="header-section-number">31</span> Age pyramids</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">32</span> Diagrams</a></li>
<li><a class="" href="combination-analysis.html"><span class="header-section-number">33</span> Combination analysis</a></li>
<li><a class="" href="heatmaps-density-plots.html"><span class="header-section-number">34</span> Heatmaps &amp; density plots</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">35</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">36</span> Phylogenetic trees</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">37</span> Interactive plots</a></li>
<li class="book-part">Advanced</li>
<li><a class="" href="errors-warnings-1.html"><span class="header-section-number">38</span> Errors &amp; Warnings</a></li>
<li><a class="" href="advanced-rstudio.html"><span class="header-section-number">39</span> Advanced RStudio</a></li>
<li><a class="" href="relational-databases.html"><span class="header-section-number">40</span> Relational databases</a></li>
<li><a class="" href="routine-reports.html"><span class="header-section-number">41</span> Routine reports</a></li>
<li><a class="" href="r-markdown.html"><span class="header-section-number">42</span> R Markdown</a></li>
<li><a class="" href="shiny-basics.html"><span class="header-section-number">43</span> Shiny basics</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">44</span> Collaboration</a></li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">45</span> Writing functions</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">46</span> R on network drives</a></li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">47</span> Directory interactions</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="joining-matching-datasets" class="section level1 tabset tabset-fade" number="11">
<h1>
<span class="header-section-number">11</span> Joining &amp; matching datasets<a class="anchor" aria-label="anchor" href="#joining-matching-datasets"><i class="fas fa-link"></i></a>
</h1>
<!-- ======================================================= -->
<div id="overview-6" class="section level2 tabset tabset-fadehosp_info" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview-6"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-figure"><img src="images/left-join.gif" width="50%"></div>
<p>This page describes common “joins” and also probabilistic matching between dataframes.</p>
<!-- ======================================================= -->
</div>
<div id="preparation-2" class="section level2 tabset tabset-fade" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Preparation<a class="anchor" aria-label="anchor" href="#preparation-2"><i class="fas fa-link"></i></a>
</h2>
<p>Because traditional joins (non-probabilistic) can be very specific, requiring exact string matches, you may need to do cleaning on the datasets <em>prior to</em> the join (e.g. change spellings, change case to all lower or upper).</p>
<!-- ======================================================= -->
<div id="datasets" class="section level3 tabset tabset-fade" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> Datasets<a class="anchor" aria-label="anchor" href="#datasets"><i class="fas fa-link"></i></a>
</h3>
<p>In the joining examples, we’ll use the following datasets:</p>
<ol style="list-style-type: decimal">
<li>A “miniature” version of the <code>linelist</code>, containing only the columns <code>case_id</code>, <code>date_onset</code>, and <code>hospital</code>, and only the first 10 rows<br>
</li>
<li>A separate dataframe named <code>hosp_info</code>, which contains more details about each hospital</li>
</ol>
<p><strong>“miniature” linelist</strong></p>
<p>Below is the miniature linelist used for demonstration purposes:</p>
<div class="sourceCode" id="cb392"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_mini</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span>                 <span class="co"># start with original linelist</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">case_id</span>, <span class="va">date_onset</span>, <span class="va">hospital</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># select columns</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>                                    <span class="co"># keep only the first 10 rows</span></code></pre></div>
<div id="htmlwidget-6be64e99dc9e3e3151a2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6be64e99dc9e3e3151a2">{"x":{"filter":"none","data":[["6c286a","5fe599","6285c9","893f25","c4e706","275cc7","133ee7","dbebea","788a99","2978ac"],["2014-04-27","2014-05-13","2014-05-14","2014-05-21","2014-05-23","2014-05-27","2014-05-27","2014-06-02","2014-06-06","2014-06-06"],["Missing","Other","Missing","Military Hospital","Missing","Central Hospital","Missing","Port Hospital","Port Hospital","Port Hospital"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>date_onset<\/th>\n      <th>hospital<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p><strong>Hospital Information dataframe</strong></p>
<p>Below is the separate dataframe with additional information about each hospital.</p>
<div id="htmlwidget-61928258c7b0c95730d2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-61928258c7b0c95730d2">{"x":{"filter":"none","data":[["central hospital","military","military","port","St. Mark's","ignace","sisters"],[1950280,40500,10000,50280,12000,5000,4200],["Tertiary","Secondary","Primary","Secondary","Secondary","Primary","Primary"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>hosp_name<\/th>\n      <th>catchment_pop<\/th>\n      <th>level<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":7,"columnDefs":[{"className":"dt-right","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[7,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
<div id="pre-cleaning" class="section level3 tabset tabset-fade" number="11.2.2">
<h3>
<span class="header-section-number">11.2.2</span> Pre-cleaning<a class="anchor" aria-label="anchor" href="#pre-cleaning"><i class="fas fa-link"></i></a>
</h3>
<p>Because traditional (non-probabilistic) joins are case-sensitive and require exact string matches, we will clean-up the <code>hosp_info</code> dataset prior to the joins.</p>
<p><strong>Identify differences</strong></p>
<p>We need the values of <code>hosp_name</code> column in <code>hosp_info</code> dataframe to match the values of <code>hospital</code> column in the <code>linelist</code> dataframe.</p>
<p>Here are the values in <code>linelist_mini</code>:</p>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">linelist_mini</span><span class="op">$</span><span class="va">hospital</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Missing"           "Other"             "Military Hospital" "Central Hospital"  "Port Hospital"</code></pre>
<p>and here are the values in <code>hosp_info</code>:</p>
<div class="sourceCode" id="cb395"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">hosp_info</span><span class="op">$</span><span class="va">hosp_name</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "central hospital" "military"         "port"             "St. Mark's"       "ignace"           "sisters"</code></pre>
<p><strong>Align matching values</strong></p>
<p>We begin by cleaning the values in <code>hosp_name</code>. We use logic to code the values in the new column using <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> (LINK). We correct the hospital names that exist in both dataframes, and leave the others as they are (see <code>TRUE ~ hosp_name</code>).</p>
<p><span style="color: orange;"><strong><em>CAUTION:</em></strong> Typically, one should create a new column (e.g. <code>hosp_name_clean</code>), but for ease of demonstration we show modification of the old column</span></p>
<div class="sourceCode" id="cb397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hosp_info</span> <span class="op">&lt;-</span> <span class="va">hosp_info</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    hosp_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
      <span class="va">hosp_name</span> <span class="op">==</span> <span class="st">"military"</span>          <span class="op">~</span> <span class="st">"Military Hospital"</span>,
      <span class="va">hosp_name</span> <span class="op">==</span> <span class="st">"port"</span>              <span class="op">~</span> <span class="st">"Port Hospital"</span>,
      <span class="va">hosp_name</span> <span class="op">==</span> <span class="st">"St. Mark's"</span>        <span class="op">~</span> <span class="st">"St. Mark's Maternity Hospital (SMMH)"</span>,
      <span class="va">hosp_name</span> <span class="op">==</span> <span class="st">"central hospital"</span>  <span class="op">~</span> <span class="st">"Central Hospital"</span>,
      <span class="cn">TRUE</span>                             <span class="op">~</span> <span class="va">hosp_name</span>
      <span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<p>We now see that the hospital names that appear in both dataframe are aligned. There are some hospitals in <code>hosp_info</code> that are not present in <code>linelist</code> - we will deal with these later, in the join.</p>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">hosp_info</span><span class="op">$</span><span class="va">hosp_name</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Central Hospital"                     "Military Hospital"                    "Port Hospital"                        "St. Mark's Maternity Hospital (SMMH)"
## [5] "ignace"                               "sisters"</code></pre>
<p>If you need to convert to all values UPPER or lower case, use these functions from <strong>stringr</strong>, as shown in the page on characters/strings (LINK).</p>
<p><code>str_to_upper()</code><br><code>str_to_upper()</code><br><code>str_to_title()</code></p>
<!-- ======================================================= -->
</div>
</div>
<div id="dplyr-joins" class="section level2 tabset tabset-fade" number="11.3">
<h2>
<span class="header-section-number">11.3</span> <strong>dplyr</strong> joins<a class="anchor" aria-label="anchor" href="#dplyr-joins"><i class="fas fa-link"></i></a>
</h2>
<p><strong>dplyr</strong> offers several different joins. Below they are described, with some simple use cases. Many thanks to <a href="https://github.com/gadenbuie/tidyexplain/tree/master/images">https://github.com/gadenbuie</a> for the moving images!</p>
<!-- ======================================================= -->
<div id="general-syntax" class="section level3 tabset tabset-fade" number="11.3.1">
<h3>
<span class="header-section-number">11.3.1</span> General syntax<a class="anchor" aria-label="anchor" href="#general-syntax"><i class="fas fa-link"></i></a>
</h3>
<p><strong>General function structure</strong></p>
<p>Any of these join commands can be run independently, like below.</p>
<p>An object is being created, or re-defined: dataframe 2 is being joined to dataframe 1, on the basis of matches between the “ID” column in <code>df1</code> and “identifier” column in <code>df2</code>. Because this example uses <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code>, any rows in <code>df2</code> that do not match to <code>df1</code> will be dropped.</p>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">df1</span>, <span class="va">df2</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span> <span class="op">=</span> <span class="st">"identifier"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The join commands can also be run within a pipe chain. The first dataframe <code>df1</code> is known to be the dataframe that is being passed through the pipes. An example is shown below, in context with some additional non-important <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> commands before the join.</p>
<div class="sourceCode" id="cb401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">df1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">var1</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>        <span class="co"># for demonstration only</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>lag <span class="op">=</span> <span class="va">day</span> <span class="op">+</span> <span class="fl">7</span><span class="op">)</span> <span class="op">%&gt;%</span>    <span class="co"># for demonstration only</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">df1</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span> <span class="op">=</span> <span class="st">"identifier"</span><span class="op">)</span><span class="op">)</span>  <span class="co"># join df2 to df1</span></code></pre></div>
<p><strong>Join columns (<code>by =</code>)</strong></p>
<p>You must specify the columns in each dataset in which the values must match, using the arguemnt <code>by =</code>. You have a few options:</p>
<ul>
<li>Specify only one column name (<code>by = "ID"</code>) - this only works if this exact column name is present in both dataframes!<br>
</li>
<li>Specify the different names (<code>by = c("ID" = "Identifier")</code> - use this if the column names are different in the 2 dataframes<br>
</li>
<li>Specify multiple columns to match on (<code>by = c("ID" = "Identifier", "date_onset" = "Date_of_Onset")</code>) - this will require exact matches on multiple columns for rows to join.</li>
</ul>
<p><span style="color: orange;"><strong><em>CAUTION:</em></strong> Joins are case-specific! Therefore it is useful to convert all values to lowercase or uppercase prior to joining. See the page on characters/strings.</span></p>
</div>
<div id="section" class="section level3" number="11.3.2">
<h3>
<span class="header-section-number">11.3.2</span> <a class="anchor" aria-label="anchor" href="#section"><i class="fas fa-link"></i></a>
</h3>
<!-- ======================================================= -->
</div>
<div id="add-columns-left-right-joins" class="section level3" number="11.3.3">
<h3>
<span class="header-section-number">11.3.3</span> Add columns: left &amp; right joins<a class="anchor" aria-label="anchor" href="#add-columns-left-right-joins"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A left or right join is commonly used to add information to a dataframe</strong> - new information is added only to rows that already exist in the baseline dataframe.</p>
<p>These are common joins in epidemiological work - they are used to add information from one dataset into another.</p>
<p><em>The order of the dataframes is important</em>.</p>
<ul>
<li>In a <em>left join</em>, the <em>first</em> (left) dataframe listed is the baseline<br>
</li>
<li>In a <em>right join</em>, the <em>second</em> (right) dataframe listed is the baseline</li>
</ul>
<p><strong>All rows of the baseline dataframe are kept.</strong> Information in the secondary dataframe is joined to the baseline dataframe <em>only if there is a match via the identifier column(s)</em>. In addition:<br>
* Rows in the secondary dataframe that do not match are dropped.<br>
* If there are many baseline rows that match to one row in the secondary dataframe (many-to-one), the baseline information is added to each matching baseline row.<br>
* If a baseline row matches to multiple rows in the secondary dataframe (one-to-many), all combinations are given, meaning new rows may be added to your returned dataframe!</p>
<p><img src="images/left-join.gif" width="50%"><img src="images/right-join.gif" width="50%"></p>
<p><strong>Example</strong></p>
<p>Below is the output of a <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code> of <code>hosp_info</code> (secondary dataframe) <em>into</em> <code>linelist_mini</code> (baseline dataframe). Note the following:</p>
<ul>
<li>All original rows of the baseline dataframe <code>linelist_mini</code> are kept<br>
</li>
<li>One original row of <code>linelist_mini</code> is duplicated (“Military Hospital”) because it matched to <em>two</em> rows in the secondary dataframe, so both combinations are returned<br>
</li>
<li>The join identifier column of the secondary dataset (<code>hosp_name</code>) has disappeared because it is redundant with the identifier column in the primary dataset (<code>hospital</code>)<br>
</li>
<li>When a baseline row did not match to any secondary row (e.g. when <code>hospital</code> is “Other” or “Missing”), <code>NA</code> fills in the columns from the secondary dataframe<br>
</li>
<li>Rows in the secondary dataframe with no match to the baseline dataframe (“sisters” and “ignace”) were dropped</li>
</ul>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_mini</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">hosp_info</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hospital"</span> <span class="op">=</span> <span class="st">"hosp_name"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-f4308d819566cc0dd088" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f4308d819566cc0dd088">{"x":{"filter":"none","data":[["6c286a","5fe599","6285c9","893f25","893f25","c4e706","275cc7","133ee7","dbebea","788a99","2978ac"],["2014-04-27","2014-05-13","2014-05-14","2014-05-21","2014-05-21","2014-05-23","2014-05-27","2014-05-27","2014-06-02","2014-06-06","2014-06-06"],["Missing","Other","Missing","Military Hospital","Military Hospital","Missing","Central Hospital","Missing","Port Hospital","Port Hospital","Port Hospital"],[null,null,null,40500,10000,null,1950280,null,50280,50280,50280],[null,null,null,"Secondary","Primary",null,"Tertiary",null,"Secondary","Secondary","Secondary"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>date_onset<\/th>\n      <th>hospital<\/th>\n      <th>catchment_pop<\/th>\n      <th>level<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":11,"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,11,25,50,100]}},"evals":[],"jsHooks":[]}</script><p><strong>“Should I use a right join, or a left join?”</strong><br>
Most important is to ask “which dataframe should retain all of its rows?” - use this one as the baseline.</p>
<p>The two commands below achieve the same output - 10 rows of <code>hosp_info</code> joined <em>into</em> a <code>linelist_mini</code> baseline. However, the column order will differ based on whether <code>hosp_info</code> arrives from the right (in the left join) or arrives from the left (in the right join). The order of the rows may also shift consequently.</p>
<p>Also consider whether your use-case is within a pipe chain (<code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code>). If the dataset in the pipes is the baseline, you will likely use a left join to add data to it.</p>
<div class="sourceCode" id="cb403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The two commands below achieve the same data, but with differently ordered rows and columns</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">linelist_mini</span>, <span class="va">hosp_info</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hospital"</span> <span class="op">=</span> <span class="st">"hosp_name"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join</a></span><span class="op">(</span><span class="va">hosp_info</span>, <span class="va">linelist_mini</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hosp_name"</span> <span class="op">=</span> <span class="st">"hospital"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-b4de3f494f15f38659f8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b4de3f494f15f38659f8">{"x":{"filter":"none","data":[["6c286a","5fe599","6285c9","893f25","893f25","c4e706","275cc7","133ee7","dbebea","788a99","2978ac"],["2014-04-27","2014-05-13","2014-05-14","2014-05-21","2014-05-21","2014-05-23","2014-05-27","2014-05-27","2014-06-02","2014-06-06","2014-06-06"],["Missing","Other","Missing","Military Hospital","Military Hospital","Missing","Central Hospital","Missing","Port Hospital","Port Hospital","Port Hospital"],[null,null,null,40500,10000,null,1950280,null,50280,50280,50280],[null,null,null,"Secondary","Primary",null,"Tertiary",null,"Secondary","Secondary","Secondary"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>date_onset<\/th>\n      <th>hospital<\/th>\n      <th>catchment_pop<\/th>\n      <th>level<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":11,"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,11,25,50,100]}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-a1e52e45f59935567777" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a1e52e45f59935567777">{"x":{"filter":"none","data":[["Central Hospital","Military Hospital","Military Hospital","Port Hospital","Port Hospital","Port Hospital","Missing","Other","Missing","Missing","Missing"],[1950280,40500,10000,50280,50280,50280,null,null,null,null,null],["Tertiary","Secondary","Primary","Secondary","Secondary","Secondary",null,null,null,null,null],["275cc7","893f25","893f25","dbebea","788a99","2978ac","6c286a","5fe599","6285c9","c4e706","133ee7"],["2014-05-27","2014-05-21","2014-05-21","2014-06-02","2014-06-06","2014-06-06","2014-04-27","2014-05-13","2014-05-14","2014-05-23","2014-05-27"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>hosp_name<\/th>\n      <th>catchment_pop<\/th>\n      <th>level<\/th>\n      <th>case_id<\/th>\n      <th>date_onset<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":11,"columnDefs":[{"className":"dt-right","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,11,25,50,100]}},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
<div id="full-join" class="section level3" number="11.3.4">
<h3>
<span class="header-section-number">11.3.4</span> Full join<a class="anchor" aria-label="anchor" href="#full-join"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A full join is the most <em>inclusive</em> of the joins</strong> - it returns all rows from both dataframes.</p>
<p>If there are any rows present in one and not the other (where no match was found), the dataframe will become wider as <code>NA</code> values are added to fill-in. Watch the number of columns and rows carefully and troubleshoot case-sensitivity and exact string matches.</p>
<p>Adjustment of the “baseline” (first) dataframe will not impact which records are returned, but it will impact the column order, row order, and which identifier column is retained.</p>
<div class="inline-figure"><img src="images/full-join.gif" width="50%"></div>
<p><strong>Example</strong></p>
<p>Below is the output of a <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code> of <code>hosp_info</code> <em>into</em> <code>linelist_mini</code>. Note the following:</p>
<ul>
<li>All baseline rows (<code>linelist_mini</code>) are kept<br>
</li>
<li>One baseline row is duplicated (“Military Hospital”) because it matched to two secondary rows and both combinations are returned<br>
</li>
<li>Only the identifier column from the baseline is kept (<code>hospital</code>)<br>
</li>
<li>
<code>NA</code> fills in where baseline rows did not match to secondary rows (<code>hospital</code> was “Other” or “Missing”), or the opposite (where <code>hosp_name</code> was “ignace” or “sisters”)</li>
</ul>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_mini</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">hosp_info</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hospital"</span> <span class="op">=</span> <span class="st">"hosp_name"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-a8f284f3d72f5d5c0f72" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a8f284f3d72f5d5c0f72">{"x":{"filter":"none","data":[["6c286a","5fe599","6285c9","893f25","893f25","c4e706","275cc7","133ee7","dbebea","788a99","2978ac",null,null,null],["2014-04-27","2014-05-13","2014-05-14","2014-05-21","2014-05-21","2014-05-23","2014-05-27","2014-05-27","2014-06-02","2014-06-06","2014-06-06",null,null,null],["Missing","Other","Missing","Military Hospital","Military Hospital","Missing","Central Hospital","Missing","Port Hospital","Port Hospital","Port Hospital","St. Mark's Maternity Hospital (SMMH)","ignace","sisters"],[null,null,null,40500,10000,null,1950280,null,50280,50280,50280,12000,5000,4200],[null,null,null,"Secondary","Primary",null,"Tertiary",null,"Secondary","Secondary","Secondary","Secondary","Primary","Primary"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>date_onset<\/th>\n      <th>hospital<\/th>\n      <th>catchment_pop<\/th>\n      <th>level<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":13,"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,13,25,50,100]}},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
<div id="inner-join" class="section level3" number="11.3.5">
<h3>
<span class="header-section-number">11.3.5</span> Inner join<a class="anchor" aria-label="anchor" href="#inner-join"><i class="fas fa-link"></i></a>
</h3>
<p><strong>An inner join is the most <em>restrictive</em> of the joins</strong> - it returns only rows with matches across both dataframes.<br>
This means that your original dataset may reduce in number of rows. Adjustment of the “baseline” (first) dataframe will not impact which records are returned, but it will impact the column order, row order, and which identifier column is retained.</p>
<div class="inline-figure"><img src="images/inner-join.gif" width="50%"></div>
<p><strong>Example</strong></p>
<p>Below is the output of an <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code> of <code>linelist_mini</code> (baseline) with <code>hosp_info</code> (secondary). Note the following:</p>
<ul>
<li>Not all baseline rows are kept (rows where <code>hospital</code> is “Missing” or “Other” are removed because had no match in the secondary dataframe<br>
</li>
<li>Likewise, secondary rows where <code>hosp_name</code> is “sisters” or “ignace” are removed as they have no match in the baseline dataframe<br>
</li>
<li>Only the identifier column from the baseline is kept (<code>hospital</code>)</li>
</ul>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_mini</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">hosp_info</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hospital"</span> <span class="op">=</span> <span class="st">"hosp_name"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hosp_info</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">linelist_mini</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hosp_name"</span> <span class="op">=</span> <span class="st">"hospital"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-14f2ee9fb409376014a9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-14f2ee9fb409376014a9">{"x":{"filter":"none","data":[["893f25","893f25","275cc7","dbebea","788a99","2978ac"],["2014-05-21","2014-05-21","2014-05-27","2014-06-02","2014-06-06","2014-06-06"],["Military Hospital","Military Hospital","Central Hospital","Port Hospital","Port Hospital","Port Hospital"],[40500,10000,1950280,50280,50280,50280],["Secondary","Primary","Tertiary","Secondary","Secondary","Secondary"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>date_onset<\/th>\n      <th>hospital<\/th>\n      <th>catchment_pop<\/th>\n      <th>level<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":12,"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,12,25,50,100]}},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
<div id="semi-join" class="section level3" number="11.3.6">
<h3>
<span class="header-section-number">11.3.6</span> Semi join<a class="anchor" aria-label="anchor" href="#semi-join"><i class="fas fa-link"></i></a>
</h3>
<p>A semi join is a “filtering join” which uses another dataset <em>not to add rows or columns, but to perform filtering</em>.<br>
A <strong>semi-join keeps all observations in dataframe 1 that have a match in dataframe 2</strong> (but does not add new columns or duplicate any rows with multiple matches). Read more about filtering joins <a href="https://towardsdatascience.com/level-up-with-semi-joins-in-r-a068426096e0">here</a>.</p>
<div class="inline-figure"><img src="images/semi-join.gif" width="50%"></div>
<p>The below code would return <strong>0</strong> rows, because the two dataframes are completely different - there are no rows that are in both.</p>
<div class="sourceCode" id="cb407"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hosp_info</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join</a></span><span class="op">(</span><span class="va">linelist_mini</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hosp_name"</span> <span class="op">=</span> <span class="st">"hospital"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="anti-join" class="section level3" number="11.3.7">
<h3>
<span class="header-section-number">11.3.7</span> Anti join<a class="anchor" aria-label="anchor" href="#anti-join"><i class="fas fa-link"></i></a>
</h3>
<p><strong>The anti join is a “filtering join” that returns rows in dataframe 1 that <em>do not</em> have a match in dataframe 2.</strong></p>
<p>Read more about filtering joins <a href="https://towardsdatascience.com/level-up-with-semi-joins-in-r-a068426096e0">here</a>.</p>
<p>Common scenarios for an anti-join include identifying records not present in another dataframe, troubleshooting spelling in a join (catching records that <em>should have</em> matched), and examining records that were excluded after another join.</p>
<p><strong>As with right_join() and left_join(), the <em>baseline</em> dataframe (listed first) is important</strong>. The returned rows are from it only. Notice in the gif below that row in the non-baseline dataframe (purple 4) is not returned even though it does not match.</p>
<div class="inline-figure"><img src="images/anti-join.gif" width="50%"></div>
<p><strong>Simple example</strong></p>
<p>For an example, let’s find the <code>hosp_info</code> hospitals that do not have any cases present in <code>linelist_mini</code>. We list <code>hosp_info</code> first, as the baseline dataframe. The two hospitals which are not present in <code>linelist_mini</code> are returned.</p>
<div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hosp_info</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span><span class="op">(</span><span class="va">linelist_mini</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hosp_name"</span> <span class="op">=</span> <span class="st">"hospital"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-9180fca0642da93e5b2b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9180fca0642da93e5b2b">{"x":{"filter":"none","data":[["St. Mark's Maternity Hospital (SMMH)","ignace","sisters"],[12000,5000,4200],["Secondary","Primary","Primary"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>hosp_name<\/th>\n      <th>catchment_pop<\/th>\n      <th>level<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":12,"columnDefs":[{"className":"dt-right","targets":1}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,12,25,50,100]}},"evals":[],"jsHooks":[]}</script><p><strong>Example 2</strong></p>
<p>For another example, let us say we ran an <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code> between <code>linelist_mini</code> and <code>hosp_info</code>. This returns only 8 of the original 11 <code>linelist_mini</code> records.</p>
<div class="sourceCode" id="cb409"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_mini</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">hosp_info</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hospital"</span> <span class="op">=</span> <span class="st">"hosp_name"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-b8ef55961fe999a9f631" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b8ef55961fe999a9f631">{"x":{"filter":"none","data":[["893f25","893f25","275cc7","dbebea","788a99","2978ac"],["2014-05-21","2014-05-21","2014-05-27","2014-06-02","2014-06-06","2014-06-06"],["Military Hospital","Military Hospital","Central Hospital","Port Hospital","Port Hospital","Port Hospital"],[40500,10000,1950280,50280,50280,50280],["Secondary","Primary","Tertiary","Secondary","Secondary","Secondary"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>date_onset<\/th>\n      <th>hospital<\/th>\n      <th>catchment_pop<\/th>\n      <th>level<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>To review the 3 <code>linelist_mini</code> records that were excluded in the inner join, we can run an anti-join with <code>linelist_mini</code> as the baseline dataframe.</p>
<div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_mini</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span><span class="op">(</span><span class="va">hosp_info</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hospital"</span> <span class="op">=</span> <span class="st">"hosp_name"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-f3f582e2919793ebe809" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f3f582e2919793ebe809">{"x":{"filter":"none","data":[["6c286a","5fe599","6285c9","c4e706","133ee7"],["2014-04-27","2014-05-13","2014-05-14","2014-05-23","2014-05-27"],["Missing","Other","Missing","Missing","Missing"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>date_onset<\/th>\n      <th>hospital<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>To see the <code>hosp_info</code> records that were excluded in the inner join, we could also run an anti-join with <code>hosp_info</code> as the baseline dataframe.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="probabalistic-matching" class="section level2 tabset tabset-fade" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Probabalistic matching<a class="anchor" aria-label="anchor" href="#probabalistic-matching"><i class="fas fa-link"></i></a>
</h2>
<p>rowmatcher
other options (finlay?)</p>
<!-- ======================================================= -->
</div>
<div id="resources-3" class="section level2 tabset tabset-fade" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Resources<a class="anchor" aria-label="anchor" href="#resources-3"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="https://dplyr.tidyverse.org/reference/join.html">dplyr page on joins</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="grouping-data.html"><span class="header-section-number">10</span> Grouping data</a></div>
<div class="next"><a href="charactersstrings.html"><span class="header-section-number">12</span> Characters/strings</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#joining-matching-datasets"><span class="header-section-number">11</span> Joining &amp; matching datasets</a></li>
<li><a class="nav-link" href="#overview-6"><span class="header-section-number">11.1</span> Overview</a></li>
<li>
<a class="nav-link" href="#preparation-2"><span class="header-section-number">11.2</span> Preparation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#datasets"><span class="header-section-number">11.2.1</span> Datasets</a></li>
<li><a class="nav-link" href="#pre-cleaning"><span class="header-section-number">11.2.2</span> Pre-cleaning</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#dplyr-joins"><span class="header-section-number">11.3</span> dplyr joins</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#general-syntax"><span class="header-section-number">11.3.1</span> General syntax</a></li>
<li><a class="nav-link" href="#section"><span class="header-section-number">11.3.2</span></a></li>
<li><a class="nav-link" href="#add-columns-left-right-joins"><span class="header-section-number">11.3.3</span> Add columns: left &amp; right joins</a></li>
<li><a class="nav-link" href="#full-join"><span class="header-section-number">11.3.4</span> Full join</a></li>
<li><a class="nav-link" href="#inner-join"><span class="header-section-number">11.3.5</span> Inner join</a></li>
<li><a class="nav-link" href="#semi-join"><span class="header-section-number">11.3.6</span> Semi join</a></li>
<li><a class="nav-link" href="#anti-join"><span class="header-section-number">11.3.7</span> Anti join</a></li>
</ul>
</li>
<li><a class="nav-link" href="#probabalistic-matching"><span class="header-section-number">11.4</span> Probabalistic matching</a></li>
<li><a class="nav-link" href="#resources-3"><span class="header-section-number">11.5</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R Handbook for Epidemiologists</strong>" was written by the handbook team. It was last built on 2021-02-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
