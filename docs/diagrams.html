<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>33 Diagrams | The Epidemiologist R Handbook</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.15/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">About this book</li>
<li><a class="" href="style-and-editorial-notes.html"><span class="header-section-number">1</span> Style and editorial notes</a></li>
<li><a class="" href="datasets-used.html"><span class="header-section-number">2</span> Datasets used</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> R Basics</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transition to R</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">5</span> Import and export</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">7</span> Suggested packages</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Cleaning data and core functions</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with dates</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">10</span> Factors</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">11</span> Pivoting data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">12</span> Grouping data</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">13</span> Joining data</a></li>
<li><a class="" href="characters-and-strings.html"><span class="header-section-number">14</span> Characters and strings</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></li>
<li><a class="" href="iteration-and-loops.html"><span class="header-section-number">16</span> Iteration and loops</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="missing-data.html"><span class="header-section-number">17</span> Missing data</a></li>
<li><a class="" href="descriptive-analysis.html"><span class="header-section-number">18</span> Descriptive analysis</a></li>
<li><a class="" href="univariate-and-multivariate-regression.html"><span class="header-section-number">19</span> Univariate and multivariate regression</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">20</span> Standardization</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">21</span> Moving averages</a></li>
<li><a class="" href="time-series-and-outbreak-detection.html"><span class="header-section-number">22</span> Time series and outbreak detection</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">23</span> Epidemic modeling</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">24</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">25</span> Survival analysis</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">26</span> GIS basics</a></li>
<li class="book-part">Data Vizualization</li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">27</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">28</span> Epidemic curves</a></li>
<li><a class="" href="plot-continuous-data.html"><span class="header-section-number">29</span> Plot continuous data</a></li>
<li><a class="" href="plot-categorical-data.html"><span class="header-section-number">30</span> Plot categorical data</a></li>
<li><a class="" href="tables-1.html"><span class="header-section-number">31</span> Tables</a></li>
<li><a class="" href="age-pyramids-and-likert-scales.html"><span class="header-section-number">32</span> Age pyramids and Likert-scales</a></li>
<li><a class="active" href="diagrams.html"><span class="header-section-number">33</span> Diagrams</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">34</span> Combinations analysis</a></li>
<li><a class="" href="heatmaps.html"><span class="header-section-number">35</span> Heatmaps</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">36</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">37</span> Phylogenetic trees</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">38</span> Interactive plots</a></li>
<li class="book-part">Advanced</li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">39</span> Directory interactions</a></li>
<li><a class="" href="r-markdown-1.html"><span class="header-section-number">40</span> R Markdown</a></li>
<li><a class="" href="routine-reports.html"><span class="header-section-number">41</span> Routine reports</a></li>
<li><a class="" href="errors-warnings-1.html"><span class="header-section-number">42</span> Errors &amp; warnings</a></li>
<li><a class="" href="advanced-rstudio.html"><span class="header-section-number">43</span> Advanced RStudio</a></li>
<li><a class="" href="relational-databases.html"><span class="header-section-number">44</span> Relational databases</a></li>
<li><a class="" href="shiny-and-dashboards.html"><span class="header-section-number">45</span> Shiny and dashboards</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">46</span> Collaboration</a></li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">47</span> Writing functions</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">48</span> R on network drives</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="diagrams" class="section level1" number="33">
<h1>
<span class="header-section-number">33</span> Diagrams<a class="anchor" aria-label="anchor" href="#diagrams"><i class="fas fa-link"></i></a>
</h1>
<!-- ======================================================= -->
<div id="overview-17" class="section level2" number="33.1">
<h2>
<span class="header-section-number">33.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview-17"><i class="fas fa-link"></i></a>
</h2>
<p><img src="images/flow_chart.png" width="50%"><img src="images/sankey_diagram.png" width="50%"></p>
<p>This page covers:</p>
<ul>
<li>Flow diagrams using <strong>DiagrammeR</strong><br>
</li>
<li>Alluvial/Sankey diagrams<br>
</li>
<li>Event timelines<br>
</li>
<li>Dendrogram organizational trees (e.g. of folder contents)<br>
</li>
<li>DAGs (Directed Acyclic Graphs)</li>
</ul>
<!-- ======================================================= -->
</div>
<div id="preparation-22" class="section level2" number="33.2">
<h2>
<span class="header-section-number">33.2</span> Preparation<a class="anchor" aria-label="anchor" href="#preparation-22"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Load packages</strong></p>
<div class="sourceCode" id="cb1265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span>
  <span class="va">DiagrammeR</span>,     <span class="co"># for flow diagrams</span>
  <span class="va">networkD3</span>       <span class="co"># For alluvial/Sankey diagrams</span>
  <span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="flow-diagrams" class="section level2" number="33.3">
<h2>
<span class="header-section-number">33.3</span> Flow diagrams<a class="anchor" aria-label="anchor" href="#flow-diagrams"><i class="fas fa-link"></i></a>
</h2>
<p>One can use the R package <strong>DiagrammeR</strong> to create charts/flow charts. They can be static, or they can adjust somewhat dynamically based on changes in a dataset.</p>
<p><strong>Tools</strong></p>
<p>The function <code>grViz()</code> is used to create a “Graphviz” diagram. This function accepts a <em>character string input containing instructions</em> for making the diagram. Within that string, the instructions are written in a different language, called <a href="https://graphviz.org/doc/info/lang.html">DOT</a> - it is quite easy to learn the basics.</p>
<p><strong>Basic structure</strong></p>
<ol style="list-style-type: decimal">
<li>Open the instructions <code>grViz("</code><br>
</li>
<li>Specify directionality and name of the graph, and open brackets, e.g. <code>digraph my_flow_chart {</code>
</li>
<li>Graph statement (layout, rank direction)<br>
</li>
<li>Nodes statements (create nodes)</li>
<li>Edges statements (gives links between nodes)<br>
</li>
<li>Close the instructions <code>}")</code>
</li>
</ol>
<div id="simple-examples" class="section level3" number="33.3.1">
<h3>
<span class="header-section-number">33.3.1</span> Simple examples<a class="anchor" aria-label="anchor" href="#simple-examples"><i class="fas fa-link"></i></a>
</h3>
<h3>
Simple examples
<a class="anchor" aria-label="anchor" href="#simple-examples"><i class="fas fa-link"></i></a>
</h3>
<p>Below are two simple examples</p>
<p>A very minimal example:</p>
<div class="sourceCode" id="cb1266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A minimal plot</span>
<span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DiagrammeR/man/grViz.html">grViz</a></span><span class="op">(</span><span class="st">"digraph {
  
graph[layout = dot, rankdir = LR]

a
b
c

a -&gt; b -&gt; c
}"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-12c2b19a84ff421a4bc6" style="width:50%;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-12c2b19a84ff421a4bc6">{"x":{"diagram":"digraph {\n  \ngraph[layout = dot, rankdir = LR]\n\na\nb\nc\n\na -> b -> c\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>An example with applied public health context:</p>
<div class="sourceCode" id="cb1267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">grViz</span><span class="op">(</span><span class="st">"                           # All instructions are within a large character string
digraph surveillance_diagram {    # 'digraph' means 'directional graph', then the graph name 
  
  # graph statement
  #################
  graph [layout = dot,
         rankdir = TB,
         overlap = true,
         fontsize = 10]
  
  # nodes
  #######
  node [shape = circle,           # shape = circle
       fixedsize = true
       width = 1.3]               # width of circles
  
  Primary                         # names of nodes
  Secondary
  Tertiary

  # edges
  #######
  Primary   -&gt; Secondary [label = 'case transfer']
  Secondary -&gt; Tertiary [label = 'case transfer']
}
"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-afaf77b2e0ee1dde30be" style="width:50%;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-afaf77b2e0ee1dde30be">{"x":{"diagram":"                           # All instructions are within a large character string\ndigraph surveillance_diagram {    # \"digraph\" means \"directional graph\", then the graph name \n  \n  # graph statement\n  #################\n  graph [layout = dot,\n         rankdir = TB,\n         overlap = true,\n         fontsize = 10]\n  \n  # nodes\n  #######\n  node [shape = circle,           # shape = circle\n       fixedsize = true\n       width = 1.3]               # width of circles\n  \n  Primary                         # names of nodes\n  Secondary\n  Tertiary\n\n  # edges\n  #######\n  Primary   -> Secondary [label = \"case transfer\"]\n  Secondary -> Tertiary [label = \"case transfer\"]\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="syntax" class="section level3" number="33.3.2">
<h3>
<span class="header-section-number">33.3.2</span> Syntax<a class="anchor" aria-label="anchor" href="#syntax"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Basic syntax</strong></p>
<p>Node names, or edge statements, can be separated with spaces, semicolons, or newlines.</p>
<p><strong>Rank direction</strong></p>
<p>A plot can be re-oriented to move left-to-right by adjusting the <code>rankdir</code> argument within the graph statement. The default is TB (top-to-bottom), but it can be LR (left-to-right), RL, or BT.</p>
<p><strong>Node names</strong></p>
<p>Node names can be single words, as in the simple example above. To use multi-word names or special characters (e.g. parentheses, dashes), put the node name within single quotes (’ ’). It may be easier to have a short node name, and assign a <em>label</em>, as shown below within brackets [ ]. A label is also necessary to have a newline within the node name - use <code>\n</code> in the node label within single quotes, as shown below.</p>
<p><strong>Subgroups</strong><br>
Within edge statements, subgroups can be created on either side of the edge with curly brackets ({ }). The edge then applies to all nodes in the bracket - it is a shorthand.</p>
<p><strong>Layouts</strong></p>
<ul>
<li>dot (set <code>rankdir</code> to either TB, LR, RL, BT, )</li>
<li>neato<br>
</li>
<li>twopi<br>
</li>
<li>circo</li>
</ul>
<p><strong>Nodes - editable attributes</strong></p>
<ul>
<li>
<code>label</code> (text, in single quotes if multi-word)<br>
</li>
<li>
<code>fillcolor</code> (many possible colors)<br>
</li>
<li>
<code>fontcolor</code><br>
</li>
<li>
<code>alpha</code> (transparency 0-1)<br>
</li>
<li>
<code>shape</code> (ellipse, oval, diamond, egg, plaintext, point, square, triangle)<br>
</li>
<li>
<code>style</code><br>
</li>
<li>
<code>sides</code><br>
</li>
<li>
<code>peripheries</code><br>
</li>
<li>
<code>fixedsize</code> (h x w)<br>
</li>
<li>
<code>height</code><br>
</li>
<li>
<code>width</code><br>
</li>
<li>
<code>distortion</code><br>
</li>
<li>
<code>penwidth</code> (width of shape border)<br>
</li>
<li>
<code>x</code> (displacement left/right)<br>
</li>
<li>
<code>y</code> (displacement up/down)<br>
</li>
<li>
<code>fontname</code><br>
</li>
<li>
<code>fontsize</code><br>
</li>
<li><code>icon</code></li>
</ul>
<p><strong>Edges - editable attributes</strong></p>
<ul>
<li>
<code>arrowsize</code><br>
</li>
<li>
<code>arrowhead</code> (normal, box, crow, curve, diamond, dot, inv, none, tee, vee)<br>
</li>
<li>
<code>arrowtail</code><br>
</li>
<li>
<code>dir</code> (direction, )<br>
</li>
<li>
<code>style</code> (dashed, …)<br>
</li>
<li>
<code>color</code><br>
</li>
<li>
<code>alpha</code><br>
</li>
<li>
<code>headport</code> (text in front of arrowhead)<br>
</li>
<li>
<code>tailport</code> (text in behind arrowtail)<br>
</li>
<li>
<code>fontname</code><br>
</li>
<li>
<code>fontsize</code><br>
</li>
<li>
<code>fontcolor</code><br>
</li>
<li>
<code>penwidth</code> (width of arrow)<br>
</li>
<li>
<code>minlen</code> (minimum length)</li>
</ul>
<p><strong>Color names</strong>: hexadecimal values or ‘X11’ color names, see <a href="http://rich-iannone.github.io/DiagrammeR/graphviz_and_mermaid.html">here for X11 details</a></p>
</div>
<div id="complex-examples" class="section level3" number="33.3.3">
<h3>
<span class="header-section-number">33.3.3</span> Complex examples<a class="anchor" aria-label="anchor" href="#complex-examples"><i class="fas fa-link"></i></a>
</h3>
<p>The example below expands on the surveillance_diagram, adding complex node names, grouped edges, colors and styling</p>
<pre><code><a href="https://rdrr.io/pkg/DiagrammeR/man/grViz.html">DiagrammeR::grViz("               # All instructions are within a large character string
digraph surveillance_diagram {    # 'digraph' means 'directional graph', then the graph name 
  
  # graph statement
  #################
  graph [layout = dot,
         rankdir = TB,            # layout top-to-bottom
         fontsize = 10]
  

  # nodes (circles)
  #################
  node [shape = circle,           # shape = circle
       fixedsize = true
       width = 1.3]                      
  
  Primary   [label = 'Primary\nFacility'] 
  Secondary [label = 'Secondary\nFacility'] 
  Tertiary  [label = 'Tertiary\nFacility'] 
  SC        [label = 'Surveillance\nCoordination',
             fontcolor = darkgreen] 
  
  # edges
  #######
  Primary   -&gt; Secondary [label = 'case transfer',
                          fontcolor = red,
                          color = red]
  Secondary -&gt; Tertiary [label = 'case transfer',
                          fontcolor = red,
                          color = red]
  
  # grouped edge
  {Primary Secondary Tertiary} -&gt; SC [label = 'case reporting',
                                      fontcolor = darkgreen,
                                      color = darkgreen,
                                      style = dashed]
}
")</a></code></pre>
<div id="htmlwidget-9d54bf25b304e0524090" style="width:50%;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-9d54bf25b304e0524090">{"x":{"diagram":"               # All instructions are within a large character string\ndigraph surveillance_diagram {    # \"digraph\" means \"directional graph\", then the graph name \n  \n  # graph statement\n  #################\n  graph [layout = dot,\n         rankdir = TB,            # layout top-to-bottom\n         fontsize = 10]\n  \n\n  # nodes (circles)\n  #################\n  node [shape = circle,           # shape = circle\n       fixedsize = true\n       width = 1.3]                      \n  \n  Primary   [label = \"Primary\nFacility\"] \n  Secondary [label = \"Secondary\nFacility\"] \n  Tertiary  [label = \"Tertiary\nFacility\"] \n  SC        [label = \"Surveillance\nCoordination\",\n             fontcolor = darkgreen] \n  \n  # edges\n  #######\n  Primary   -> Secondary [label = \"case transfer\",\n                          fontcolor = red,\n                          color = red]\n  Secondary -> Tertiary [label = \"case transfer\",\n                          fontcolor = red,\n                          color = red]\n  \n  # grouped edge\n  {Primary Secondary Tertiary} -> SC [label = \"case reporting\",\n                                      fontcolor = darkgreen,\n                                      color = darkgreen,\n                                      style = dashed]\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p><strong>Sub-graph clusters</strong></p>
<p>To group nodes into boxed clusters, put them within the same named subgraph (<code>subgraph name {}</code>). To have each subgraph identified within a bounding box, begin the name of the subgraph with “cluster”, as shown with the 4 boxes below.</p>
<pre><code><a href="https://rdrr.io/pkg/DiagrammeR/man/grViz.html">DiagrammeR::grViz("             # All instructions are within a large character string
digraph surveillance_diagram {  # 'digraph' means 'directional graph', then the graph name 
  
  # graph statement
  #################
  graph [layout = dot,
         rankdir = TB,            
         overlap = true,
         fontsize = 10]
  

  # nodes (circles)
  #################
  node [shape = circle,                  # shape = circle
       fixedsize = true
       width = 1.3]                      # width of circles
  
  subgraph cluster_passive {
    Primary   [label = 'Primary\nFacility'] 
    Secondary [label = 'Secondary\nFacility'] 
    Tertiary  [label = 'Tertiary\nFacility'] 
    SC        [label = 'Surveillance\nCoordination',
               fontcolor = darkgreen] 
  }
  
  # nodes (boxes)
  ###############
  node [shape = box,                     # node shape
        fontname = Helvetica]            # text font in node
  
  subgraph cluster_active {
    Active [label = 'Active\nSurveillance']; 
    HCF_active [label = 'HCF\nActive Search']
  }
  
  subgraph cluster_EBD {
    EBS [label = 'Event-Based\nSurveillance (EBS)']; 
    'Social Media'
    Radio
  }
  
  subgraph cluster_CBS {
    CBS [label = 'Community-Based\nSurveillance (CBS)'];
    RECOs
  }

  
  # edges
  #######
  {Primary Secondary Tertiary} -&gt; SC [label = 'case reporting']

  Primary   -&gt; Secondary [label = 'case transfer',
                          fontcolor = red]
  Secondary -&gt; Tertiary [label = 'case transfer',
                          fontcolor = red]
  
  HCF_active -&gt; Active
  
  {'Social Media'; Radio} -&gt; EBS
  
  RECOs -&gt; CBS
}
")
</a></code></pre>
<div id="htmlwidget-d8fb31cc4254723518e7" style="width:120%;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-d8fb31cc4254723518e7">{"x":{"diagram":"             # All instructions are within a large character string\ndigraph surveillance_diagram {  # \"digraph\" means \"directional graph\", then the graph name \n  \n  # graph statement\n  #################\n  graph [layout = dot,\n         rankdir = TB,            \n         overlap = true,\n         fontsize = 10]\n  \n\n  # nodes (circles)\n  #################\n  node [shape = circle,                  # shape = circle\n       fixedsize = true\n       width = 1.3]                      # width of circles\n  \n  subgraph cluster_passive {\n    Primary   [label = \"Primary\nFacility\"] \n    Secondary [label = \"Secondary\nFacility\"] \n    Tertiary  [label = \"Tertiary\nFacility\"] \n    SC        [label = \"Surveillance\nCoordination\",\n               fontcolor = darkgreen] \n  }\n  \n  # nodes (boxes)\n  ###############\n  node [shape = box,                     # node shape\n        fontname = Helvetica]            # text font in node\n  \n  subgraph cluster_active {\n    Active [label = \"Active\nSurveillance\"]; \n    HCF_active [label = \"HCF\nActive Search\"]\n  }\n  \n  subgraph cluster_EBD {\n    EBS [label = \"Event-Based\nSurveillance (EBS)\"]; \n    \"Social Media\"\n    Radio\n  }\n  \n  subgraph cluster_CBS {\n    CBS [label = \"Community-Based\nSurveillance (CBS)\"];\n    RECOs\n  }\n\n  \n  # edges\n  #######\n  {Primary Secondary Tertiary} -> SC [label = \"case reporting\"]\n\n  Primary   -> Secondary [label = \"case transfer\",\n                          fontcolor = red]\n  Secondary -> Tertiary [label = \"case transfer\",\n                          fontcolor = red]\n  \n  HCF_active -> Active\n  \n  {\"Social Media\"; Radio} -> EBS\n  \n  RECOs -> CBS\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p><strong>Node shapes</strong></p>
<p>The example below, borrowed from <a href="http://rich-iannone.github.io/DiagrammeR/">this tutorial</a>, shows applied node shapes and a shorthand for serial edge connections</p>
<div class="sourceCode" id="cb1270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DiagrammeR/man/grViz.html">grViz</a></span><span class="op">(</span><span class="st">"digraph {

graph [layout = dot, rankdir = LR]

# define the global styles of the nodes. We can override these in box if we wish
node [shape = rectangle, style = filled, fillcolor = Linen]

data1 [label = 'Dataset 1', shape = folder, fillcolor = Beige]
data2 [label = 'Dataset 2', shape = folder, fillcolor = Beige]
process [label =  'Process \n Data']
statistical [label = 'Statistical \n Analysis']
results [label= 'Results']

# edge definitions with the node IDs
{data1 data2}  -&gt; process -&gt; statistical -&gt; results
}"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-5e4dfc9d253b7d6ce540" style="width:75%;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-5e4dfc9d253b7d6ce540">{"x":{"diagram":"digraph {\n\ngraph [layout = dot, rankdir = LR]\n\n# define the global styles of the nodes. We can override these in box if we wish\nnode [shape = rectangle, style = filled, fillcolor = Linen]\n\ndata1 [label = \"Dataset 1\", shape = folder, fillcolor = Beige]\ndata2 [label = \"Dataset 2\", shape = folder, fillcolor = Beige]\nprocess [label =  \"Process \n Data\"]\nstatistical [label = \"Statistical \n Analysis\"]\nresults [label= \"Results\"]\n\n# edge definitions with the node IDs\n{data1 data2}  -> process -> statistical -> results\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="outputs" class="section level3" number="33.3.4">
<h3>
<span class="header-section-number">33.3.4</span> Outputs<a class="anchor" aria-label="anchor" href="#outputs"><i class="fas fa-link"></i></a>
</h3>
<p>How to handle and save outputs</p>
<ul>
<li>Outputs will appear in RStudio’s Viewer pane, by default in the lower-right alongside Files, Plots, Packages, and Help.<br>
</li>
<li>To export you can “Save as image” or “Copy to clipboard” from the Viewer. The graphic will adjust to the specified size.</li>
</ul>
</div>
<div id="parameterized-figures" class="section level3" number="33.3.5">
<h3>
<span class="header-section-number">33.3.5</span> Parameterized figures<a class="anchor" aria-label="anchor" href="#parameterized-figures"><i class="fas fa-link"></i></a>
</h3>
<h3>
Parameterized figures
<a class="anchor" aria-label="anchor" href="#parameterized-figures"><i class="fas fa-link"></i></a>
</h3>
<p>“Parameterized figures: A great benefit of designing figures within R is that we are able to connect the figures directly with our analysis by reading R values directly into our flowcharts. For example, suppose you have created a filtering process which removes values after each stage of a process, you can have a figure show the number of values left in the dataset after each stage of your process. To do this we, you can use the @<span class="citation">@X</span> symbol directly within the figure, then refer to this in the footer of the plot using [X]:, where X is the a unique numeric index. Here is a basic example:”<br><a href="https://mikeyharper.uk/flowcharts-in-r-using-diagrammer/" class="uri">https://mikeyharper.uk/flowcharts-in-r-using-diagrammer/</a></p>
<div class="sourceCode" id="cb1271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define some sample data</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1000</span>, b<span class="op">=</span><span class="fl">800</span>, c<span class="op">=</span><span class="fl">600</span>, d<span class="op">=</span><span class="fl">400</span><span class="op">)</span>


<span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DiagrammeR/man/grViz.html">grViz</a></span><span class="op">(</span><span class="st">"
digraph graph2 {

graph [layout = dot]

# node definitions with substituted label text
node [shape = rectangle, width = 4, fillcolor = Biege]
a [label = '@@1']
b [label = '@@2']
c [label = '@@3']
d [label = '@@4']

a -&gt; b -&gt; c -&gt; d

}

[1]:  paste0('Raw Data (n = ', data$a, ')')
[2]: paste0('Remove Errors (n = ', data$b, ')')
[3]: paste0('Identify Potential Customers (n = ', data$c, ')')
[4]: paste0('Select Top Priorities (n = ', data$d, ')')
"</span><span class="op">)</span></code></pre></div>
<p>Much of the above is adapted from the tutorial <a href="https://mikeyharper.uk/flowcharts-in-r-using-diagrammer/">at this site</a></p>
<p>Other more in-depth tutorial: <a href="http://rich-iannone.github.io/DiagrammeR/" class="uri">http://rich-iannone.github.io/DiagrammeR/</a></p>
</div>
<div id="consort-diagram" class="section level3" number="33.3.6">
<h3>
<span class="header-section-number">33.3.6</span> CONSORT diagram<a class="anchor" aria-label="anchor" href="#consort-diagram"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://scriptsandstatistics.wordpress.com/2017/12/22/how-to-draw-a-consort-flow-diagram-using-r-and-graphviz/" class="uri">https://scriptsandstatistics.wordpress.com/2017/12/22/how-to-draw-a-consort-flow-diagram-using-r-and-graphviz/</a></p>
<p>Note above is out of date via DiagrammeR</p>
<!-- ======================================================= -->
</div>
</div>
<div id="alluvialsankey-diagrams" class="section level2" number="33.4">
<h2>
<span class="header-section-number">33.4</span> Alluvial/Sankey Diagrams<a class="anchor" aria-label="anchor" href="#alluvialsankey-diagrams"><i class="fas fa-link"></i></a>
</h2>
<div id="preparation-23" class="section level3" number="33.4.1">
<h3>
<span class="header-section-number">33.4.1</span> Preparation<a class="anchor" aria-label="anchor" href="#preparation-23"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Load packages</strong></p>
<div class="sourceCode" id="cb1272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">networkD3</span><span class="op">)</span></code></pre></div>
</div>
<div id="plotting-from-dataset" class="section level3" number="33.4.2">
<h3>
<span class="header-section-number">33.4.2</span> Plotting from dataset<a class="anchor" aria-label="anchor" href="#plotting-from-dataset"><i class="fas fa-link"></i></a>
</h3>
<p>Plotting the connections in a dataset</p>
<p><a href="https://www.r-graph-gallery.com/321-introduction-to-interactive-sankey-diagram-2.html" class="uri">https://www.r-graph-gallery.com/321-introduction-to-interactive-sankey-diagram-2.html</a></p>
<p>Counts of age category and hospital, relabled as target and source, respectively.</p>
<div class="sourceCode" id="cb1273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># counts by hospital and age category</span>
<span class="va">links</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="va">age_cat</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="va">age_cat</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>source <span class="op">=</span> <span class="va">hospital</span>,
         target <span class="op">=</span> <span class="va">age_cat</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-ef10097a8886a57dd167" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ef10097a8886a57dd167">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-29&quot;,&quot;30-49&quot;,&quot;50-69&quot;,&quot;70+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1\" data-max=\"286\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Central Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Military Hospital","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Missing","Other","Other","Other"],["0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+",null,"0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+",null,"0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+",null,"0-4","5-9","10-14"],[74,82,63,55,99,59,10,3,9,153,168,138,136,162,112,15,2,10,286,269,223,189,264,191,20,1,26,167,180,131]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>source<\/th>\n      <th>target<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Now formalize the nodes list, and adjust the ID columns to be numbers instead of labels:</p>
<div class="sourceCode" id="cb1274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The unique node names</span>
<span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">links</span><span class="op">$</span><span class="va">source</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">links</span><span class="op">$</span><span class="va">target</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># match to numbers, not names</span>
<span class="va">links</span><span class="op">$</span><span class="va">IDsource</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">links</span><span class="op">$</span><span class="va">source</span>, <span class="va">nodes</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span> 
<span class="va">links</span><span class="op">$</span><span class="va">IDtarget</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">links</span><span class="op">$</span><span class="va">target</span>, <span class="va">nodes</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></code></pre></div>
<p>Now plot the Sankey diagram:</p>
<div class="sourceCode" id="cb1275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot</span>
<span class="co">######</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">sankeyNetwork</span><span class="op">(</span>Links <span class="op">=</span> <span class="va">links</span>,
                   Nodes <span class="op">=</span> <span class="va">nodes</span>,
                   Source <span class="op">=</span> <span class="st">"IDsource"</span>,
                   Target <span class="op">=</span> <span class="st">"IDtarget"</span>,
                   Value <span class="op">=</span> <span class="st">"n"</span>,
                   NodeID <span class="op">=</span> <span class="st">"name"</span>,
                   units <span class="op">=</span> <span class="st">"TWh"</span>,
                   fontSize <span class="op">=</span> <span class="fl">12</span>,
                   nodeWidth <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div id="htmlwidget-1eb7fe94771a27d4d21f" style="width:672px;height:480px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1eb7fe94771a27d4d21f">{"x":{"links":{"source":[0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5],"target":[6,7,8,9,10,11,12,13,14,6,7,8,9,10,11,12,13,14,6,7,8,9,10,11,12,13,14,6,7,8,9,10,11,12,13,14,6,7,8,9,10,11,12,13,14,6,7,8,9,10,11,12,14],"value":[74,82,63,55,99,59,10,3,9,153,168,138,136,162,112,15,2,10,286,269,223,189,264,191,20,1,26,167,180,131,123,154,98,17,3,12,303,322,285,223,345,219,36,4,25,83,82,78,47,78,45,4,5]},"nodes":{"name":["Central Hospital","Military Hospital","Missing","Other","Port Hospital","St. Mark's Maternity Hospital (SMMH)","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+",null],"group":["Central Hospital","Military Hospital","Missing","Other","Port Hospital","St. Mark's Maternity Hospital (SMMH)","0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+",null]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":30,"nodePadding":10,"units":"TWh","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>Here is an example where the patient Outome is included as well. Note in the data management step how we bind rows of counts of hospital -&gt; outcome, using the same column names.</p>
<div class="sourceCode" id="cb1276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># counts by hospital and age category</span>
<span class="va">links</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="va">age_cat</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age_cat <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"Age {age_cat}"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="va">age_cat</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>source <span class="op">=</span> <span class="va">age_cat</span>,
         target <span class="op">=</span> <span class="va">hospital</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>
    <span class="va">linelist</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">hospital</span>, <span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>source <span class="op">=</span> <span class="va">hospital</span>,
             target <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># The unique node names</span>
<span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">links</span><span class="op">$</span><span class="va">source</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">links</span><span class="op">$</span><span class="va">target</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># match to numbers, not names</span>
<span class="va">links</span><span class="op">$</span><span class="va">IDsource</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">links</span><span class="op">$</span><span class="va">source</span>, <span class="va">nodes</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span> 
<span class="va">links</span><span class="op">$</span><span class="va">IDtarget</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">links</span><span class="op">$</span><span class="va">target</span>, <span class="va">nodes</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>

<span class="co"># plot</span>
<span class="co">######</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">sankeyNetwork</span><span class="op">(</span>Links <span class="op">=</span> <span class="va">links</span>,
                   Nodes <span class="op">=</span> <span class="va">nodes</span>,
                   Source <span class="op">=</span> <span class="st">"IDsource"</span>,
                   Target <span class="op">=</span> <span class="st">"IDtarget"</span>,
                   Value <span class="op">=</span> <span class="st">"n"</span>,
                   NodeID <span class="op">=</span> <span class="st">"name"</span>,
                   units <span class="op">=</span> <span class="st">"TWh"</span>,
                   fontSize <span class="op">=</span> <span class="fl">12</span>,
                   nodeWidth <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div id="htmlwidget-21404dd420ec0d3228c8" style="width:672px;height:480px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-21404dd420ec0d3228c8">{"x":{"links":{"source":[0,1,2,3,4,5,6,7,8,0,1,2,3,4,5,6,7,8,0,1,2,3,4,5,6,7,8,0,1,2,3,4,5,6,7,8,0,1,2,3,4,5,6,7,8,0,1,2,3,4,5,6,8,9,9,9,10,10,10,11,11,11,12,12,12,13,13,13,14,14,14],"target":[9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,15,16,17,15,16,17,15,16,17,15,16,17,15,16,17,15,16,17],"value":[74,63,55,99,59,82,10,3,9,153,138,136,162,112,168,15,2,10,286,223,189,264,191,269,20,1,26,167,131,123,154,98,180,17,3,12,303,285,223,345,219,322,36,4,25,83,78,47,78,45,82,4,5,193,165,96,399,309,188,611,514,344,395,290,200,785,579,398,199,126,97]},"nodes":{"name":["Age 0-4","Age 10-14","Age 15-19","Age 20-29","Age 30-49","Age 5-9","Age 50-69","Age 70+","Age NA","Central Hospital","Military Hospital","Missing","Other","Port Hospital","St. Mark's Maternity Hospital (SMMH)","Death","Recover",null],"group":["Age 0-4","Age 10-14","Age 15-19","Age 20-29","Age 30-49","Age 5-9","Age 50-69","Age 70+","Age NA","Central Hospital","Military Hospital","Missing","Other","Port Hospital","St. Mark's Maternity Hospital (SMMH)","Death","Recover",null]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":30,"nodePadding":10,"units":"TWh","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p><a href="https://www.displayr.com/sankey-diagrams-r/" class="uri">https://www.displayr.com/sankey-diagrams-r/</a></p>
<p>Timeline Sankey - LTFU from cohort… application/rejections… etc.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="event-timelines" class="section level2" number="33.5">
<h2>
<span class="header-section-number">33.5</span> Event timelines<a class="anchor" aria-label="anchor" href="#event-timelines"><i class="fas fa-link"></i></a>
</h2>
<p>To make a timeline showing specific events, you can use the <code>vistime</code> package.</p>
<p>See this <a href="https://cran.r-project.org/web/packages/vistime/vignettes/vistime-vignette.html#ex.-2-project-planning">vignette</a></p>
<div class="sourceCode" id="cb1277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load package</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">vistime</span>,  <span class="co"># make the timeline</span>
               <span class="va">plotly</span>    <span class="co"># for interactive visualization</span>
               <span class="op">)</span></code></pre></div>
<p>Here is the events dataset we begin with:</p>
<div id="htmlwidget-faed3016691fd970ecb3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-faed3016691fd970ecb3">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["                       Event 1","                       Event 1","                       Event 1","                       Event 1","                       Event 1","                       Event 1","                       Event 1","                       Event 1","                       Event 1","                       Event 2","                       Event 2","                       Event 2","                       Event 2","                       Event 2"],[" Group A"," Group B"," Group C"," Group D"," Group E"," Group F"," Group G"," Group H"," Group I"," Group A"," Group C"," Group J"," Group J"," Group J"],["2020-01-22","2020-01-23","2020-01-23","2020-01-25","2020-01-25","2020-01-26","2020-01-27","2020-01-27","2020-01-27","2020-01-28","2020-01-28","2020-01-28","2020-01-28","2020-01-28"],["2020-01-22","2020-01-23","2020-01-23","2020-01-25","2020-01-25","2020-01-26","2020-01-27","2020-01-27","2020-01-27","2020-01-28","2020-01-28","2020-01-28","2020-01-28","2020-01-28"],[" #90caf9"," #90caf9"," #1565c0"," #f44336"," #90caf9"," #8d6e63"," #1565c0"," #90caf9","#90a4ae","#fc8d62"," #6a3d9a"," #90caf9"," #fc8d62"," #1565c0"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>event<\/th>\n      <th>group<\/th>\n      <th>start<\/th>\n      <th>end<\/th>\n      <th>color<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb1278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">vistime</span><span class="op">(</span><span class="va">data</span><span class="op">)</span>    <span class="co"># apply vistime</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span>

<span class="co"># step 1: transform into a list</span>
<span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/plotly/reference/plotly_build.html">plotly_build</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>

<span class="co"># step 2: Marker size</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">pp</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">pp</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"markers"</span><span class="op">)</span> <span class="va">pp</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">marker</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="op">}</span>

<span class="co"># step 3: text size</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">pp</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">pp</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"text"</span><span class="op">)</span> <span class="va">pp</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">textfont</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="op">}</span>


<span class="co"># step 4: text position</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">pp</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">pp</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">mode</span> <span class="op">==</span> <span class="st">"text"</span><span class="op">)</span> <span class="va">pp</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">textposition</span> <span class="op">&lt;-</span> <span class="st">"right"</span>
<span class="op">}</span>

<span class="co">#print</span>
<span class="va">pp</span></code></pre></div>
<div id="htmlwidget-dc3a7e919f9de64ed173" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-dc3a7e919f9de64ed173">{"x":{"visdat":{"c74502f27b":["function () ","plotlyVisDat"]},"cur_data":"c74502f27b","attrs":{"c74502f27b":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"c74502f27b.1":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":["2020-01-22 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-23 00:00:00.000000","2020-01-23 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-25 00:00:00.000000","2020-01-25 00:00:00.000000","2020-01-26 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-28 00:00:00.000000"],"y":[21,21,19,17,17,15,13,11,9,7,5,3,2,1],"marker":{"color":["#90caf9","#fc8d62","#90caf9","#1565c0","#6a3d9a","#f44336","#90caf9","#8d6e63","#1565c0","#90caf9","#90a4ae","#90caf9","#fc8d62","#1565c0"],"size":10,"symbol":"circle","line":{"color":"black","width":1}},"showlegend":false,"hoverinfo":"text","text":["<b>                       Event 1: 2020-01-22<\/b>","<b>                       Event 2: 2020-01-28<\/b>","<b>                       Event 1: 2020-01-23<\/b>","<b>                       Event 1: 2020-01-23<\/b>","<b>                       Event 2: 2020-01-28<\/b>","<b>                       Event 1: 2020-01-25<\/b>","<b>                       Event 1: 2020-01-25<\/b>","<b>                       Event 1: 2020-01-26<\/b>","<b>                       Event 1: 2020-01-27<\/b>","<b>                       Event 1: 2020-01-27<\/b>","<b>                       Event 1: 2020-01-27<\/b>","<b>                       Event 2: 2020-01-28<\/b>","<b>                       Event 2: 2020-01-28<\/b>","<b>                       Event 2: 2020-01-28<\/b>"],"inherit":true},"c74502f27b.2":{"mode":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":["2020-01-22 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-23 00:00:00.000000","2020-01-23 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-25 00:00:00.000000","2020-01-25 00:00:00.000000","2020-01-26 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-28 00:00:00.000000"],"y":[21.5,20.5,19.5,16.5,17.5,14.5,13.5,10.5,9.5,6.5,5.5,2.5,2.5,0.5],"text":["Event 1","Event 2","Event 1","Event 1","Event 2","Event 1","Event 1","Event 1","Event 1","Event 1","Event 1","Event 2","Event 2","Event 2"],"textfont":{"family":"Arial","size":14,"color":["rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)"]},"textposition":"center","showlegend":false,"hoverinfo":"none","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","plot_bgcolor":"#FCFCFC","shapes":[{"type":"line","x0":0,"x1":1,"xref":"paper","y0":4,"y1":4,"line":{"color":"grey65","width":0.5}},{"type":"line","x0":0,"x1":1,"xref":"paper","y0":6,"y1":6,"line":{"color":"grey65","width":0.5}},{"type":"line","x0":0,"x1":1,"xref":"paper","y0":8,"y1":8,"line":{"color":"grey65","width":0.5}},{"type":"line","x0":0,"x1":1,"xref":"paper","y0":10,"y1":10,"line":{"color":"grey65","width":0.5}},{"type":"line","x0":0,"x1":1,"xref":"paper","y0":12,"y1":12,"line":{"color":"grey65","width":0.5}},{"type":"line","x0":0,"x1":1,"xref":"paper","y0":14,"y1":14,"line":{"color":"grey65","width":0.5}},{"type":"line","x0":0,"x1":1,"xref":"paper","y0":16,"y1":16,"line":{"color":"grey65","width":0.5}},{"type":"line","x0":0,"x1":1,"xref":"paper","y0":18,"y1":18,"line":{"color":"grey65","width":0.5}},{"type":"line","x0":0,"x1":1,"xref":"paper","y0":20,"y1":20,"line":{"color":"grey65","width":0.5}}],"xaxis":{"domain":[0,1],"automargin":true,"linewidth":1,"mirror":true,"showgrid":true,"gridcolor":"grey90","title":""},"yaxis":{"domain":[0,1],"automargin":true,"linewidth":1,"mirror":true,"range":[0,22],"showgrid":false,"title":"","tickmode":"array","tickvals":[21,19,17,15,13,11,9,7,5,2],"ticktext":["Group A","Group B","Group C","Group D","Group E","Group F","Group G","Group H","Group I","Group J"]},"showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":["2020-01-22 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-23 00:00:00.000000","2020-01-23 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-25 00:00:00.000000","2020-01-25 00:00:00.000000","2020-01-26 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-28 00:00:00.000000"],"y":[21,21,19,17,17,15,13,11,9,7,5,3,2,1],"marker":{"color":["#90caf9","#fc8d62","#90caf9","#1565c0","#6a3d9a","#f44336","#90caf9","#8d6e63","#1565c0","#90caf9","#90a4ae","#90caf9","#fc8d62","#1565c0"],"size":10,"symbol":"circle","line":{"color":"black","width":1}},"showlegend":false,"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"text":["<b>                       Event 1: 2020-01-22<\/b>","<b>                       Event 2: 2020-01-28<\/b>","<b>                       Event 1: 2020-01-23<\/b>","<b>                       Event 1: 2020-01-23<\/b>","<b>                       Event 2: 2020-01-28<\/b>","<b>                       Event 1: 2020-01-25<\/b>","<b>                       Event 1: 2020-01-25<\/b>","<b>                       Event 1: 2020-01-26<\/b>","<b>                       Event 1: 2020-01-27<\/b>","<b>                       Event 1: 2020-01-27<\/b>","<b>                       Event 1: 2020-01-27<\/b>","<b>                       Event 2: 2020-01-28<\/b>","<b>                       Event 2: 2020-01-28<\/b>","<b>                       Event 2: 2020-01-28<\/b>"],"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"text","type":"scatter","x":["2020-01-22 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-23 00:00:00.000000","2020-01-23 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-25 00:00:00.000000","2020-01-25 00:00:00.000000","2020-01-26 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-27 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-28 00:00:00.000000","2020-01-28 00:00:00.000000"],"y":[21.5,20.5,19.5,16.5,17.5,14.5,13.5,10.5,9.5,6.5,5.5,2.5,2.5,0.5],"text":["Event 1","Event 2","Event 1","Event 1","Event 2","Event 1","Event 1","Event 1","Event 1","Event 1","Event 1","Event 2","Event 2","Event 2"],"textfont":{"family":"Arial","size":10,"color":["rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)","rgba(0,0,0,1)"]},"textposition":"right","showlegend":false,"hoverinfo":["none","none","none","none","none","none","none","none","none","none","none","none","none","none"],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
<div id="dags" class="section level2" number="33.6">
<h2>
<span class="header-section-number">33.6</span> DAGs<a class="anchor" aria-label="anchor" href="#dags"><i class="fas fa-link"></i></a>
</h2>
<p>You can build a DAG manually using the <strong>DiagammeR</strong> package and DOT language, as described in another tab. Alternatively, there are packages like <strong>ggdag</strong> and <strong>daggity</strong></p>
<p><a href="https://cran.r-project.org/web/packages/ggdag/vignettes/intro-to-dags.html" class="uri">https://cran.r-project.org/web/packages/ggdag/vignettes/intro-to-dags.html</a></p>
<p><a href="https://www.r-bloggers.com/2019/08/causal-inference-with-dags-in-r/#" class="uri">https://www.r-bloggers.com/2019/08/causal-inference-with-dags-in-r/#</a>:~:text=In%20a%20DAG%20all%20the,for%20drawing%20and%20analyzing%20DAGs.</p>
<!-- ======================================================= -->
</div>
<div id="resources-26" class="section level2" number="33.7">
<h2>
<span class="header-section-number">33.7</span> Resources<a class="anchor" aria-label="anchor" href="#resources-26"><i class="fas fa-link"></i></a>
</h2>
<p>Links to other online tutorials or resources.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="age-pyramids-and-likert-scales.html"><span class="header-section-number">32</span> Age pyramids and Likert-scales</a></div>
<div class="next"><a href="combinations-analysis.html"><span class="header-section-number">34</span> Combinations analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#diagrams"><span class="header-section-number">33</span> Diagrams</a></li>
<li><a class="nav-link" href="#overview-17"><span class="header-section-number">33.1</span> Overview</a></li>
<li><a class="nav-link" href="#preparation-22"><span class="header-section-number">33.2</span> Preparation</a></li>
<li>
<a class="nav-link" href="#flow-diagrams"><span class="header-section-number">33.3</span> Flow diagrams</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#simple-examples"><span class="header-section-number">33.3.1</span> Simple examples</a></li>
<li><a class="nav-link" href="#simple-examples">
Simple examples
</a></li>
<li><a class="nav-link" href="#syntax"><span class="header-section-number">33.3.2</span> Syntax</a></li>
<li><a class="nav-link" href="#complex-examples"><span class="header-section-number">33.3.3</span> Complex examples</a></li>
<li><a class="nav-link" href="#outputs"><span class="header-section-number">33.3.4</span> Outputs</a></li>
<li><a class="nav-link" href="#parameterized-figures"><span class="header-section-number">33.3.5</span> Parameterized figures</a></li>
<li><a class="nav-link" href="#parameterized-figures">
Parameterized figures
</a></li>
<li><a class="nav-link" href="#consort-diagram"><span class="header-section-number">33.3.6</span> CONSORT diagram</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#alluvialsankey-diagrams"><span class="header-section-number">33.4</span> Alluvial/Sankey Diagrams</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#preparation-23"><span class="header-section-number">33.4.1</span> Preparation</a></li>
<li><a class="nav-link" href="#plotting-from-dataset"><span class="header-section-number">33.4.2</span> Plotting from dataset</a></li>
</ul>
</li>
<li><a class="nav-link" href="#event-timelines"><span class="header-section-number">33.5</span> Event timelines</a></li>
<li><a class="nav-link" href="#dags"><span class="header-section-number">33.6</span> DAGs</a></li>
<li><a class="nav-link" href="#resources-26"><span class="header-section-number">33.7</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2021-03-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
