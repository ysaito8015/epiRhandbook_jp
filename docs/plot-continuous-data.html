<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>29 Plot continuous data | The Epidemiologist R Handbook</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.15/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">The Epidemiologist R Handbook</a></li>
<li class="book-part">About this book</li>
<li><a class="" href="style-and-editorial-notes.html"><span class="header-section-number">1</span> Style and editorial notes</a></li>
<li><a class="" href="datasets-used.html"><span class="header-section-number">2</span> Datasets used</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> R Basics</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transition to R</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">5</span> Import and export</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="suggested-packages.html"><span class="header-section-number">7</span> Suggested packages</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data.html"><span class="header-section-number">8</span> Cleaning data</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with dates</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">10</span> Factors</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">11</span> Pivoting data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">12</span> Grouping data</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">13</span> Joining data</a></li>
<li><a class="" href="characters-and-strings.html"><span class="header-section-number">14</span> Characters and strings</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></li>
<li><a class="" href="iteration-and-loops.html"><span class="header-section-number">16</span> Iteration and loops</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="missing-data.html"><span class="header-section-number">17</span> Missing data</a></li>
<li><a class="" href="descriptive-analysis.html"><span class="header-section-number">18</span> Descriptive analysis</a></li>
<li><a class="" href="univariate-and-multivariate-regression.html"><span class="header-section-number">19</span> Univariate and multivariate regression</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">20</span> Standardization</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">21</span> Moving averages</a></li>
<li><a class="" href="time-series-and-outbreak-detection.html"><span class="header-section-number">22</span> Time series and outbreak detection</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">23</span> Epidemic modeling</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">24</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">25</span> Survival analysis</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">26</span> GIS basics</a></li>
<li class="book-part">Data Vizualization</li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">27</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">28</span> Epidemic curves</a></li>
<li><a class="active" href="plot-continuous-data.html"><span class="header-section-number">29</span> Plot continuous data</a></li>
<li><a class="" href="plot-categorical-data.html"><span class="header-section-number">30</span> Plot categorical data</a></li>
<li><a class="" href="tables-1.html"><span class="header-section-number">31</span> Tables</a></li>
<li><a class="" href="age-pyramids-and-likert-scales.html"><span class="header-section-number">32</span> Age pyramids and Likert-scales</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">33</span> Diagrams</a></li>
<li><a class="" href="combination-analysis.html"><span class="header-section-number">34</span> Combination analysis</a></li>
<li><a class="" href="heatmaps.html"><span class="header-section-number">35</span> Heatmaps</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">36</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">37</span> Phylogenetic trees</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">38</span> Interactive plots</a></li>
<li class="book-part">Advanced</li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">39</span> Directory interactions</a></li>
<li><a class="" href="r-markdown-1.html"><span class="header-section-number">40</span> R Markdown</a></li>
<li><a class="" href="routine-reports.html"><span class="header-section-number">41</span> Routine reports</a></li>
<li><a class="" href="errors-warnings-1.html"><span class="header-section-number">42</span> Errors &amp; warnings</a></li>
<li><a class="" href="advanced-rstudio.html"><span class="header-section-number">43</span> Advanced RStudio</a></li>
<li><a class="" href="relational-databases.html"><span class="header-section-number">44</span> Relational databases</a></li>
<li><a class="" href="shiny-and-dashboards.html"><span class="header-section-number">45</span> Shiny and dashboards</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">46</span> Collaboration</a></li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">47</span> Writing functions</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">48</span> R on network drives</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="plot-continuous-data" class="section level1" number="29">
<h1>
<span class="header-section-number">29</span> Plot continuous data<a class="anchor" aria-label="anchor" href="#plot-continuous-data"><i class="fas fa-link"></i></a>
</h1>
<p>For appropriate plotting of continuous data, such as age, clinical measurements, and distance.</p>
<!-- ======================================================= -->
<div id="overview-15" class="section level2" number="29.1">
<h2>
<span class="header-section-number">29.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview-15"><i class="fas fa-link"></i></a>
</h2>
<h2>
Overview
<a class="anchor" aria-label="anchor" href="#overview-15"><i class="fas fa-link"></i></a>
</h2>
<p><code>Ggplot2</code>, part of the Tidyverse family, is a fantastic and versatile package for visualising continuous data. As usual, R also has built-in functions, which can be helpful for quick looks at the data.</p>
<p>Visualisations covered here include:</p>
<ul>
<li>Plots for one continuous variable:
<ul>
<li>
<strong>Histograms</strong>, the classic graph to present the distribution of a continuous variable.</li>
<li>
<strong>Box plots</strong> (also called box and whisker), in which the box represents the 25th, 50th, and 75th percentile of a continuous variable, and the line outside of this represent tail ends of distribution of the the continuous variable, and dots represent outliers.</li>
<li>
<strong>Violin plots</strong>, which are similar to histograms in that they show the distribution of a continuous variable based on the symettrical width of the ‘violin’.</li>
<li>
<strong>Jitter plots</strong>, which visualise the distribution of a continuous variable by showing all values as dots, rather than collectively as one larger shape. Each dot is ‘jittered’ so that they can all (mostly) be seen, even where two have the same value.</li>
<li>
<strong>Sina plots</strong>, are a cross between jitter and violin plots, where the individual points can be seen but in the symmetrical shape of the distribution (note this brings in the <code>ggforce</code> package).</li>
</ul>
</li>
<li>
<strong>Scatter plots</strong> for two continuous variables.</li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-792-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-792-2.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-792-3.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-792-4.png" width="50%"></p>
<!-- ======================================================= -->
</div>
<div id="preparation-18" class="section level2" number="29.2">
<h2>
<span class="header-section-number">29.2</span> Preparation<a class="anchor" aria-label="anchor" href="#preparation-18"><i class="fas fa-link"></i></a>
</h2>
<h2>
Preparation
<a class="anchor" aria-label="anchor" href="#preparation-18"><i class="fas fa-link"></i></a>
</h2>
<p>Preparation includes loading the relevant packages, here <code>ggplot2</code> and <code>dplyr</code>, and ensuring your data is the correct class and format. For the examples in this section, we use the simulated Ebola linelist, focusing on the continuous variables <code>age</code>, <code>wt_kg</code> (weight in kilos), <code>ct_blood</code> (CT values), and <code>days_onset_hosp</code> (difference between onset date and hospitalisation).</p>
<p>Note: You could load just <code>tidyverse</code>, which includes <code>ggplot2</code> and <code>tidyverse</code> among other packages (<code>stringr</code>, <code>tidyr</code>, for instance).</p>
<div class="sourceCode" id="cb1172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">ggplot2</span>,
               <span class="va">dplyr</span><span class="op">)</span>

<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"linelist_cleaned.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#Load the data</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,
         ct_blood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">ct_blood</span><span class="op">)</span>,
         days_onset_hosp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">days_onset_hosp</span><span class="op">)</span>,
         wt_kg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">wt_kg</span><span class="op">)</span><span class="op">)</span> <span class="co"># Converting vars to numeric as examples </span></code></pre></div>
<p>You should have conducted various data checks before this point, including checking the missingness of the data.</p>
<!-- ======================================================= -->
</div>
<div id="plotting-with-ggplot2" class="section level2" number="29.3">
<h2>
<span class="header-section-number">29.3</span> Plotting with ggplot2<a class="anchor" aria-label="anchor" href="#plotting-with-ggplot2"><i class="fas fa-link"></i></a>
</h2>
<h2>
Plotting with ggplot2
<a class="anchor" aria-label="anchor" href="#plotting-with-ggplot2"><i class="fas fa-link"></i></a>
</h2>
<div id="code-syntax-1" class="section level3" number="29.3.1">
<h3>
<span class="header-section-number">29.3.1</span> Code syntax<a class="anchor" aria-label="anchor" href="#code-syntax-1"><i class="fas fa-link"></i></a>
</h3>
<p>Ggplot2 has extensive functionality, and the same code syntax can be used for many different plot types.</p>
<p>A basic breakdown of the ggplot code is as follows:</p>
<pre><code>ggplot(data = linelist)+  
  geom_XXXX(aes(x = col1, y = col2),
       fill = "color") </code></pre>
<ul>
<li>
<code>ggplot()</code> starts off the function. You can specify the data and aesthetics (see next point) within the ggplot bracket, unless you are combining different data sources or plot types into one</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> stands for ‘aesthetics’, and is where the columns used for the visualisation are specified. For instance <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes(x = col1, y = col2)</a></code> to specify the data used for the x and y values (where y is the continuous variable in these examples).</li>
<li>
<code>fill</code> specifies the colour of the boxplot areas. One could also write <code>color</code> to specify outline or point colour.</li>
<li>
<code>geom_XXX</code> specifies what type of plot. Options include:
<ul>
<li>
<code>geom_boxplot()</code> for a boxplot</li>
<li>
<code>geom_histogram</code> for a histogram</li>
<li>
<code>geom_violin()</code> for a violin plot</li>
<li>
<code>geom_jitter()</code> for a jitter plot</li>
<li>
<code>geom_point()</code> for a scatter plot</li>
<li>
<code>geom_sina()</code> for a jitter plot where the width of the jitter is controlled by the density distribution of the data within each class</li>
</ul>
</li>
</ul>
<p>Note that the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> bracket can be within the <code>ggplot()</code> bracket or within the specific geom_XXX bracket. If you are layering different ggplots with diferent aesthetics, you will need to specify them within each geom_XXX.</p>
<p>For more see section on <a href="#ggplottips">ggplot tips</a>. We also walk through further customisation below.</p>
</div>
<div id="plotting-one-continuous-variable" class="section level3" number="29.3.2">
<h3>
<span class="header-section-number">29.3.2</span> Plotting one continuous variable<a class="anchor" aria-label="anchor" href="#plotting-one-continuous-variable"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Box plots</strong></p>
<p>Below is code for creating <strong>box plots</strong>, to show the distribution of CT values of Ebola patients in an entire dataset and by sub group. Note that for the subgroup breakdowns, the ‘NA’ values are also removed using dplyr, otherwise ggplot plots the age distribution for ‘NA’ as a separate boxplot.</p>
<div class="sourceCode" id="cb1174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Simple boxplot of one numeric variable</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ct_blood</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>  <span class="co"># only y variable given (no x variable)</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) Simple ggplot2 boxplot"</span><span class="op">)</span>

<span class="co"># B) Box plot by group</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ct_blood</span>,                            <span class="co"># Continous variable</span>
           x <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>                          <span class="co"># Grouping variable</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gold"</span><span class="op">)</span><span class="op">+</span>                      <span class="co"># Create the boxplot and specify colour</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B) ggplot2 boxplot by gender"</span><span class="op">)</span>      </code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-794-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-794-2.png" width="50%"></p>
<p><strong>Histograms</strong></p>
<p>Below is code for generating <strong>histograms</strong>, to show the distribution of CT values of Ebola patients. Within the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> bracket, you specify which variable you want to see the distribution of. You can supply either the x or the y, which will change the direction of the plot. The y or the x respectively will then show the count, represented by columns referred to as ‘bins’.</p>
<div class="sourceCode" id="cb1175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Regular histogram</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ct_blood</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>  <span class="co"># provide x variable</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) Simple ggplot2 histogram"</span><span class="op">)</span>

<span class="co"># B) Histogram with values across y axis</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ct_blood</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>  <span class="co"># provide y variable </span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B) Simple ggplot2 histogram with axes swapped"</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-795-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-795-2.png" width="50%"></p>
<p>In the examples above, R has guessed the most appropriate way to present the data, and issues a message to tell you how many bins (columns) it went with, and to prompt you to customise it yourself:</p>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p>It used 30 bins, and they look spaced out because some of them have 0 values. This relates to the way the values have been rounded.</p>
<p>To change this, you can specify <code>binwidth</code> (e.g. the range of values that the bin is counting) or <code>bins</code> (the number of bins) within the <code>geom_histogram</code> argument. These are then evenly grouped, between the minimum and maximum values of the histogram.</p>
<div class="sourceCode" id="cb1177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Histogram with specified bin number</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ct_blood</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>   <span class="co"># Provide x variable</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>bins<span class="op">=</span><span class="fl">10</span>,                     <span class="co"># Add bin number</span>
                 color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span>            <span class="co"># Add white outline so bars can easily be distinguished</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) Ggplot histogram with 10 bins"</span><span class="op">)</span>

<span class="co"># B) Histogram with specified bin width</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ct_blood</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>   <span class="co"># Provide y variable </span>
  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,                <span class="co"># Each bar includes a CT value range of 1</span>
                 color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span>            <span class="co"># Add white outline so bars can easily be distinguished</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B) Ggplot histogram with bindwidth of 1"</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-796-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-796-2.png" width="50%"></p>
<p>Rather than counts, you can change the stats within the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> bracket to specify proportions - see (plot A) below. You can also layer different histograms with different settings (plot B).</p>
<div class="sourceCode" id="cb1178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Histogram with proportion</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ct_blood</span>,           <span class="co"># provide x variable</span>
                            y <span class="op">=</span> <span class="fu">stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>    <span class="co"># Calculate proportion</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>bins<span class="op">=</span><span class="fl">10</span>,                           <span class="co"># Add bin number</span>
                 color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span> <span class="co"># Add white outline so bars can easily be distinguished</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) Ggplot histogram showing proportion"</span><span class="op">)</span>

<span class="co"># B) Layered histograms with different bin widths</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ct_blood</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>         <span class="co"># provide x variable </span>
  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>                    <span class="co"># Underlying layer has binwidth of 2</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>,                      <span class="co"># Top layer has binwidth of 1</span>
                 alpha <span class="op">=</span> <span class="fl">0.4</span>,                       <span class="co"># Set top layer to be slightly see through</span>
                 fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B) Layered ggplot histograms"</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-797-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-797-2.png" width="50%"></p>
<p><strong>Violin, jitter, and sina plots</strong></p>
<p>Below is code for creating <strong>violin plots</strong> (<code>geom_violin</code>) and <strong>jitter plots</strong> (<code>geom_jitter</code>) to show age distributions. One can specify that the ‘fill’ or ’color’is also determined by the data, thereby inserting these options within the <code>aes</code> bracket.</p>
<div class="sourceCode" id="cb1179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Violin plot by group</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>,                                <span class="co"># Continuous variable</span>
           x <span class="op">=</span> <span class="va">outcome</span>,                            <span class="co"># Grouping variable</span>
           fill <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>                       <span class="co"># fill variable (color of boxes)</span>
  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                                   <span class="co"># create the violin plot</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) ggplot2 violin plot by gender"</span><span class="op">)</span>    


<span class="co"># B) Jitter plot by group</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>,                               <span class="co"># Continuous variable</span>
           x <span class="op">=</span> <span class="va">outcome</span>,                           <span class="co"># Grouping variable</span>
           color <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co"># Color variable</span>
  <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                                  <span class="co"># Create the violin plot</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B) ggplot2 jitter plot by gender"</span><span class="op">)</span>     </code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-798-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-798-2.png" width="50%"></p>
<p>One can combine the two using the <code>geom_sina</code> option, which is actually part of the <code>ggforce</code> package. This can be easier to visually interpret. A) on the left shows basic layering of both a <code>geom_violin</code> and <code>geom_sina</code>. B) shows slightly more effort put into the appearance of the ggplot (see in-line comments).</p>
<div class="sourceCode" id="cb1180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">ggforce</span><span class="op">)</span>

<span class="co"># A) Sina plot by group</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>,             <span class="co"># numeric variable</span>
           x <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>      <span class="co"># group variable</span>
  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>                <span class="co"># create the violin plot</span>
  <span class="fu">geom_sina</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) ggplot() violin and sina plot by gender"</span><span class="op">)</span>      


<span class="co"># A) Sina plot by group</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span>,             <span class="co"># numeric variable</span>
           x <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>      <span class="co"># group variable</span>
  <span class="fu">geom_violin</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span>, <span class="co"># fill variable (color of violin background)</span>
              color <span class="op">=</span> <span class="st">"white"</span>,  <span class="co"># Plot has white outline rather than default black </span>
              alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>     <span class="co"># Alpha value where 0 transparent to 1 opaque</span>
  <span class="fu">geom_sina</span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span>,             <span class="co"># Change the size of the jitter</span>
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co"># color variable (color of dots)</span>
  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Death"</span> <span class="op">=</span> <span class="st">"#bf5300"</span>, 
                        <span class="st">"Recover"</span> <span class="op">=</span> <span class="st">"#11118c"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Define colours for death/recover </span>
                                                  <span class="co"># (but note they will come out a bit transparent)</span>
  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Death"</span> <span class="op">=</span> <span class="st">"#bf5300"</span>, 
                         <span class="st">"Recover"</span> <span class="op">=</span> <span class="st">"#11118c"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Define colours for death/recover</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>                                <span class="co"># Remove the gray background</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>                <span class="co"># Remove unnecessary legend</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B) ggplot() violin and sina plot by gender with formatting"</span><span class="op">)</span>      </code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-799-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-799-2.png" width="50%"></p>
</div>
<div id="plotting-one-continuous-variable-within-facets" class="section level3" number="29.3.3">
<h3>
<span class="header-section-number">29.3.3</span> Plotting one continuous variable within facets<a class="anchor" aria-label="anchor" href="#plotting-one-continuous-variable-within-facets"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Faceting basics</strong></p>
<p>To examine further subgroups, one can ‘facet’ the graph. This means the plot will be recreated within specified subgroups. One can use:</p>
<ul>
<li>
<code>facet_wrap()</code> - this will recreate the sub-graphs and present them alphabetically (typically, unless stated otherwise). You can invoke certain options to determine the look of the facets, e.g. <code>nrow=1</code> or <code>ncol=1</code> to control the number of rows or columns that the faceted plots are arranged within. See plot A below.</li>
<li>
<code>facet_grid()</code> - this is suited to seeing subgroups for particular combinations of discrete variables. See plot B below. <code>nrow</code> and <code>ncol</code> are not relevant, as the subgroups are presented in a grid, with the subgroups always in the x or y axis (see notes in code below)</li>
</ul>
<p>You can stipulate up to two faceting variables, with a ‘~’ between them. If only one faceting variable, a ‘.’ is used as a placeholder for a non-used second faceting variable - see code examples.</p>
<div class="sourceCode" id="cb1181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Histogram of hospitalisation dates faceted by hospital</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hospital</span> <span class="op">!=</span> <span class="st">"Missing"</span><span class="op">)</span>,               <span class="co"># filter removes unknown hospital</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_hospitalisation</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">7</span><span class="op">)</span> <span class="op">+</span>                        <span class="co"># Bindwidth = 7 days</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) Ggplot 2 histogram of hospitalisation dates by hospital"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">hospital</span><span class="op">~</span><span class="va">.</span>,                              <span class="co"># Facet by just hospital</span>
            ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>                                 <span class="co"># Facet in two columns</span>

<span class="co"># B) Boxplot of age faceted in a grid with two variables, gender and outcome</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>,    <span class="co"># filter retains non-missing gender/outcome</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) A Ggplot2 boxplot by gender and outcome"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">outcome</span><span class="op">~</span><span class="va">gender</span><span class="op">)</span>                          <span class="co"># Outcome is the row, gender is the column</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-800-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-800-2.png" width="50%"></p>
<p><strong>Further faceting options</strong></p>
<p>The scales used when facetting are consistent across subgroups, which is helpful for comparisons, but not always appropriate or optimal.</p>
<p>When using <code>facet_wrap</code> or <code>facet_grid</code>, we can add <code>scales = "free_y"</code> (plot A) so that the heights of the faceted histograms are standardised and the shapes are easier to compare. This is particularly useful if the actual counts are small for one of the subcategories and trends are otherwise hard to see. Instead of <code>free_y</code> we can also write <code>free_x</code> to do the same for the x axis or <code>free</code> for both axes. Note that in <code>facet_grid</code>, the y scales will be the same for facets in the same row, and the x scales will be the same for facets in the same column.</p>
<p>When using <code>facet_grid</code> only, we can add <code>space = "free_y"</code> or <code>space = "free_x"</code> so that the actual height or width of the facet is weighted to the values of the figure within. This only works if <code>scales = "free"</code> (y or x) already applies.</p>
<div class="sourceCode" id="cb1182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A) Facet hospitalsation date by hospital, free y axis</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hospital</span> <span class="op">!=</span> <span class="st">"Missing"</span><span class="op">)</span>, <span class="co"># filter removes unknown hospital</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_hospitalisation</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">7</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Bindwidth = 7 days</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) Histogram with free y axis scales"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">hospital</span><span class="op">~</span><span class="va">.</span>, <span class="co"># Facet with hospital as the row </span>
             scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="co"># Free the y scale of each facet</span>

<span class="co"># B) Facet hospitalisation date by hospital, free y axis and vertical spacing</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hospital</span> <span class="op">!=</span> <span class="st">"Missing"</span><span class="op">)</span>, <span class="co"># filter removes unknown hospital</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_hospitalisation</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">7</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Bindwidth = 7 days</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B) Histogram with free y axis scales and spacing"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">hospital</span><span class="op">~</span><span class="va">.</span>, <span class="co"># Facet with hospital as the row </span>
             scales <span class="op">=</span> <span class="st">"free_y"</span>, <span class="co"># Free the y scale of each facet</span>
             space <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="co"># Free the vertical spacing of each facet to optimise space</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-801-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-801-2.png" width="50%"></p>
</div>
<div id="plotting-two-continuous-variables" class="section level3" number="29.3.4">
<h3>
<span class="header-section-number">29.3.4</span> Plotting two continuous variables<a class="anchor" aria-label="anchor" href="#plotting-two-continuous-variables"><i class="fas fa-link"></i></a>
</h3>
<p>Following similar syntax, <code>geom_point</code> will allow one to plot two continuous variables against eachother in a <strong>scatter plot</strong>. This is useful for showing actual values rather than their distributions.</p>
<p>A basic scatter plot of age vs weight is shown in (A). In (B) we again use <code>facet_grid</code> to show the relationship between two continuous variables in the linelist.</p>
<div class="sourceCode" id="cb1183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Basic scatter plot of weight and age</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">wt_kg</span>, x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A) Scatter plot of weight and age"</span><span class="op">)</span>

<span class="co"># Scatter plot of weight and age by gender and Ebola outcome</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span>, <span class="co"># filter retains non-missing gender/outcome</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">wt_kg</span>, x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B) Scatter plot of weight and age faceted by gender and outcome"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">gender</span><span class="op">~</span><span class="va">outcome</span><span class="op">)</span> </code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-802-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-802-2.png" width="50%"></p>
<!-- ======================================================= -->
</div>
</div>
<div id="plotting-with-base-graphics" class="section level2" number="29.4">
<h2>
<span class="header-section-number">29.4</span> Plotting with base graphics<a class="anchor" aria-label="anchor" href="#plotting-with-base-graphics"><i class="fas fa-link"></i></a>
</h2>
<h2>
In-built graphics package
<a class="anchor" aria-label="anchor" href="#plotting-with-base-graphics"><i class="fas fa-link"></i></a>
</h2>
<p>Using base graphics can sometimes be quicker than ggplot, and is helpful for that initial first look.</p>
<div id="plotting-one-continuous-variable-1" class="section level3" number="29.4.1">
<h3>
<span class="header-section-number">29.4.1</span> Plotting one continuous variable<a class="anchor" aria-label="anchor" href="#plotting-one-continuous-variable-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Box plots and histograms</strong></p>
<p>The in-built graphics package comes with the <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> and <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code> functions, allowing straight-forward visualisation of a continuous variable.</p>
<div class="sourceCode" id="cb1184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Boxplot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">wt_kg</span>,
                  main <span class="op">=</span> <span class="st">"A) Base boxplot"</span><span class="op">)</span> 


<span class="co"># Histogram</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">wt_kg</span>,
                  main <span class="op">=</span> <span class="st">"B) Base histogram"</span><span class="op">)</span> </code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-803-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-803-2.png" width="50%"></p>
<p><strong>Further customisation</strong></p>
<p>Subgroups can also be shown, by subgroup or crossed groups. Note how with plot B below, <code>outcome</code> and <code>gender</code> are written as <code>outcome*gender</code> such that the boxplots are for the four combinations of the two columns. They do not get facetted across different rows and columns like in ggplot2.</p>
<p>We specify <code>linelist</code> as the dataset so we do not need to write <code>age</code> as <code>linelist$age</code></p>
<div class="sourceCode" id="cb1185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Box plot by subgroup</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">outcome</span>,
                  data <span class="op">=</span> <span class="va">linelist</span>, 
                  main <span class="op">=</span> <span class="st">"A) Base boxplot by subgroup"</span><span class="op">)</span>

<span class="co"># Box plot by crossed subgroups</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">outcome</span><span class="op">*</span><span class="va">gender</span>,
                  data <span class="op">=</span> <span class="va">linelist</span>, 
                  main <span class="op">=</span> <span class="st">"B) Base boxplot) by crossed groups"</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-804-1.png" width="50%"><img src="_main_files/figure-html/unnamed-chunk-804-2.png" width="50%"></p>
<p>Some further options with <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> shown below are:</p>
<ul>
<li>Boxplot width proportional to sample size (A)</li>
<li>Violin plots, with notched representing the median and x around it (B)</li>
<li>Horizontal (C)</li>
</ul>
<div class="sourceCode" id="cb1186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Varying width by sample size </span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span> <span class="op">~</span> <span class="va">linelist</span><span class="op">$</span><span class="va">outcome</span>,
                  varwidth <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># width varying by sample size</span>
                  main<span class="op">=</span><span class="st">"A) Proportional boxplot() widths"</span><span class="op">)</span>

                  
<span class="co"># Notched (violin plot), and varying width</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">outcome</span>,
        data<span class="op">=</span><span class="va">linelist</span>,
        notch<span class="op">=</span><span class="cn">TRUE</span>,      <span class="co"># notch at median</span>
        main<span class="op">=</span><span class="st">"B) Notched boxplot()"</span>,
        col<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gold"</span>,<span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span>,
        xlab<span class="op">=</span><span class="st">"Suppliment and Dose"</span><span class="op">)</span>

<span class="co"># Horizontal</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">outcome</span>,
        data<span class="op">=</span><span class="va">linelist</span>,
        horizontal<span class="op">=</span><span class="cn">TRUE</span>,  <span class="co"># flip to horizontal</span>
        col<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gold"</span>,<span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span>,
        main<span class="op">=</span><span class="st">"C) Horizontal boxplot()"</span>,
        xlab<span class="op">=</span><span class="st">"Suppliment and Dose"</span><span class="op">)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-805-1.png" width="33%"><img src="_main_files/figure-html/unnamed-chunk-805-2.png" width="33%"><img src="_main_files/figure-html/unnamed-chunk-805-3.png" width="33%"></p>
</div>
<div id="plotting-two-continuous-variables-1" class="section level3" number="29.4.2">
<h3>
<span class="header-section-number">29.4.2</span> Plotting two continuous variables<a class="anchor" aria-label="anchor" href="#plotting-two-continuous-variables-1"><i class="fas fa-link"></i></a>
</h3>
<p>Using base R, we can quickly visualise the relationship between two continuous variables with the <code>plot</code> function.</p>
<div class="sourceCode" id="cb1187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span>, <span class="va">linelist</span><span class="op">$</span><span class="va">wt_kg</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-806-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="resources-22" class="section level2" number="29.5">
<h2>
<span class="header-section-number">29.5</span> Resources<a class="anchor" aria-label="anchor" href="#resources-22"><i class="fas fa-link"></i></a>
</h2>
<h2>
Resources
<a class="anchor" aria-label="anchor" href="#resources-22"><i class="fas fa-link"></i></a>
</h2>
<p>There is a huge amount of help online, especially with ggplot. see:</p>
<ul>
<li><a href="http://r-statistics.co/ggplot2-cheatsheet.html" class="uri">http://r-statistics.co/ggplot2-cheatsheet.html</a></li>
<li><a href="https://biostats.w.uib.no/the-ggplot2-cheat-sheet-by-rstudio/" class="uri">https://biostats.w.uib.no/the-ggplot2-cheat-sheet-by-rstudio/</a></li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="epidemic-curves.html"><span class="header-section-number">28</span> Epidemic curves</a></div>
<div class="next"><a href="plot-categorical-data.html"><span class="header-section-number">30</span> Plot categorical data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#plot-continuous-data"><span class="header-section-number">29</span> Plot continuous data</a></li>
<li><a class="nav-link" href="#overview-15"><span class="header-section-number">29.1</span> Overview</a></li>
<li><a class="nav-link" href="#overview-15">
Overview
</a></li>
<li><a class="nav-link" href="#preparation-18"><span class="header-section-number">29.2</span> Preparation</a></li>
<li><a class="nav-link" href="#preparation-18">
Preparation
</a></li>
<li><a class="nav-link" href="#plotting-with-ggplot2"><span class="header-section-number">29.3</span> Plotting with ggplot2</a></li>
<li>
<a class="nav-link" href="#plotting-with-ggplot2">
Plotting with ggplot2
</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#code-syntax-1"><span class="header-section-number">29.3.1</span> Code syntax</a></li>
<li><a class="nav-link" href="#plotting-one-continuous-variable"><span class="header-section-number">29.3.2</span> Plotting one continuous variable</a></li>
<li><a class="nav-link" href="#plotting-one-continuous-variable-within-facets"><span class="header-section-number">29.3.3</span> Plotting one continuous variable within facets</a></li>
<li><a class="nav-link" href="#plotting-two-continuous-variables"><span class="header-section-number">29.3.4</span> Plotting two continuous variables</a></li>
</ul>
</li>
<li><a class="nav-link" href="#plotting-with-base-graphics"><span class="header-section-number">29.4</span> Plotting with base graphics</a></li>
<li>
<a class="nav-link" href="#plotting-with-base-graphics">
In-built graphics package
</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#plotting-one-continuous-variable-1"><span class="header-section-number">29.4.1</span> Plotting one continuous variable</a></li>
<li><a class="nav-link" href="#plotting-two-continuous-variables-1"><span class="header-section-number">29.4.2</span> Plotting two continuous variables</a></li>
</ul>
</li>
<li><a class="nav-link" href="#resources-22"><span class="header-section-number">29.5</span> Resources</a></li>
<li><a class="nav-link" href="#resources-22">
Resources
</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2021-03-09.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
