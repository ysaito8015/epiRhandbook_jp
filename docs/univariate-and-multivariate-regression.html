<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>18 Univariate and multivariate regression | The Epidemiologist R Handbook</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.15/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">About this book</li>
<li><a class="" href="style-and-editorial-notes.html"><span class="header-section-number">1</span> Style and editorial notes</a></li>
<li><a class="" href="datasets-used.html"><span class="header-section-number">2</span> Datasets used</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> R Basics</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transition to R</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">5</span> Import and export</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">7</span> Suggested packages</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Cleaning data and core functions</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with dates</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">10</span> Factors</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">11</span> Pivoting data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">12</span> Grouping data</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">13</span> Joining data</a></li>
<li><a class="" href="characters-and-strings.html"><span class="header-section-number">14</span> Characters and strings</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></li>
<li><a class="" href="iteration-and-loops.html"><span class="header-section-number">16</span> Iteration and loops</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="descriptive-analysis.html"><span class="header-section-number">17</span> Descriptive analysis</a></li>
<li><a class="active" href="univariate-and-multivariate-regression.html"><span class="header-section-number">18</span> Univariate and multivariate regression</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">19</span> Missing data</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">20</span> Standardization</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">21</span> Moving averages</a></li>
<li><a class="" href="time-series-and-outbreak-detection.html"><span class="header-section-number">22</span> Time series and outbreak detection</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">23</span> Epidemic modeling</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">24</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">25</span> Survival analysis</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">26</span> GIS basics</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">27</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">28</span> Epidemic curves</a></li>
<li><a class="" href="plot-continuous-data.html"><span class="header-section-number">29</span> Plot continuous data</a></li>
<li><a class="" href="plot-categorical-data.html"><span class="header-section-number">30</span> Plot categorical data</a></li>
<li><a class="" href="tables-1.html"><span class="header-section-number">31</span> Tables</a></li>
<li><a class="" href="age-pyramids-and-likert-scales.html"><span class="header-section-number">32</span> Age pyramids and Likert-scales</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">33</span> Diagrams</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">34</span> Combinations analysis</a></li>
<li><a class="" href="heatmaps.html"><span class="header-section-number">35</span> Heatmaps</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">36</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">37</span> Phylogenetic trees</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">38</span> Interactive plots</a></li>
<li class="book-part">Advanced</li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">39</span> Directory interactions</a></li>
<li><a class="" href="r-markdown-1.html"><span class="header-section-number">40</span> R Markdown</a></li>
<li><a class="" href="routine-reports.html"><span class="header-section-number">41</span> Routine reports</a></li>
<li><a class="" href="errors-warnings-1.html"><span class="header-section-number">42</span> Errors &amp; warnings</a></li>
<li><a class="" href="advanced-rstudio.html"><span class="header-section-number">43</span> Advanced RStudio</a></li>
<li><a class="" href="relational-databases.html"><span class="header-section-number">44</span> Relational databases</a></li>
<li><a class="" href="shiny-and-dashboards.html"><span class="header-section-number">45</span> Shiny and dashboards</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">46</span> Collaboration</a></li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">47</span> Writing functions</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">48</span> R on network drives</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="univariate-and-multivariate-regression" class="section level1" number="18">
<h1>
<span class="header-section-number">18</span> Univariate and multivariate regression<a class="anchor" aria-label="anchor" href="#univariate-and-multivariate-regression"><i class="fas fa-link"></i></a>
</h1>
<!-- ======================================================= -->
<div id="overview-5" class="section level2" number="18.1">
<h2>
<span class="header-section-number">18.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview-5"><i class="fas fa-link"></i></a>
</h2>
<p>This page demonstrates the use of <strong>gtstummary</strong> and <strong>base</strong> R regression function such as <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> to
look at associations between variables (e.g. odds ratios, risk ratios and hazard
ratios)</p>
<ol style="list-style-type: decimal">
<li>Univariate: two-by-two tables</li>
<li>Stratified: mantel-haenszel estimates</li>
<li>Multivariable: variable selection, model selection, final table</li>
<li>Forest plots</li>
</ol>
<!-- ======================================================= -->
</div>
<div id="preparation-7" class="section level2" number="18.2">
<h2>
<span class="header-section-number">18.2</span> Preparation<a class="anchor" aria-label="anchor" href="#preparation-7"><i class="fas fa-link"></i></a>
</h2>
<div id="packages-3" class="section level3 unnumbered">
<h3>Packages<a class="anchor" aria-label="anchor" href="#packages-3"><i class="fas fa-link"></i></a>
</h3>
<p>This code chunk shows the loading of packages required for the analyses.</p>
<div class="sourceCode" id="cb782"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span>
  <span class="va">rio</span>,          <span class="co"># File import</span>
  <span class="va">here</span>,         <span class="co"># File locator</span>
  <span class="va">tidyverse</span>,    <span class="co"># data management + ggplot2 graphics, </span>
  <span class="va">stringr</span>,      <span class="co"># manipulate text strings </span>
  <span class="va">purrr</span>,        <span class="co"># loop over objects in a tidy way</span>
  <span class="va">gtsummary</span>,    <span class="co"># summary statistics and tests </span>
  <span class="va">broom</span>,        <span class="co"># tidy up results from regressions</span>
  <span class="va">parameters</span>,   <span class="co"># alternative to tidy up results from regressions</span>
  <span class="va">see</span>           <span class="co"># alternative to visualise forest plots</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="load-data-3" class="section level3 unnumbered">
<h3>Load data<a class="anchor" aria-label="anchor" href="#load-data-3"><i class="fas fa-link"></i></a>
</h3>
<p>The example dataset used in this section is a linelist of individual cases from a simulated epidemic. The dataset is imported using the <code>import()</code> function from the <em>rio</em> package. See the page on <a href="import-and-export.html#import-and-export">Import and export</a> for various ways to import data.</p>
<div class="sourceCode" id="cb783"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># import the linelist</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_cleaned.xlsx"</span><span class="op">)</span></code></pre></div>
<p>The first 50 rows of the linelist are displayed below.</p>
<div id="htmlwidget-fe52f6381cbcb821d0b8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fe52f6381cbcb821d0b8">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2\" data-max=\"12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1399075200000\" data-max=\"1406419200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1399507200000\" data-max=\"1406505600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1.39968e+12\" data-max=\"1406678400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1400025600000\" data-max=\"1407715200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"51\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"51\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-29&quot;,&quot;30-49&quot;,&quot;50-69&quot;,&quot;70+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-24&quot;,&quot;25-29&quot;,&quot;30-34&quot;,&quot;35-39&quot;,&quot;40-44&quot;,&quot;45-49&quot;,&quot;50-54&quot;,&quot;55-59&quot;,&quot;60-64&quot;,&quot;65-69&quot;,&quot;70-74&quot;,&quot;75-79&quot;,&quot;80-84&quot;,&quot;85+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-13.2630592726116\" data-max=\"-13.2087039682346\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"8.45136291368722\" data-max=\"8.48802917129884\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"92\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"22\" data-max=\"257\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"20\" data-max=\"23\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"36\" data-max=\"37.8\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"486.111111111111\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["a3c8b8","d8a13d","5fe599","8689b7","11f8ea","893f25","be99c8","d0523a","ce9c02","275cc7","07e3e8","8a4580","2b8773","057e7a","be502d","4cff96","bab455","a6c614","c15f36","2eaa9a","2ebf95","c36eb4","02d8fd","af9f9a","88eff2","f50e8a","bc648d","567136","b799eb","67184b","170473","42e1a9","64c8ef","8ebf6e","e56412","0b46a0","188619","62a2ef","da8ecb","148f18","a9feb3","92ab68","58b968","f81362","6670a5","92ddf7","386dfb","3ad520","ae50c8","2ed605"],[4,4,4,4,2,3,3,7,5,5,4,4,5,7,5,6,5,5,5,5,6,8,9,6,5,10,9,6,5,6,7,12,6,7,9,9,7,9,5,6,6,8,10,8,9,9,9,7,9,9],["2014-05-07","2014-05-06","2014-05-08",null,null,"2014-05-18","2014-05-03","2014-05-20","2014-05-27","2014-05-24","2014-05-22",null,"2014-05-31","2014-06-04","2014-06-09","2014-06-05",null,"2014-06-05",null,"2014-06-07",null,"2014-06-15","2014-06-14",null,null,null,null,null,"2014-06-27",null,"2014-07-05",null,null,"2014-07-02","2014-07-12","2014-07-12","2014-07-05","2014-07-02","2014-06-20",null,"2014-06-29",null,"2014-07-18",null,"2014-07-18","2014-07-19","2014-07-19","2014-07-12","2014-07-20","2014-07-27"],["2014-05-08","2014-05-08","2014-05-13","2014-05-13","2014-05-16","2014-05-21","2014-05-22","2014-05-24","2014-05-27","2014-05-27","2014-05-27","2014-06-02","2014-06-06","2014-06-14","2014-06-15","2014-06-15","2014-06-15","2014-06-16","2014-06-17","2014-06-17","2014-06-19","2014-06-20","2014-06-20","2014-06-20","2014-06-20","2014-06-22","2014-06-30","2014-07-02","2014-07-03","2014-07-04","2014-07-09","2014-07-12","2014-07-14","2014-07-14","2014-07-15","2014-07-16","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-19","2014-07-19","2014-07-20","2014-07-20","2014-07-20","2014-07-23","2014-07-23","2014-07-24","2014-07-25","2014-07-28"],["2014-05-10","2014-05-10","2014-05-15","2014-05-14","2014-05-18","2014-05-22","2014-05-23","2014-05-26","2014-05-29","2014-05-28","2014-05-29","2014-06-02","2014-06-07","2014-06-15","2014-06-16","2014-06-16","2014-06-16","2014-06-18","2014-06-19","2014-06-17","2014-06-21","2014-06-21","2014-06-20","2014-06-20","2014-06-21","2014-06-23","2014-07-02","2014-07-03","2014-07-05","2014-07-06","2014-07-10","2014-07-14","2014-07-15","2014-07-14","2014-07-17","2014-07-16","2014-07-19","2014-07-19","2014-07-20","2014-07-20","2014-07-21","2014-07-20","2014-07-21","2014-07-21","2014-07-22","2014-07-25","2014-07-23","2014-07-24","2014-07-27","2014-07-30"],["2014-05-14",null,null,"2014-05-18","2014-05-30","2014-05-29","2014-05-24","2014-06-05","2014-06-17","2014-06-07","2014-06-01",null,"2014-06-16",null,"2014-06-19","2014-06-25","2014-06-18","2014-06-26","2014-06-28",null,"2014-06-23","2014-06-24","2014-07-01","2014-07-13","2014-06-24","2014-07-01","2014-07-14","2014-07-07","2014-07-12","2014-07-09","2014-08-09","2014-07-20","2014-07-25","2014-07-27","2014-07-19","2014-08-11","2014-07-24","2014-07-23","2014-08-01","2014-07-23","2014-08-03","2014-08-05","2014-07-28","2014-08-07","2014-08-01",null,null,null,"2014-08-08","2014-08-09"],["Recover",null,null,"Recover","Recover","Recover","Recover",null,"Death","Death","Recover","Death",null,"Recover","Death",null,"Death","Recover","Recover","Recover","Death","Death","Death",null,"Death",null,"Recover",null,"Recover","Death","Recover","Death","Recover","Recover","Death","Recover","Death","Death",null,"Death","Death",null,null,"Death","Death","Recover","Recover",null,"Death",null],["m","f","m","f","m","m","f","f","m","f","f","m","f","f","m","m","f","f","f","f","m","m","m","f","f","f","m","m","m","m","f","f","m","f","f","f","m","f","m","f","f","f","m","m","f","m","f","f","f","f"],[1,4,21,2,27,25,18,2,20,4,22,7,7,18,33,34,12,31,0,3,3,51,51,9,15,8,35,37,34,15,35,9,30,9,23,13,25,14,39,1,14,12,14,28,13,6,42,10,6,10],["years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years"],[1,4,21,2,27,25,18,2,20,4,22,7,7,18,33,34,12,31,0,3,3,51,51,9,15,8,35,37,34,15,35,9,30,9,23,13,25,14,39,1,14,12,14,28,13,6,42,10,6,10],["0-4","0-4","20-29","0-4","20-29","20-29","15-19","0-4","20-29","0-4","20-29","5-9","5-9","15-19","30-49","30-49","10-14","30-49","0-4","0-4","0-4","50-69","50-69","5-9","15-19","5-9","30-49","30-49","30-49","15-19","30-49","5-9","30-49","5-9","20-29","10-14","20-29","10-14","30-49","0-4","10-14","10-14","10-14","20-29","10-14","5-9","30-49","10-14","5-9","10-14"],["0-4","0-4","20-24","0-4","25-29","25-29","15-19","0-4","20-24","0-4","20-24","5-9","5-9","15-19","30-34","30-34","10-14","30-34","0-4","0-4","0-4","50-54","50-54","5-9","15-19","5-9","35-39","35-39","30-34","15-19","35-39","5-9","30-34","5-9","20-24","10-14","25-29","10-14","35-39","0-4","10-14","10-14","10-14","25-29","10-14","5-9","40-44","10-14","5-9","10-14"],["Port Hospital","St. Mark's Maternity Hospital (SMMH)","Other","Missing","St. Mark's Maternity Hospital (SMMH)","Military Hospital","Port Hospital","Missing","Port Hospital","Central Hospital","Missing","Military Hospital","Missing","Missing","Military Hospital","Port Hospital","Port Hospital","Other","Missing","Missing","Port Hospital","Port Hospital","Port Hospital","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital","Port Hospital","Port Hospital","Missing","Other","Military Hospital","Military Hospital","Central Hospital","Military Hospital","Central Hospital","Missing","Military Hospital","Central Hospital","Missing","Missing","St. Mark's Maternity Hospital (SMMH)","Military Hospital","Port Hospital","Other","Military Hospital","Missing","Military Hospital","Missing","Port Hospital","Military Hospital"],[-13.2231931914572,-13.2354719577436,-13.2157351064963,-13.2152339775486,-13.212910703914,-13.2228638912441,-13.222625321098,-13.2565628977111,-13.2243703238737,-13.2369393782451,-13.2331547837254,-13.2222002700958,-13.2149474159902,-13.2180326141688,-13.2535215623253,-13.217651519706,-13.2372027220014,-13.2190654487695,-13.2189533374241,-13.209391925612,-13.2265780018024,-13.2619688324425,-13.2124311244169,-13.2371313571269,-13.2195578885261,-13.2336087079551,-13.2130045468176,-13.2160657166043,-13.2162953240809,-13.2355883289789,-13.247814368147,-13.2142410663192,-13.2614705796373,-13.2630592726116,-13.2343341712241,-13.2087039682346,-13.2581175859281,-13.2379376608352,-13.218781651651,-13.2483677722899,-13.2155668757305,-13.2333516655879,-13.238964614443,-13.2163318124535,-13.2217866965605,-13.2221173306518,-13.2510797882678,-13.262635786914,-13.2472895700622,-13.2597714344876],[8.47325128269697,8.4627682729487,8.46897295100924,8.45171855856465,8.46481700596819,8.46082377490923,8.46183062600728,8.48379248016347,8.47024789713924,8.46916113869591,8.46272931462646,8.46388925014565,8.45192988292173,8.47155535608018,8.45884880725177,8.46236804334872,8.46956119136946,8.47737640975659,8.45136291368722,8.47570184950483,8.48676680560442,8.48475855218221,8.45344099552146,8.48777544809491,8.46210832824745,8.47804840685363,8.47135450705077,8.48802917129884,8.46395131808455,8.4728562695215,8.47038713612408,8.4641347894342,8.45750552360835,8.47493999153642,8.47832062438022,8.4763997148275,8.45535258467199,8.4697737543226,8.48438437371817,8.48466158574339,8.4627846208641,8.46517148129756,8.48776686246878,8.4630635336683,8.4623972994508,8.46420961833913,8.47178418137766,8.4632880274758,8.48450777619227,8.45925216791802],["2ae019","20b688","f547d6",null,null,"11f8ea","aec8ec","4b38b7","53da57","e02f66","893f25",null,"5387a2","cbbe78","a2086d","ba7326",null,"3ff1bc",null,"9f6884",null,"057e7a","e61cb9",null,null,null,null,null,"ea3740",null,"71577a",null,null,"567136","894024","894024","71577a","b0c500","eb2277",null,"af1c1f",null,"62a2ef",null,"67be4e","d15be5","f36522","312ecf","26c588","e26da6"],["other","other","other",null,null,"other","other","other","other","other","other",null,"other","funeral","other","other",null,"funeral",null,"other",null,"other","other",null,null,null,null,null,"other",null,"other",null,null,"other","funeral","funeral","other","other","funeral",null,"other",null,"other",null,"other","other","other","other","other","other"],[18,35,78,18,68,66,57,25,64,41,72,45,29,53,71,77,52,71,0,35,45,82,92,34,40,42,67,75,66,52,84,39,66,52,55,60,67,59,75,28,61,55,77,68,51,44,88,46,33,53],[50,74,148,61,198,161,116,48,156,75,144,109,99,140,157,146,118,162,22,62,58,195,257,114,144,96,206,172,176,125,229,88,177,88,150,151,169,136,186,24,124,147,163,167,152,89,188,112,72,139],[22,21,22,23,21,21,22,20,22,23,22,20,22,22,21,22,22,23,23,21,23,20,22,22,22,22,22,22,22,22,23,23,23,22,23,23,20,22,21,22,23,23,23,20,21,21,22,21,22,23],[null,"no","no",null,null,"no",null,"no","no","no","no","no","no","no",null,null,null,"no","no",null,"no","no","no","no","no",null,"no",null,null,"no",null,null,"no",null,"no","no","no","no","no","no","no","no","no","no","no","no",null,"no","no","no"],[null,"no","yes",null,null,"no",null,"yes","no","no","no","no","yes","yes",null,null,null,"no","no",null,"no","no","no","no","no",null,"no",null,null,"no",null,null,"yes",null,"no","no","no","yes","no","no","no","yes","yes","yes","no","no",null,"no","no","yes"],[null,"yes","yes",null,null,"yes",null,"no","yes","yes","yes","no","yes","yes",null,null,null,"yes","yes",null,"yes","no","yes","yes","yes",null,"yes",null,null,"yes",null,null,"yes",null,"no","yes","yes","yes","yes","no","yes","yes","no","yes","yes","yes",null,"yes","yes","yes"],[null,"no","yes",null,null,"no",null,"no","no","no","no","no","no","no",null,null,null,"no","no",null,"no","no","no","no","no",null,"no",null,null,"no",null,null,"no",null,"no","no","no","no","no","no","no","no","yes","no","no","yes",null,"no","no","no"],[null,"yes","yes",null,null,"yes",null,"yes","yes","no","yes","no","yes","yes",null,null,null,"no","yes",null,"no","yes","yes","no","yes",null,"yes",null,null,"yes",null,null,"no",null,"yes","yes","no","no","no","no","yes","yes","no","yes","no","no",null,"no","yes","no"],[37.3,37.4,37,36,36.7,37.3,36.8,37,36.4,37.2,37.3,36.9,37,36.9,37.3,37.1,36.7,36.6,37.7,37.6,36.8,36.9,36.6,37.7,37,36.4,36.4,37.4,36.3,37,37.5,37.8,36.8,37.5,37.4,36.5,37.2,36.6,37.3,36.3,37.2,36.9,36.4,36.4,36.2,37,37.2,37.3,36.4,37.5],["20:35","14:16","09:17","11:32","18:52","16:51",null,"14:29","11:57","09:21","13:08","23:20","17:29",null,"18:39",null,"14:16",null,"08:00","11:43","11:10","15:10","11:53","19:11",null,"14:26","04:17","17:32",null,null,"12:28",null,"10:12","10:39","16:46","19:50","16:06","13:52","11:28","07:40","12:60","15:24","06:27","06:17","09:36","14:01","17:06","12:57","13:07",null],[72,63.9152666179693,35.6099342585829,48.3740929857565,17.3451688603204,25.4619806334632,42.3602853745541,108.506944444444,26.2984878369494,72.8888888888889,34.7222222222222,37.8755996969952,29.5888174676053,27.0408163265306,28.8044139721693,36.1231000187652,37.3455903476013,27.0538027739674,0,91.05098855359,133.769322235434,21.5647600262985,13.9290526730155,26.1618959679902,19.2901234567901,45.5729166666667,15.7884814779904,25.3515413737155,21.3068181818182,33.28,16.018001182281,50.3615702479339,21.0667432730058,67.1487603305785,24.4444444444444,26.3146353230121,23.458562375267,31.8987889273356,21.6788067984738,486.111111111111,39.6722164412071,25.4523578138738,28.9811434378411,24.3823729785937,22.0740997229917,55.5485418507764,24.8981439565414,36.6709183673469,63.6574074074074,27.431292376171],[2,2,2,1,2,1,1,2,2,1,2,0,1,1,1,1,1,2,2,0,2,1,0,0,1,1,2,1,2,2,1,2,1,0,2,0,2,2,2,1,2,1,1,1,2,2,0,0,2,2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,8,10,14,15,18,19,20,26,28,29]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="clean-data" class="section level3 unnumbered">
<h3>Clean data<a class="anchor" aria-label="anchor" href="#clean-data"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Store the explanatory variables</strong></p>
<div class="sourceCode" id="cb784"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## define variables of interest </span>
<span class="va">explanatory_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"fever"</span>, <span class="st">"chills"</span>, <span class="st">"cough"</span>, <span class="st">"aches"</span>, <span class="st">"vomit"</span><span class="op">)</span></code></pre></div>
<p><strong>Convert to 1’s and 0’s</strong></p>
<p>Below we convert the explanatory columns from “yes”/“no” “m”/“f”, and “dead”/“alive” to <strong>1 / 0</strong>, to cooperate with the expectations of logistic regression models. To do this efficiently, we define a vector of the column names of our explanatory variables.</p>
<p>We apply the function <code>case_when()</code> to convert specified values to 1’s and 0’s. This function is applied all the <code>explanatory_vars</code> columns using <code>across()</code> (see page on <a href="grouping-data.html#grouping-data">Grouping data</a>).</p>
<div class="sourceCode" id="cb785"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## convert dichotomous variables to 0/1 </span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    <span class="co">## for each of the variables listed and "outcome"</span>
    <span class="fu">across</span><span class="op">(</span>
      <span class="fu">all_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">explanatory_vars</span>, <span class="st">"outcome"</span><span class="op">)</span><span class="op">)</span>, 
      <span class="co">## recode male, yes and death to 1; female, no and recover to 0</span>
      <span class="co">## otherwise set to missing</span>
           <span class="op">~</span><span class="fu">case_when</span><span class="op">(</span>
             <span class="va">.</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"yes"</span>, <span class="st">"Death"</span><span class="op">)</span>   <span class="op">~</span> <span class="fl">1</span>,
             <span class="va">.</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"no"</span>,  <span class="st">"Recover"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">0</span>, 
             <span class="cn">TRUE</span>                            <span class="op">~</span> <span class="cn">NA_real_</span>
           <span class="op">)</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><strong>Drop rows with missing values</strong><br>
To do this, we add the column <code>age</code> to the <code>explanatory_vars</code> (<code>age</code> would have produced an error in the previous <code>case_when()</code> operation). Then we pipe the <code>linelist</code> to <code>drop_na()</code> to remove any rows with missing values in the <code>outcome</code> column or any of the <code>explanatory_vars</code> columns.</p>
<div class="sourceCode" id="cb786"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## add in age_category to the explanatory vars </span>
<span class="va">explanatory_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">explanatory_vars</span>, <span class="st">"age_cat"</span><span class="op">)</span>

<span class="co">## drop rows with missing information for variables of interest </span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">drop_na</span><span class="op">(</span><span class="fu">any_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"outcome"</span>, <span class="va">explanatory_vars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The number of rows remaining in <code>linelist</code> is 4166.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="univariate" class="section level2" number="18.3">
<h2>
<span class="header-section-number">18.3</span> Univariate<a class="anchor" aria-label="anchor" href="#univariate"><i class="fas fa-link"></i></a>
</h2>
<p>Just like in the page on <a href="time-series-and-outbreak-detection.html#descriptive-analysis-2">Descriptive analysis</a>, your use case will determine which R package you use. We present two options for doing univariate analysis:</p>
<ul>
<li>Use functions available in <strong>base</strong> to quickly print results to the console. Accompanied with the <strong>broom</strong> package to tidy up the outputs.<br>
</li>
<li>Use the <strong>gtsummary</strong> package or you can use the individual regression</li>
</ul>
<!-- ======================================================= --><div id="gtsummary-package-2" class="section level3 unnumbered">
<h3>
<strong>gtsummary</strong> package<a class="anchor" aria-label="anchor" href="#gtsummary-package-2"><i class="fas fa-link"></i></a>
</h3>
<p>Below we present the use of <code>tbl_uvregression()</code> from the <strong>gtsummary</strong> package. Just like in the page on <a href="time-series-and-outbreak-detection.html#descriptive-analysis-2">Descriptive analysis</a>, <strong>gtsummary</strong> functions do a good job of running statistics <em>and</em> producing professional-looking outputs. This function produces a table of univariate regression results.</p>
<p>In this case, we select only the necessary columns from the <code>linelist</code> and then pipe into <code>tbl_uvregression()</code>. We are going to run univariate regression on each of the columns we defined as <code>explanatory_vars</code> in the Preparation section (gender, fever, chills, cough, aches, vomit, and age_cat).</p>
<p>Within the function itself, we provide the <code>method =</code> as <code>glm</code> (no quotes), the outcome column as <code>outcome</code>, specify that we want to run logistic regression (it’s in a list because you could specify multiple), and we tell it to exponentiate the results.</p>
<p>The output is HTML and contains the counts</p>
<div class="sourceCode" id="cb787"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">univ_tab</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="co">## select variables of interest</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">explanatory_vars</span>, <span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## produce univariate table</span>
  <span class="fu">tbl_uvregression</span><span class="op">(</span>
    <span class="co">## define regression want to run (generalised linear model)</span>
    method <span class="op">=</span> <span class="va">glm</span>, 
    <span class="co">## define outcome variable</span>
    y <span class="op">=</span> <span class="va">outcome</span>, 
    <span class="co">## define what type of glm want to run (logistic)</span>
    method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span>, 
    <span class="co">## exponentiate the outputs to produce odds ratios (rather than log odds)</span>
    exponentiate <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Note: Using an external vector in selections is ambiguous.
## i Use `all_of(explanatory_vars)` instead of `explanatory_vars` to silence this message.
## i See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.
## This message is displayed once per session.</code></pre>
<div class="sourceCode" id="cb789"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## view univariate results table </span>
<span class="va">univ_tab</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#wslnxncoxy .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wslnxncoxy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wslnxncoxy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wslnxncoxy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wslnxncoxy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wslnxncoxy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wslnxncoxy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wslnxncoxy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wslnxncoxy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wslnxncoxy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wslnxncoxy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wslnxncoxy .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#wslnxncoxy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wslnxncoxy .gt_from_md > :first-child {
  margin-top: 0;
}

#wslnxncoxy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wslnxncoxy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wslnxncoxy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#wslnxncoxy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wslnxncoxy .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#wslnxncoxy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wslnxncoxy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wslnxncoxy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wslnxncoxy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wslnxncoxy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wslnxncoxy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#wslnxncoxy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wslnxncoxy .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#wslnxncoxy .gt_left {
  text-align: left;
}

#wslnxncoxy .gt_center {
  text-align: center;
}

#wslnxncoxy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wslnxncoxy .gt_font_normal {
  font-weight: normal;
}

#wslnxncoxy .gt_font_bold {
  font-weight: bold;
}

#wslnxncoxy .gt_font_italic {
  font-style: italic;
}

#wslnxncoxy .gt_super {
  font-size: 65%;
}

#wslnxncoxy .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="wslnxncoxy" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><div class="inline-table"><table class="gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>OR</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">gender</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.89, 1.13</td>
      <td class="gt_row gt_center">&gt;0.9</td>
    </tr>
<tr>
<td class="gt_row gt_left">fever</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">0.94</td>
      <td class="gt_row gt_center">0.8100000000000001, 1.10</td>
      <td class="gt_row gt_center">0.5</td>
    </tr>
<tr>
<td class="gt_row gt_left">chills</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.86, 1.16</td>
      <td class="gt_row gt_center">&gt;0.9</td>
    </tr>
<tr>
<td class="gt_row gt_left">cough</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.91, 1.29</td>
      <td class="gt_row gt_center">0.4</td>
    </tr>
<tr>
<td class="gt_row gt_left">aches</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.89, 1.33</td>
      <td class="gt_row gt_center">0.4</td>
    </tr>
<tr>
<td class="gt_row gt_left">vomit</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.02</td>
      <td class="gt_row gt_center">0.90, 1.15</td>
      <td class="gt_row gt_center">0.7</td>
    </tr>
<tr>
<td class="gt_row gt_left">age_cat</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">0-4</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center"></td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">5-9</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">1.12</td>
      <td class="gt_row gt_center">0.92, 1.37</td>
      <td class="gt_row gt_center">0.3</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">10-14</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
      <td class="gt_row gt_center">0.71, 1.08</td>
      <td class="gt_row gt_center">0.2</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">15-19</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.89</td>
      <td class="gt_row gt_center">0.71, 1.10</td>
      <td class="gt_row gt_center">0.3</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">20-29</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.84</td>
      <td class="gt_row gt_center">0.69, 1.03</td>
      <td class="gt_row gt_center">0.093</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">30-49</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.85</td>
      <td class="gt_row gt_center">0.6800000000000000, 1.07</td>
      <td class="gt_row gt_center">0.2</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">50-69</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">1.15</td>
      <td class="gt_row gt_center">0.70, 1.91</td>
      <td class="gt_row gt_center">0.6</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">70+</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.70</td>
      <td class="gt_row gt_center">0.19, 2.55</td>
      <td class="gt_row gt_center">0.6</td>
    </tr>
</tbody>
<tfoot><tr class="gt_footnotes">
<td colspan="5">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks"><em>1</em>
          </sup>
           
          OR = Odds Ratio, CI = Confidence Interval
          <br></p>
      </td>
    </tr></tfoot>
</table></div></div>
<p>There are many modifications you can make to this table output, such as automatically bolding rows by their p-value, etc. See tutorials <a href="http://www.danieldsjoberg.com/gtsummary/articles/tbl_regression.html">here</a> and elsewhere online.</p>
<!-- ======================================================= -->
</div>
<div id="base-r-3" class="section level3 unnumbered">
<h3>
<strong>base</strong> R<a class="anchor" aria-label="anchor" href="#base-r-3"><i class="fas fa-link"></i></a>
</h3>
<p>To produce odds ratios or for logistic regression we use the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function from the <strong>stats</strong> package (part of <strong>base</strong> R). GLM is an acronym for Generalized Linear Model. Unlike <strong>gtsummary</strong>, you would need to run this multiple times (e.g. within a loop) to run univariate regression on multiple variables. An example of this is given below.</p>
<div id="univariate-glm-on-one-variable" class="section level4 unnumbered">
<h4>Univariate <code>glm()</code> on one variable<a class="anchor" aria-label="anchor" href="#univariate-glm-on-one-variable"><i class="fas fa-link"></i></a>
</h4>
<p>The model is provided to <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> as an equation, with the outcome on the left and explanatory variables on the right of a tilde <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code>. In this example we are assessing the association between different age categories and the outcome of death (now coded as 1, see Preparation section).</p>
<p>The dataset is specified to the <code>dataset =</code> argument.</p>
<p>The <code>family =</code> is set to “binomial” to indicate logistic regression. Options for <code>family =</code> are below. If necessary, you can also specify the link function in the syntax <code><a href="https://rdrr.io/r/stats/glm.html">glm(formula, family=familytype(link=linkfunction), data=)</a></code>.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Family</th>
<th>Default link function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"'binomial"</code></td>
<td><code>(link = "logit")</code></td>
</tr>
<tr class="even">
<td><code>"gaussian"</code></td>
<td><code>(link = "identity")</code></td>
</tr>
<tr class="odd">
<td><code>"Gamma"</code></td>
<td><code>(link = "inverse")</code></td>
</tr>
<tr class="even">
<td><code>"inverse.gaussian"</code></td>
<td><code>(link = "1/mu^2")</code></td>
</tr>
<tr class="odd">
<td><code>"poisson"</code></td>
<td><code>(link = "log")</code></td>
</tr>
<tr class="even">
<td><code>"quasi"</code></td>
<td><code>(link = "identity", variance = "constant")</code></td>
</tr>
<tr class="odd">
<td><code>"quasibinomial"</code></td>
<td><code>(link = "logit")</code></td>
</tr>
<tr class="even">
<td><code>"quasipoisson"</code></td>
<td><code>(link = "log")</code></td>
</tr>
</tbody>
</table></div>
<p>Type <code><a href="https://rdrr.io/r/stats/glm.html">?glm</a></code> for other options.</p>
<p>Below is how the output of <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> prints to the console - the log odds. The baseline reference category is the first factor level of <code>age_cat</code>.</p>
<div class="sourceCode" id="cb790"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">age_cat</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = outcome ~ age_cat, family = "binomial", data = linelist)
## 
## Coefficients:
##      (Intercept)        age_cat5-9      age_cat10-14      age_cat15-19      age_cat20-29      age_cat30-49      age_cat50-69  
##  0.3504829736908   0.1153452841444  -0.1350344585984  -0.1200783981396  -0.1704471321777  -0.1575793075663   0.1378697942231  
##       age_cat70+  
## -0.3504829736908  
## 
## Degrees of Freedom: 4165 Total (i.e. Null);  4158 Residual
## Null Deviance:       5692.60008553 
## Residual Deviance: 5680.329591051    AIC: 5696.329591051</code></pre>
<p>For a single exposure variable, use <code>tidy()</code> from
the <strong>broom</strong> package to get the <em>exponentiated</em> log odds ratio estimates and confidence
intervals. Here we demonstrate how to combine model outputs with a table of
counts.</p>
<div class="sourceCode" id="cb792"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>
  <span class="co">## define the variables of interest</span>
  <span class="va">outcome</span> <span class="op">~</span> <span class="va">age_cat</span>, 
  <span class="co">## define the type of regression (logistic)</span>
  family <span class="op">=</span> <span class="st">"binomial"</span>, 
  <span class="co">## define your dataset</span>
  data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## clean up the outputs of the regression (exponentiate and produce CIs)</span>
  <span class="fu">tidy</span><span class="op">(</span>
      exponentiate <span class="op">=</span> <span class="cn">TRUE</span>, 
      conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Below is the output of <code>model</code> (tidied via <strong>broom</strong>):</p>
<div id="htmlwidget-7f4f6aa458cdf5882baa" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7f4f6aa458cdf5882baa">{"x":{"filter":"none","data":[["(Intercept)","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[1.41975308641975,1.12226086956521,0.873685805181026,0.88685090653054,0.843287671232875,0.854209065679926,1.14782608695653,0.704347826086964],[0.0725281516142122,0.103371737718091,0.107487869536649,0.111912241756621,0.101431692893829,0.114124597940283,0.254999294305137,0.63660060695586],[4.83237151216922,1.11582998110183,-1.25627625871187,-1.07296928606517,-1.68041296871705,-1.38076550025416,0.540667355958042,-0.550553942081148],[1.34916185267902e-06,0.264494917802743,0.209015826507099,0.283284896941318,0.0928769945279497,0.167351074396827,0.588736882687725,0.581939489402831],[1.23226647073673,0.916500802901191,0.707661033942861,0.712182876056636,0.691113815153043,0.682988125337906,0.70077154612854,0.194441370159956],[1.63768180446066,1.37453458250274,1.07859619111972,1.10449986530824,1.02864348342241,1.06845967283842,1.9121113677472,2.55140977487603]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>We can combine these model results with a table of linelist counts. Below, we create the counts table by operating <strong>dplyr</strong> functions on the <code>linelist</code> used for the model:</p>
<ul>
<li>Group rows by outcome, and get counts by age category<br>
</li>
<li>Pivot wider so the column are <code>age_cat</code>, <code>0</code>, and <code>1</code><br>
</li>
<li>Remove row for <code>NA</code> <code>age_cat</code>, if applicable, to align with the model results</li>
</ul>
<div class="sourceCode" id="cb793"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts_table</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="co">## get counts of variable of interest grouped by outcome</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">count</span><span class="op">(</span><span class="va">age_cat</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## spread to wide format (as in cross-tabulation)</span>
  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">outcome</span>, values_from <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## drop rows with missings</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">age_cat</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-e8ae2ed75506b7967fbe" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e8ae2ed75506b7967fbe">{"x":{"filter":"none","data":[["0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+"],[324,300,287,247,365,235,27,5],[460,478,356,311,437,285,44,5]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>age_cat<\/th>\n      <th>0<\/th>\n      <th>1<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Now we can bind the two tables together horizontally with <code>bind_cols()</code>. In this case, the <code>.</code> represents the piped object <code>counts_table</code> and we bind it to <code>model</code>. Then we use <code>select()</code> to pick the columns to keep and their order.</p>
<div class="sourceCode" id="cb794"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">combined</span> <span class="op">&lt;-</span> <span class="va">counts_table</span> <span class="op">%&gt;%</span> 
  <span class="co">## merge with the outputs of the regression </span>
  <span class="fu">bind_cols</span><span class="op">(</span><span class="va">.</span>, <span class="va">model</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## only keep columns interested in </span>
  <span class="fu">select</span><span class="op">(</span><span class="va">term</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="va">estimate</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span>, <span class="va">p.value</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-57b514fa27bbcf13d877" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-57b514fa27bbcf13d877">{"x":{"filter":"none","data":[["(Intercept)","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[324,300,287,247,365,235,27,5],[460,478,356,311,437,285,44,5],[1.41975308641975,1.12226086956521,0.873685805181026,0.88685090653054,0.843287671232875,0.854209065679926,1.14782608695653,0.704347826086964],[1.23226647073673,0.916500802901191,0.707661033942861,0.712182876056636,0.691113815153043,0.682988125337906,0.70077154612854,0.194441370159956],[1.63768180446066,1.37453458250274,1.07859619111972,1.10449986530824,1.02864348342241,1.06845967283842,1.9121113677472,2.55140977487603],[1.34916185267902e-06,0.264494917802743,0.209015826507099,0.283284896941318,0.0928769945279497,0.167351074396827,0.588736882687725,0.581939489402831]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>0<\/th>\n      <th>1<\/th>\n      <th>estimate<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n      <th>p.value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="looping-multiple-univariate-models" class="section level4 unnumbered">
<h4>Looping multiple univariate models<a class="anchor" aria-label="anchor" href="#looping-multiple-univariate-models"><i class="fas fa-link"></i></a>
</h4>
<p>To run over several exposure variables to produce univariate odds ratios (i.e. 
not controlling for each other), you can pass a vector of variable names to the
<code>map()</code> function in the <strong>purrr</strong> package. This will loop over each of the variables
running regressions for each one. See the page on [Iteration] for tips.</p>
<p>Below we do the following:</p>
<ul>
<li>Create the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> equation and pass it to <code>map()</code> from <strong>purrr</strong> as the <code>.f</code> (formula argument) (see [Iteration] page)<br>
</li>
<li>Each of the resulting model outputs is passed sequentially to <code>tidy()</code> to exponentiate the log odds and CIs<br>
</li>
<li>The output (list of model result dataframe) is passed to <code>bind_rows()</code> which combines all of the dataframes into one</li>
</ul>
<div class="sourceCode" id="cb795"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">models</span> <span class="op">&lt;-</span> <span class="va">explanatory_vars</span> <span class="op">%&gt;%</span> 
  <span class="co">## combine each name of the variables of interest with the name of outcome variable</span>
  <span class="fu">str_c</span><span class="op">(</span><span class="st">"outcome ~ "</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## for each string above (outcome ~ "variable of interest)</span>
  <span class="fu">map</span><span class="op">(</span>
    <span class="co">## run a general linear model </span>
    <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>
      <span class="co">## define formula as each of the strings above</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, 
      <span class="co">## define type of glm (logistic)</span>
      family <span class="op">=</span> <span class="st">"binomial"</span>, 
      <span class="co">## define your dataset</span>
      data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## for each of the output regressions from above </span>
  <span class="fu">map</span><span class="op">(</span>
    <span class="co">## tidy the output</span>
    <span class="op">~</span><span class="fu">tidy</span><span class="op">(</span>
      <span class="co">## each of the regressions </span>
      <span class="va">.x</span>, 
      <span class="co">## exponentiate and produce CIs</span>
      exponentiate <span class="op">=</span> <span class="cn">TRUE</span>, 
      conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## collapse the list of regressions outputs in to one data frame</span>
  <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>This time, the end object <code>models</code> is longer because it now represents the combined results of several univariate regressions. Click through to see all the rows of <code>model</code>.</p>
<div id="htmlwidget-c321f84105b329dbf293" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c321f84105b329dbf293">{"x":{"filter":"none","data":[["(Intercept)","gender","(Intercept)","fever","(Intercept)","chills","(Intercept)","cough","(Intercept)","aches","(Intercept)","vomit","(Intercept)","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[1.32483370288248,1.00386558106223,1.38920454545456,0.944597557957971,1.32799442896937,0.99763879136929,1.23791821561336,1.08504362350519,1.31640866873065,1.08520360166643,1.31333333333333,1.02150230992985,1.41975308641975,1.12226086956521,0.873685805181026,0.88685090653054,0.843287671232875,0.854209065679926,1.14782608695653,0.704347826086964],[0.0441074543856476,0.0625965950170252,0.0698992049628882,0.0781744897792453,0.0349394143928741,0.0785990941018341,0.0819785040201466,0.0886984417930277,0.033008513022366,0.103941558600023,0.0442395162570597,0.0625959362923607,0.0725281516142122,0.103371737718091,0.107487869536649,0.111912241756621,0.101431692893829,0.114124597940283,0.254999294305137,0.63660060695586],[6.37731077934341,0.061634804595155,4.70293351764618,-0.729090870310299,8.11890699719667,-0.0300766911726174,2.60350091685179,0.920198715217595,8.3283764724229,0.7866691802096,6.1611983516713,0.339868653537918,4.83237151216922,1.11582998110183,-1.25627625871187,-1.07296928606517,-1.68041296871705,-1.38076550025416,0.540667355958042,-0.550553942081148],[1.80224509040466e-10,0.950853659562415,2.56449942554458e-06,0.465946078873413,4.70400809648889e-16,0.976005890069235,0.00922770208254959,0.35746892559263,8.19585274294372e-17,0.431475550185256,7.21964906407519e-10,0.733955443784423,1.34916185267902e-06,0.264494917802743,0.209015826507099,0.283284896941318,0.0928769945279497,0.167351074396827,0.588736882687725,0.581939489402831],[1.21530935303922,0.887953837948162,1.21189799839297,0.810063356142702,1.24022572860886,0.855455227732128,1.05456407901979,0.911493104242085,1.23405015738509,0.88594049587326,1.20444257874165,0.903558238081567,1.23226647073673,0.916500802901191,0.707661033942861,0.712182876056636,0.691113815153043,0.682988125337906,0.70077154612854,0.194441370159956],[1.44473211325652,1.13491652459549,1.59407902822589,1.1006225860711,1.42228810728841,1.16423394894221,1.45448463017748,1.29066748344803,1.40453174048118,1.33189254628991,1.43255567886807,1.15485792181377,1.63768180446066,1.37453458250274,1.07859619111972,1.10449986530824,1.02864348342241,1.06845967283842,1.9121113677472,2.55140977487603]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>As before, we can create a counts table from the <code>linelist</code>, bind it to <code>models</code>, and make a nice table. See the page on <a href="tables-1.html#tables-1">Tables</a> for ideas on how to convert this table to an HTML output.</p>
<div class="sourceCode" id="cb796"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## for each explanatory variable</span>
<span class="va">univ_tab_base</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="va">explanatory_vars</span>, 
      <span class="op">~</span><span class="op">{</span><span class="va">linelist</span> <span class="op">%&gt;%</span> 
          <span class="co">## group data set by outcome</span>
          <span class="fu">group_by</span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> 
          <span class="co">## produce counts for variable of interest</span>
          <span class="fu">count</span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> 
          <span class="co">## spread to wide format (as in cross-tabulation)</span>
          <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">outcome</span>, values_from <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span> 
          <span class="co">## drop rows with missings</span>
          <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
          <span class="co">## change the variable of interest column to be called "variable"</span>
          <span class="fu">rename</span><span class="op">(</span><span class="st">"variable"</span> <span class="op">=</span> <span class="va">.x</span><span class="op">)</span> <span class="op">%&gt;%</span> 
          <span class="co">## change the variable of interest column to be a character </span>
          <span class="co">## otherwise non-dichotomous (categorical) variables come out as factor and cant be merged</span>
          <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span>
                 <span class="op">}</span>
      <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## collapse the list of count outputs in to one data frame</span>
  <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## merge with the outputs of the regression </span>
  <span class="fu">bind_cols</span><span class="op">(</span><span class="va">.</span>, <span class="va">models</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## only keep columns interested in </span>
  <span class="fu">select</span><span class="op">(</span><span class="va">term</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="va">estimate</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span>, <span class="va">p.value</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-12e6f4a33dc0833348fa" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-12e6f4a33dc0833348fa">{"x":{"filter":"none","data":[["(Intercept)","gender","(Intercept)","fever","(Intercept)","chills","(Intercept)","cough","(Intercept)","aches","(Intercept)","vomit","(Intercept)","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[902,888,352,1438,1436,354,269,1521,1615,175,900,890,324,300,287,247,365,235,27,5],[1195,1181,489,1887,1907,469,333,2043,2126,250,1182,1194,460,478,356,311,437,285,44,5],[1.32483370288248,1.00386558106223,1.38920454545456,0.944597557957971,1.32799442896937,0.99763879136929,1.23791821561336,1.08504362350519,1.31640866873065,1.08520360166643,1.31333333333333,1.02150230992985,1.41975308641975,1.12226086956521,0.873685805181026,0.88685090653054,0.843287671232875,0.854209065679926,1.14782608695653,0.704347826086964],[1.21530935303922,0.887953837948162,1.21189799839297,0.810063356142702,1.24022572860886,0.855455227732128,1.05456407901979,0.911493104242085,1.23405015738509,0.88594049587326,1.20444257874165,0.903558238081567,1.23226647073673,0.916500802901191,0.707661033942861,0.712182876056636,0.691113815153043,0.682988125337906,0.70077154612854,0.194441370159956],[1.44473211325652,1.13491652459549,1.59407902822589,1.1006225860711,1.42228810728841,1.16423394894221,1.45448463017748,1.29066748344803,1.40453174048118,1.33189254628991,1.43255567886807,1.15485792181377,1.63768180446066,1.37453458250274,1.07859619111972,1.10449986530824,1.02864348342241,1.06845967283842,1.9121113677472,2.55140977487603],[1.80224509040466e-10,0.950853659562415,2.56449942554458e-06,0.465946078873413,4.70400809648889e-16,0.976005890069235,0.00922770208254959,0.35746892559263,8.19585274294372e-17,0.431475550185256,7.21964906407519e-10,0.733955443784423,1.34916185267902e-06,0.264494917802743,0.209015826507099,0.283284896941318,0.0928769945279497,0.167351074396827,0.588736882687725,0.581939489402831]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>0<\/th>\n      <th>1<\/th>\n      <th>estimate<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n      <th>p.value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
</div>
</div>
<div id="stratified" class="section level2" number="18.4">
<h2>
<span class="header-section-number">18.4</span> Stratified<a class="anchor" aria-label="anchor" href="#stratified"><i class="fas fa-link"></i></a>
</h2>
<p>Stratified analysis is currently still being worked on for <strong>gtsummary</strong>,
this page will be updated in due course.</p>
<!-- ======================================================= -->
<div id="gtsummary-package-3" class="section level3 unnumbered">
<h3>
<strong>gtsummary</strong> package<a class="anchor" aria-label="anchor" href="#gtsummary-package-3"><i class="fas fa-link"></i></a>
</h3>
<p>TODO</p>
<!-- ======================================================= -->
</div>
<div id="base-r-4" class="section level3 unnumbered">
<h3>
<strong>base</strong> R<a class="anchor" aria-label="anchor" href="#base-r-4"><i class="fas fa-link"></i></a>
</h3>
<p>TODO</p>
<!-- ======================================================= -->
</div>
</div>
<div id="multivariate" class="section level2 unnumbered">
<h2>Multivariate<a class="anchor" aria-label="anchor" href="#multivariate"><i class="fas fa-link"></i></a>
</h2>
<p>For multivariate analysis, there is not much difference between using
<strong>gtsummary</strong> or <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> with <strong>broom</strong> to present the data. The workflow is the same for both, as shown below, and only the last step of pulling a table together is different.</p>
<div id="conduct-multivariate" class="section level3 unnumbered">
<h3>Conduct multivariate<a class="anchor" aria-label="anchor" href="#conduct-multivariate"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> but add more variables to the right side of the equation, separated by plus symbols (<code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>). To run the model with all of our explanatory variables we would run:</p>
<div class="sourceCode" id="cb797"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mv_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">fever</span> <span class="op">+</span> <span class="va">chills</span> <span class="op">+</span> <span class="va">cough</span> <span class="op">+</span> <span class="va">aches</span> <span class="op">+</span> <span class="va">vomit</span> <span class="op">+</span> <span class="va">age_cat</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span>

<span class="va">mv_reg</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = outcome ~ gender + fever + chills + cough + aches + 
##     vomit + age_cat, family = "binomial", data = linelist)
## 
## Coefficients:
##         (Intercept)               gender                fever               chills                cough                aches  
##  2.849372217684e-01   3.742865638451e-02  -5.370896183542e-02   6.619053917735e-05   8.773254239124e-02   9.387777261175e-02  
##               vomit           age_cat5-9         age_cat10-14         age_cat15-19         age_cat20-29         age_cat30-49  
##  1.519181379066e-02   1.198091255806e-01  -1.338779520252e-01  -1.229281717264e-01  -1.750478448012e-01  -1.699321807023e-01  
##        age_cat50-69           age_cat70+  
##  1.150108017087e-01  -3.738310414287e-01  
## 
## Degrees of Freedom: 4165 Total (i.e. Null);  4152 Residual
## Null Deviance:       5692.60008553 
## Residual Deviance: 5677.760715687    AIC: 5705.760715687</code></pre>
<p><em>Optionally</em>, you can leverage the pre-defined vector of column names and re-create the above command using <code>str_c()</code> as shown below. This might be useful if your explanatory variable names are changing, or you don’t want to type them all out again.</p>
<div class="sourceCode" id="cb799"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## run a regression with all variables of interest </span>
<span class="va">mv_reg</span> <span class="op">&lt;-</span> <span class="va">explanatory_vars</span> <span class="op">%&gt;%</span> 
  <span class="co">## combine all names of the variables of interest separated by a plus</span>
  <span class="fu">str_c</span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## combined the names of variables of interest with outcome in formula style</span>
  <span class="fu">str_c</span><span class="op">(</span><span class="st">"outcome ~ "</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="co">## define type of glm (logistic)</span>
      family <span class="op">=</span> <span class="st">"binomial"</span>, 
      <span class="co">## define your dataset</span>
      data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span> </code></pre></div>
<p>Note the class of the saved model.</p>
<div class="sourceCode" id="cb800"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mv_reg</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "glm" "lm"</code></pre>
<p>Finally, you must take the model object and apply the <code><a href="https://rdrr.io/r/stats/step.html">step()</a></code> function from the <strong>stats</strong> package, to specify which variable selection direction you want use when building the model.</p>
<div class="sourceCode" id="cb802"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## choose a model using forward selection based on AIC</span>
<span class="co">## you can also do "backward" or "both" by adjusting the direction</span>
<span class="va">final_mv_reg</span> <span class="op">&lt;-</span> <span class="va">mv_reg</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/step.html">step</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"forward"</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>You can also turn off scientific notation, for clarity:</p>
<div class="sourceCode" id="cb803"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span></code></pre></div>
<p>Pass to <code>tidy()</code> as described above to exponentiate the log odds and CIs. Scroll through to see all the rows.</p>
<div class="sourceCode" id="cb804"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mv_tab_base</span> <span class="op">&lt;-</span> <span class="va">final_mv_reg</span> <span class="op">%&gt;%</span> 
  <span class="co">## get a tidy dataframe of estimates </span>
  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exponentiate <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-621313a580b2a28aabed" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-621313a580b2a28aabed">{"x":{"filter":"none","data":[["(Intercept)","gender","fever","chills","cough","aches","vomit","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[1.32967855063326,1.03813792992645,0.947707885532306,1.00006619272982,1.09169610054971,1.09842548003425,1.01530779597608,1.12728166181024,0.874696813063623,0.884327179974216,0.83941685807569,0.843722035291943,1.1218855557875,0.688093161245503],[0.130650961752286,0.0655874729979316,0.0784092913241007,0.0787914689128649,0.088899806513469,0.104285696821704,0.0628274636609634,0.103467419417683,0.107583684238341,0.112245270962909,0.102221850485643,0.11698354183298,0.257809465269017,0.638155597760784],[2.18090412766097,0.570667761291701,-0.684982110263109,0.000840072410003558,0.986869891307874,0.900197970314703,0.241802118141202,1.15794059864355,-1.24440757883474,-1.09517461779807,-1.71243079605403,-1.45261613761844,0.446107754766585,-0.58579920436395],[0.0291905083603911,0.568224876130345,0.493355209980187,0.99932971927294,0.323706426181102,0.36801490611796,0.808933497569369,0.24688827820658,0.213349594996188,0.273440143414354,0.0868173078097537,0.146330362917679,0.65551941144148,0.558010458471481],[1.02974314259116,0.912942897028373,0.812361490835864,0.857213800691668,0.916727351520246,0.896134369091899,0.897666200703283,0.920432015972304,0.7083474546394,0.709690091201061,0.686872994335676,0.670817319065761,0.681078783947211,0.189425886315536],[1.71878237703403,1.18062489836915,1.10476163151069,1.16750740951262,1.29910414307832,1.34903399352494,1.14836963101582,1.38094839883502,1.08004807525675,1.10207187228538,1.0255040196863,1.06124625554918,1.87874205950841,2.49948360276953]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="interaction-terms" class="section level3 unnumbered">
<h3>Interaction terms<a class="anchor" aria-label="anchor" href="#interaction-terms"><i class="fas fa-link"></i></a>
</h3>
<p>If you want to specify an interaction between two variables in <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>, separate the variables with a colon <code><a href="https://rdrr.io/r/base/Colon.html">:</a></code>. You can separate them with an asterisk <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> as shorthand to includ the two variables <em>and</em> their interaction:</p>
<div class="sourceCode" id="cb805"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age_cat</span> <span class="op">*</span> <span class="va">fever</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="combine-univariate-and-multivariate" class="section level3 unnumbered">
<h3>Combine univariate and multivariate<a class="anchor" aria-label="anchor" href="#combine-univariate-and-multivariate"><i class="fas fa-link"></i></a>
</h3>
<div id="combine-with-gtsummary" class="section level4 unnumbered">
<h4>Combine with <strong>gtsummary</strong><a class="anchor" aria-label="anchor" href="#combine-with-gtsummary"><i class="fas fa-link"></i></a>
</h4>
<p>The <code>gtsummary</code> package provides the <code>tbl_regression</code> function, which will
take the outputs from a regression (<code>glm</code> in this case) and produce an easy
summary table.
You can also combine several different output tables produced by <code>gtsummary</code> with
the <code>tbl_merge</code> function.</p>
<div class="sourceCode" id="cb806"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## show results table of final regression </span>
<span class="va">mv_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span><span class="va">final_mv_reg</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">## combine with univariate results </span>
<span class="fu">tbl_merge</span><span class="op">(</span>
  tbls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">univ_tab</span>, <span class="va">mv_tab</span><span class="op">)</span>, 
  tab_spanner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"**Univariate**"</span>, <span class="st">"**Multivariable**"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#tlvimlehyb .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tlvimlehyb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tlvimlehyb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tlvimlehyb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tlvimlehyb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tlvimlehyb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tlvimlehyb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tlvimlehyb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tlvimlehyb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tlvimlehyb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tlvimlehyb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tlvimlehyb .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#tlvimlehyb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tlvimlehyb .gt_from_md > :first-child {
  margin-top: 0;
}

#tlvimlehyb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tlvimlehyb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tlvimlehyb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#tlvimlehyb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tlvimlehyb .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#tlvimlehyb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tlvimlehyb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tlvimlehyb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tlvimlehyb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tlvimlehyb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tlvimlehyb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#tlvimlehyb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tlvimlehyb .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#tlvimlehyb .gt_left {
  text-align: left;
}

#tlvimlehyb .gt_center {
  text-align: center;
}

#tlvimlehyb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tlvimlehyb .gt_font_normal {
  font-weight: normal;
}

#tlvimlehyb .gt_font_bold {
  font-weight: bold;
}

#tlvimlehyb .gt_font_italic {
  font-style: italic;
}

#tlvimlehyb .gt_super {
  font-size: 65%;
}

#tlvimlehyb .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="tlvimlehyb" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><div class="inline-table"><table class="gt_table">
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="4">
        <span class="gt_column_spanner"><strong>Univariate</strong></span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner"><strong>Multivariable</strong></span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>OR</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>OR</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">gender</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.89, 1.13</td>
      <td class="gt_row gt_center">&gt;0.9</td>
      <td class="gt_row gt_center">1.04</td>
      <td class="gt_row gt_center">0.91, 1.18</td>
      <td class="gt_row gt_center">0.6</td>
    </tr>
<tr>
<td class="gt_row gt_left">fever</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">0.94</td>
      <td class="gt_row gt_center">0.8100000000000001, 1.10</td>
      <td class="gt_row gt_center">0.5</td>
      <td class="gt_row gt_center">0.95</td>
      <td class="gt_row gt_center">0.8100000000000001, 1.10</td>
      <td class="gt_row gt_center">0.5</td>
    </tr>
<tr>
<td class="gt_row gt_left">chills</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.86, 1.16</td>
      <td class="gt_row gt_center">&gt;0.9</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.86, 1.17</td>
      <td class="gt_row gt_center">&gt;0.9</td>
    </tr>
<tr>
<td class="gt_row gt_left">cough</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.91, 1.29</td>
      <td class="gt_row gt_center">0.4</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.92, 1.30</td>
      <td class="gt_row gt_center">0.3</td>
    </tr>
<tr>
<td class="gt_row gt_left">aches</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.89, 1.33</td>
      <td class="gt_row gt_center">0.4</td>
      <td class="gt_row gt_center">1.10</td>
      <td class="gt_row gt_center">0.90, 1.35</td>
      <td class="gt_row gt_center">0.4</td>
    </tr>
<tr>
<td class="gt_row gt_left">vomit</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.02</td>
      <td class="gt_row gt_center">0.90, 1.15</td>
      <td class="gt_row gt_center">0.7</td>
      <td class="gt_row gt_center">1.02</td>
      <td class="gt_row gt_center">0.90, 1.15</td>
      <td class="gt_row gt_center">0.8</td>
    </tr>
<tr>
<td class="gt_row gt_left">age_cat</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">0-4</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center"></td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">5-9</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">1.12</td>
      <td class="gt_row gt_center">0.92, 1.37</td>
      <td class="gt_row gt_center">0.3</td>
      <td class="gt_row gt_center">1.13</td>
      <td class="gt_row gt_center">0.92, 1.38</td>
      <td class="gt_row gt_center">0.2</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">10-14</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
      <td class="gt_row gt_center">0.71, 1.08</td>
      <td class="gt_row gt_center">0.2</td>
      <td class="gt_row gt_center">0.87</td>
      <td class="gt_row gt_center">0.71, 1.08</td>
      <td class="gt_row gt_center">0.2</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">15-19</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.89</td>
      <td class="gt_row gt_center">0.71, 1.10</td>
      <td class="gt_row gt_center">0.3</td>
      <td class="gt_row gt_center">0.88</td>
      <td class="gt_row gt_center">0.71, 1.10</td>
      <td class="gt_row gt_center">0.3</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">20-29</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.84</td>
      <td class="gt_row gt_center">0.69, 1.03</td>
      <td class="gt_row gt_center">0.093</td>
      <td class="gt_row gt_center">0.84</td>
      <td class="gt_row gt_center">0.69, 1.03</td>
      <td class="gt_row gt_center">0.08699999999999999</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">30-49</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.85</td>
      <td class="gt_row gt_center">0.6800000000000000, 1.07</td>
      <td class="gt_row gt_center">0.2</td>
      <td class="gt_row gt_center">0.84</td>
      <td class="gt_row gt_center">0.67, 1.06</td>
      <td class="gt_row gt_center">0.15</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">50-69</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">1.15</td>
      <td class="gt_row gt_center">0.70, 1.91</td>
      <td class="gt_row gt_center">0.6</td>
      <td class="gt_row gt_center">1.12</td>
      <td class="gt_row gt_center">0.6800000000000000, 1.88</td>
      <td class="gt_row gt_center">0.7</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">70+</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.70</td>
      <td class="gt_row gt_center">0.19, 2.55</td>
      <td class="gt_row gt_center">0.6</td>
      <td class="gt_row gt_center">0.69</td>
      <td class="gt_row gt_center">0.19, 2.50</td>
      <td class="gt_row gt_center">0.6</td>
    </tr>
</tbody>
<tfoot><tr class="gt_footnotes">
<td colspan="8">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks"><em>1</em>
          </sup>
           
          OR = Odds Ratio, CI = Confidence Interval
          <br></p>
      </td>
    </tr></tfoot>
</table></div></div>
</div>
<div id="combine-with-dplyr" class="section level4 unnumbered">
<h4>Combine with <strong>dplyr</strong><a class="anchor" aria-label="anchor" href="#combine-with-dplyr"><i class="fas fa-link"></i></a>
</h4>
<p>To combine the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>/<code>tidy()</code>univariate and multivariate outputs, you can also do the following with <strong>dplyr</strong> join functions.</p>
<ul>
<li>Join the univariate results from earlier (which contains counts) with the tidied multivariate results<br>
</li>
<li>Use <code>select()</code> to keep only the columns we want, specify their order, and re-name them<br>
</li>
<li>Use <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code> with two decimal places on all the column that are class Double</li>
</ul>
<div class="sourceCode" id="cb807"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## combine univariate and multivariable tables </span>
<span class="fu">left_join</span><span class="op">(</span><span class="va">univ_tab_base</span>, <span class="va">mv_tab_base</span>, by <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## choose columns and rename them</span>
  <span class="fu">select</span><span class="op">(</span> <span class="co"># new name =  old name</span>
    <span class="st">"characteristic"</span> <span class="op">=</span> <span class="va">term</span>, 
    <span class="st">"recovered"</span>      <span class="op">=</span> <span class="st">"0"</span>, 
    <span class="st">"dead"</span>           <span class="op">=</span> <span class="st">"1"</span>, 
    <span class="st">"univ_or"</span>        <span class="op">=</span> <span class="va">estimate.x</span>, 
    <span class="st">"univ_ci_low"</span>    <span class="op">=</span> <span class="va">conf.low.x</span>, 
    <span class="st">"univ_ci_high"</span>   <span class="op">=</span> <span class="va">conf.high.x</span>,
    <span class="st">"univ_pval"</span>      <span class="op">=</span> <span class="va">p.value.x</span>, 
    <span class="st">"mv_or"</span>          <span class="op">=</span> <span class="va">estimate.y</span>, 
    <span class="st">"mvv_ci_low"</span>     <span class="op">=</span> <span class="va">conf.low.y</span>, 
    <span class="st">"mv_ci_high"</span>     <span class="op">=</span> <span class="va">conf.high.y</span>,
    <span class="st">"mv_pval"</span>        <span class="op">=</span> <span class="va">p.value.y</span> 
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">is.double</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Problem with `mutate()` input `..1`.
## i Predicate functions must be wrapped in `where()`.
## 
##   # Bad
##   data %&gt;% select(is.double)
## 
##   # Good
##   data %&gt;% select(where(is.double))
## 
## i Please update your code.
## This message is displayed once per session.
## i Input `..1` is `across(is.double, round, 2)`.</code></pre>
<pre><code>## # A tibble: 20 x 11
##    characteristic recovered  dead univ_or univ_ci_low univ_ci_high univ_pval mv_or mvv_ci_low mv_ci_high mv_pval
##    &lt;chr&gt;              &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1 (Intercept)          902  1195    1.32        1.22         1.44     0      1.33       1.03       1.72   0.03 
##  2 gender               888  1181    1           0.89         1.13     0.95   1.04       0.91       1.18   0.570
##  3 (Intercept)          352   489    1.39        1.21         1.59     0      1.33       1.03       1.72   0.03 
##  4 fever               1438  1887    0.94        0.81         1.1      0.47   0.95       0.81       1.1    0.49 
##  5 (Intercept)         1436  1907    1.33        1.24         1.42     0      1.33       1.03       1.72   0.03 
##  6 chills               354   469    1           0.86         1.16     0.98   1          0.86       1.17   1    
##  7 (Intercept)          269   333    1.24        1.05         1.45     0.01   1.33       1.03       1.72   0.03 
##  8 cough               1521  2043    1.09        0.91         1.29     0.36   1.09       0.92       1.3    0.32 
##  9 (Intercept)         1615  2126    1.32        1.23         1.4      0      1.33       1.03       1.72   0.03 
## 10 aches                175   250    1.09        0.89         1.33     0.43   1.1        0.9        1.35   0.37 
## 11 (Intercept)          900  1182    1.31        1.2          1.43     0      1.33       1.03       1.72   0.03 
## 12 vomit                890  1194    1.02        0.9          1.15     0.73   1.02       0.9        1.15   0.81 
## 13 (Intercept)          324   460    1.42        1.23         1.64     0      1.33       1.03       1.72   0.03 
## 14 age_cat5-9           300   478    1.12        0.92         1.37     0.26   1.13       0.92       1.38   0.25 
## 15 age_cat10-14         287   356    0.87        0.71         1.08     0.21   0.87       0.71       1.08   0.21 
## 16 age_cat15-19         247   311    0.89        0.71         1.1      0.28   0.88       0.71       1.1    0.27 
## 17 age_cat20-29         365   437    0.84        0.69         1.03     0.09   0.84       0.69       1.03   0.09 
## 18 age_cat30-49         235   285    0.85        0.68         1.07     0.17   0.84       0.67       1.06   0.15 
## 19 age_cat50-69          27    44    1.15        0.7          1.91     0.59   1.12       0.68       1.88   0.66 
## 20 age_cat70+             5     5    0.7         0.19         2.55     0.580  0.69       0.19       2.5    0.56</code></pre>
<!-- ======================================================= -->
</div>
</div>
</div>
<div id="forest-plot" class="section level2" number="18.5">
<h2>
<span class="header-section-number">18.5</span> Forest plot<a class="anchor" aria-label="anchor" href="#forest-plot"><i class="fas fa-link"></i></a>
</h2>
<p>This section shows how to produce a plot with the outputs of your regression.
There are two options, you can build a plot yourself using <code>ggplot2</code> or use a
package called <strong>easystats</strong>.</p>
<!-- ======================================================= -->
<div id="ggplot2-package" class="section level3 unnumbered">
<h3>
<strong>ggplot2</strong> package<a class="anchor" aria-label="anchor" href="#ggplot2-package"><i class="fas fa-link"></i></a>
</h3>
<p>You can build a forest plot with <code>ggplot()</code> by plotting elements of the multivariate regression results. Add the layers:</p>
<ul>
<li>estimates with <code>geom_point()</code><br>
</li>
<li>confidence intervals with <code>geom_errorbar()</code><br>
</li>
<li>a vertical line at OR = 1 with <code>geom_vline()</code>
</li>
</ul>
<p>You may want to re-arrange the order of the variables/levels on the y-axis (see how the order of age_cat levels is alphabetical and not sensical). To do this, use <code>fct_relevel()</code> from the <strong>forcats</strong> package to classify the column <code>term</code> as a factor and specify the order manually. See the page on <a href="factors.html#factors">Factors</a> for more details.</p>
<div class="sourceCode" id="cb810"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## remove the intercept term from your multivariable results</span>
<span class="va">mv_tab_base</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## plot with variable on the y axis and estimate (OR) on the x axis</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, y <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">## show the estimate as a point</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="co">## add in an error bar for the confidence intervals</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">conf.low</span>, xmax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="co">## show where OR = 1 is for reference as a dashed line</span>
  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/ggplot_forest-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
<div id="easystats-packages" class="section level3 unnumbered">
<h3>
<strong>easystats</strong> packages<a class="anchor" aria-label="anchor" href="#easystats-packages"><i class="fas fa-link"></i></a>
</h3>
<p>The alternative if you do not want to decide all of the different things required
for a <code>ggplot</code>, is to use a combination of <code>easystats</code> packages.
In this case the <code>paramaters</code> package function <code>model_parameters</code> does the equivalent
of <code>broom</code> package function <code>tidy</code>. The <code>see</code> package then accepts those outputs
and creates a default forest plot as a <code>ggplot</code> object.</p>
<div class="sourceCode" id="cb811"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## remove the intercept term from your multivariable results</span>
<span class="va">final_mv_reg</span> <span class="op">%&gt;%</span> 
  <span class="fu">model_parameters</span><span class="op">(</span>exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/easystats_forest-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="resources-11" class="section level2" number="18.6">
<h2>
<span class="header-section-number">18.6</span> Resources<a class="anchor" aria-label="anchor" href="#resources-11"><i class="fas fa-link"></i></a>
</h2>
<p>Much of the information in this page is adapted from these resources and vignettes online:</p>
<p><a href="http://www.danieldsjoberg.com/gtsummary/articles/tbl_regression.html">gtsummary</a></p>
<p><a href="http://www.sthda.com/english/articles/36-classification-methods-essentials/150-stepwise-logistic-regression-essentials-in-r/">sthda stepwise regression</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="descriptive-analysis.html"><span class="header-section-number">17</span> Descriptive analysis</a></div>
<div class="next"><a href="missing-data.html"><span class="header-section-number">19</span> Missing data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#univariate-and-multivariate-regression"><span class="header-section-number">18</span> Univariate and multivariate regression</a></li>
<li><a class="nav-link" href="#overview-5"><span class="header-section-number">18.1</span> Overview</a></li>
<li>
<a class="nav-link" href="#preparation-7"><span class="header-section-number">18.2</span> Preparation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#packages-3">Packages</a></li>
<li><a class="nav-link" href="#load-data-3">Load data</a></li>
<li><a class="nav-link" href="#clean-data">Clean data</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#univariate"><span class="header-section-number">18.3</span> Univariate</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#gtsummary-package-2">gtsummary package</a></li>
<li><a class="nav-link" href="#base-r-3">base R</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#stratified"><span class="header-section-number">18.4</span> Stratified</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#gtsummary-package-3">gtsummary package</a></li>
<li><a class="nav-link" href="#base-r-4">base R</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#multivariate">Multivariate</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#conduct-multivariate">Conduct multivariate</a></li>
<li><a class="nav-link" href="#interaction-terms">Interaction terms</a></li>
<li><a class="nav-link" href="#combine-univariate-and-multivariate">Combine univariate and multivariate</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#forest-plot"><span class="header-section-number">18.5</span> Forest plot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ggplot2-package">ggplot2 package</a></li>
<li><a class="nav-link" href="#easystats-packages">easystats packages</a></li>
</ul>
</li>
<li><a class="nav-link" href="#resources-11"><span class="header-section-number">18.6</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2021-03-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
