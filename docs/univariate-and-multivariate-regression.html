<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>18 Univariate and multivariate regression | The Epidemiologist R Handbook</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.15/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">About this book</li>
<li><a class="" href="style-and-editorial-notes.html"><span class="header-section-number">1</span> Style and editorial notes</a></li>
<li><a class="" href="datasets-used.html"><span class="header-section-number">2</span> Datasets used</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> R Basics</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transition to R</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">5</span> Import and export</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">7</span> Suggested packages</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Cleaning data and core functions</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with dates</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">10</span> Factors</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">11</span> Pivoting data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">12</span> Grouping data</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">13</span> Joining data</a></li>
<li><a class="" href="characters-and-strings.html"><span class="header-section-number">14</span> Characters and strings</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></li>
<li><a class="" href="iteration-and-loops.html"><span class="header-section-number">16</span> Iteration and loops</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="descriptive-analysis.html"><span class="header-section-number">17</span> Descriptive analysis</a></li>
<li><a class="active" href="univariate-and-multivariate-regression.html"><span class="header-section-number">18</span> Univariate and multivariate regression</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">19</span> Missing data</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">20</span> Standardization</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">21</span> Moving averages</a></li>
<li><a class="" href="time-series-and-outbreak-detection.html"><span class="header-section-number">22</span> Time series and outbreak detection</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">23</span> Epidemic modeling</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">24</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">25</span> Survival analysis</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">26</span> GIS basics</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">27</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">28</span> Epidemic curves</a></li>
<li><a class="" href="plot-continuous-data.html"><span class="header-section-number">29</span> Plot continuous data</a></li>
<li><a class="" href="plot-categorical-data.html"><span class="header-section-number">30</span> Plot categorical data</a></li>
<li><a class="" href="tables.html"><span class="header-section-number">31</span> Tables</a></li>
<li><a class="" href="age-pyramids-and-likert-scales.html"><span class="header-section-number">32</span> Age pyramids and Likert-scales</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">33</span> Diagrams</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">34</span> Combinations analysis</a></li>
<li><a class="" href="heatmaps.html"><span class="header-section-number">35</span> Heatmaps</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">36</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">37</span> Phylogenetic trees</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">38</span> Interactive plots</a></li>
<li class="book-part">Advanced</li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">39</span> Directory interactions</a></li>
<li><a class="" href="r-markdown-1.html"><span class="header-section-number">40</span> R Markdown</a></li>
<li><a class="" href="routine-reports.html"><span class="header-section-number">41</span> Routine reports</a></li>
<li><a class="" href="errors-warnings-1.html"><span class="header-section-number">42</span> Errors &amp; warnings</a></li>
<li><a class="" href="advanced-rstudio.html"><span class="header-section-number">43</span> Advanced RStudio</a></li>
<li><a class="" href="relational-databases.html"><span class="header-section-number">44</span> Relational databases</a></li>
<li><a class="" href="shiny-and-dashboards.html"><span class="header-section-number">45</span> Shiny and dashboards</a></li>
<li><a class="" href="collaboration-with-github.html"><span class="header-section-number">46</span> Collaboration with Github</a></li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">47</span> Writing functions</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">48</span> R on network drives</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="univariate-and-multivariate-regression" class="section level1" number="18">
<h1>
<span class="header-section-number">18</span> Univariate and multivariate regression<a class="anchor" aria-label="anchor" href="#univariate-and-multivariate-regression"><i class="fas fa-link"></i></a>
</h1>
<!-- ======================================================= -->
<div id="overview-5" class="section level2" number="18.1">
<h2>
<span class="header-section-number">18.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview-5"><i class="fas fa-link"></i></a>
</h2>
<p>This page demonstrates the use of <strong>base</strong> R regression function such as <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> and the <strong>gtsummary</strong> package to
look at associations between variables (e.g. odds ratios, risk ratios and hazard
ratios). It also uses functions like <code>tidy()</code> from the <strong>broom</strong> package to clean-up regression outputs.</p>
<ol style="list-style-type: decimal">
<li>Univariate: two-by-two tables</li>
<li>Stratified: mantel-haenszel estimates</li>
<li>Multivariable: variable selection, model selection, final table</li>
<li>Forest plots</li>
</ol>
<!-- ======================================================= -->
</div>
<div id="preparation-9" class="section level2" number="18.2">
<h2>
<span class="header-section-number">18.2</span> Preparation<a class="anchor" aria-label="anchor" href="#preparation-9"><i class="fas fa-link"></i></a>
</h2>
<div id="load-packages-10" class="section level3 unnumbered">
<h3>Load packages<a class="anchor" aria-label="anchor" href="#load-packages-10"><i class="fas fa-link"></i></a>
</h3>
<p>This code chunk shows the loading of packages required for the analyses. In this handbook we emphasize <code>p_load()</code> from <strong>pacman</strong>, which installs the package if necessary and loads it for use. You can also load packages with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> from <strong>base</strong> R. See the page on <a href="r-basics.html#r-basics">R basics</a> for more information on R packages.</p>
<div class="sourceCode" id="cb790"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span>
  <span class="va">rio</span>,          <span class="co"># File import</span>
  <span class="va">here</span>,         <span class="co"># File locator</span>
  <span class="va">tidyverse</span>,    <span class="co"># data management + ggplot2 graphics, </span>
  <span class="va">stringr</span>,      <span class="co"># manipulate text strings </span>
  <span class="va">purrr</span>,        <span class="co"># loop over objects in a tidy way</span>
  <span class="va">gtsummary</span>,    <span class="co"># summary statistics and tests </span>
  <span class="va">broom</span>,        <span class="co"># tidy up results from regressions</span>
  <span class="va">lmtest</span>,       <span class="co"># likelihood-ratio tests</span>
  <span class="va">parameters</span>,   <span class="co"># alternative to tidy up results from regressions</span>
  <span class="va">see</span>          <span class="co"># alternative to visualise forest plots</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="import-data-9" class="section level3 unnumbered">
<h3>Import data<a class="anchor" aria-label="anchor" href="#import-data-9"><i class="fas fa-link"></i></a>
</h3>
<p>We import the dataset of cases from a simulated Ebola epidemic. If you want to download the data to follow step-by-step, see instructions in the <a href="datasets-used.html#datasets-used">Datasets used</a> page. The dataset is imported using the <code>import()</code> function from the <strong>rio</strong> package. See the page on <a href="import-and-export.html#import-and-export">Import and export</a> for various ways to import data.</p>
<div class="sourceCode" id="cb791"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># import the linelist</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="st">"linelist_cleaned.xlsx"</span><span class="op">)</span></code></pre></div>
<p>The first 50 rows of the linelist are displayed below.</p>
<div id="htmlwidget-b9be07621bc32693d973" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b9be07621bc32693d973">{"x":{"filter":"none","data":[["a3c8b8","d8a13d","5fe599","8689b7","11f8ea","893f25","be99c8","d0523a","ce9c02","275cc7","07e3e8","8a4580","2b8773","057e7a","be502d","4cff96","bab455","a6c614","c15f36","2eaa9a","2ebf95","c36eb4","02d8fd","af9f9a","88eff2","f50e8a","bc648d","567136","b799eb","67184b","170473","42e1a9","64c8ef","8ebf6e","e56412","0b46a0","188619","62a2ef","da8ecb","148f18","a9feb3","92ab68","58b968","f81362","6670a5","92ddf7","386dfb","3ad520","ae50c8","2ed605"],[4,4,4,4,2,3,3,7,5,5,4,4,5,7,5,6,5,5,5,5,6,8,9,6,5,10,9,6,5,6,7,12,6,7,9,9,7,9,5,6,6,8,10,8,9,9,9,7,9,9],["2014-05-07","2014-05-06","2014-05-08",null,null,"2014-05-18","2014-05-03","2014-05-20","2014-05-27","2014-05-24","2014-05-22",null,"2014-05-31","2014-06-04","2014-06-09","2014-06-05",null,"2014-06-05",null,"2014-06-07",null,"2014-06-15","2014-06-14",null,null,null,null,null,"2014-06-27",null,"2014-07-05",null,null,"2014-07-02","2014-07-12","2014-07-12","2014-07-05","2014-07-02","2014-06-20",null,"2014-06-29",null,"2014-07-18",null,"2014-07-18","2014-07-19","2014-07-19","2014-07-12","2014-07-20","2014-07-27"],["2014-05-08","2014-05-08","2014-05-13","2014-05-13","2014-05-16","2014-05-21","2014-05-22","2014-05-24","2014-05-27","2014-05-27","2014-05-27","2014-06-02","2014-06-06","2014-06-14","2014-06-15","2014-06-15","2014-06-15","2014-06-16","2014-06-17","2014-06-17","2014-06-19","2014-06-20","2014-06-20","2014-06-20","2014-06-20","2014-06-22","2014-06-30","2014-07-02","2014-07-03","2014-07-04","2014-07-09","2014-07-12","2014-07-14","2014-07-14","2014-07-15","2014-07-16","2014-07-17","2014-07-17","2014-07-18","2014-07-19","2014-07-19","2014-07-19","2014-07-20","2014-07-20","2014-07-20","2014-07-23","2014-07-23","2014-07-24","2014-07-25","2014-07-28"],["2014-05-10","2014-05-10","2014-05-15","2014-05-14","2014-05-18","2014-05-22","2014-05-23","2014-05-26","2014-05-29","2014-05-28","2014-05-29","2014-06-02","2014-06-07","2014-06-15","2014-06-16","2014-06-16","2014-06-16","2014-06-18","2014-06-19","2014-06-17","2014-06-21","2014-06-21","2014-06-20","2014-06-20","2014-06-21","2014-06-23","2014-07-02","2014-07-03","2014-07-05","2014-07-06","2014-07-10","2014-07-14","2014-07-15","2014-07-14","2014-07-17","2014-07-16","2014-07-19","2014-07-19","2014-07-20","2014-07-20","2014-07-21","2014-07-20","2014-07-21","2014-07-21","2014-07-22","2014-07-25","2014-07-23","2014-07-24","2014-07-27","2014-07-30"],["2014-05-14",null,null,"2014-05-18","2014-05-30","2014-05-29","2014-05-24","2014-06-05","2014-06-17","2014-06-07","2014-06-01",null,"2014-06-16",null,"2014-06-19","2014-06-25","2014-06-18","2014-06-26","2014-06-28",null,"2014-06-23","2014-06-24","2014-07-01","2014-07-13","2014-06-24","2014-07-01","2014-07-14","2014-07-07","2014-07-12","2014-07-09","2014-08-09","2014-07-20","2014-07-25","2014-07-27","2014-07-19","2014-08-11","2014-07-24","2014-07-23","2014-08-01","2014-07-23","2014-08-03","2014-08-05","2014-07-28","2014-08-07","2014-08-01",null,null,null,"2014-08-08","2014-08-09"],["Recover",null,null,"Recover","Recover","Recover","Recover",null,"Death","Death","Recover","Death",null,"Recover","Death",null,"Death","Recover","Recover","Recover","Death","Death","Death",null,"Death",null,"Recover",null,"Recover","Death","Recover","Death","Recover","Recover","Death","Recover","Death","Death",null,"Death","Death",null,null,"Death","Death","Recover","Recover",null,"Death",null],["m","f","m","f","m","m","f","f","m","f","f","m","f","f","m","m","f","f","f","f","m","m","m","f","f","f","m","m","m","m","f","f","m","f","f","f","m","f","m","f","f","f","m","m","f","m","f","f","f","f"],[1,4,21,2,27,25,18,2,20,4,22,7,7,18,33,34,12,31,0,3,3,51,51,9,15,8,35,37,34,15,35,9,30,9,23,13,25,14,39,1,14,12,14,28,13,6,42,10,6,10],["years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years","years"],[1,4,21,2,27,25,18,2,20,4,22,7,7,18,33,34,12,31,0,3,3,51,51,9,15,8,35,37,34,15,35,9,30,9,23,13,25,14,39,1,14,12,14,28,13,6,42,10,6,10],["0-4","0-4","20-29","0-4","20-29","20-29","15-19","0-4","20-29","0-4","20-29","5-9","5-9","15-19","30-49","30-49","10-14","30-49","0-4","0-4","0-4","50-69","50-69","5-9","15-19","5-9","30-49","30-49","30-49","15-19","30-49","5-9","30-49","5-9","20-29","10-14","20-29","10-14","30-49","0-4","10-14","10-14","10-14","20-29","10-14","5-9","30-49","10-14","5-9","10-14"],["0-4","0-4","20-24","0-4","25-29","25-29","15-19","0-4","20-24","0-4","20-24","5-9","5-9","15-19","30-34","30-34","10-14","30-34","0-4","0-4","0-4","50-54","50-54","5-9","15-19","5-9","35-39","35-39","30-34","15-19","35-39","5-9","30-34","5-9","20-24","10-14","25-29","10-14","35-39","0-4","10-14","10-14","10-14","25-29","10-14","5-9","40-44","10-14","5-9","10-14"],["Port Hospital","St. Mark's Maternity Hospital (SMMH)","Other","Missing","St. Mark's Maternity Hospital (SMMH)","Military Hospital","Port Hospital","Missing","Port Hospital","Central Hospital","Missing","Military Hospital","Missing","Missing","Military Hospital","Port Hospital","Port Hospital","Other","Missing","Missing","Port Hospital","Port Hospital","Port Hospital","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital","Port Hospital","Port Hospital","Missing","Other","Military Hospital","Military Hospital","Central Hospital","Military Hospital","Central Hospital","Missing","Military Hospital","Central Hospital","Missing","Missing","St. Mark's Maternity Hospital (SMMH)","Military Hospital","Port Hospital","Other","Military Hospital","Missing","Military Hospital","Missing","Port Hospital","Military Hospital"],[-13.2231931914572,-13.2354719577436,-13.2157351064963,-13.2152339775486,-13.212910703914,-13.2228638912441,-13.222625321098,-13.2565628977111,-13.2243703238737,-13.2369393782451,-13.2331547837254,-13.2222002700958,-13.2149474159902,-13.2180326141688,-13.2535215623253,-13.217651519706,-13.2372027220014,-13.2190654487695,-13.2189533374241,-13.209391925612,-13.2265780018024,-13.2619688324425,-13.2124311244169,-13.2371313571269,-13.2195578885261,-13.2336087079551,-13.2130045468176,-13.2160657166043,-13.2162953240809,-13.2355883289789,-13.247814368147,-13.2142410663192,-13.2614705796373,-13.2630592726116,-13.2343341712241,-13.2087039682346,-13.2581175859281,-13.2379376608352,-13.218781651651,-13.2483677722899,-13.2155668757305,-13.2333516655879,-13.238964614443,-13.2163318124535,-13.2217866965605,-13.2221173306518,-13.2510797882678,-13.262635786914,-13.2472895700622,-13.2597714344876],[8.47325128269697,8.4627682729487,8.46897295100924,8.45171855856465,8.46481700596819,8.46082377490923,8.46183062600728,8.48379248016347,8.47024789713924,8.46916113869591,8.46272931462646,8.46388925014565,8.45192988292173,8.47155535608018,8.45884880725177,8.46236804334872,8.46956119136946,8.47737640975659,8.45136291368722,8.47570184950483,8.48676680560442,8.48475855218221,8.45344099552146,8.48777544809491,8.46210832824745,8.47804840685363,8.47135450705077,8.48802917129884,8.46395131808455,8.4728562695215,8.47038713612408,8.4641347894342,8.45750552360835,8.47493999153642,8.47832062438022,8.4763997148275,8.45535258467199,8.4697737543226,8.48438437371817,8.48466158574339,8.4627846208641,8.46517148129756,8.48776686246878,8.4630635336683,8.4623972994508,8.46420961833913,8.47178418137766,8.4632880274758,8.48450777619227,8.45925216791802],["2ae019","20b688","f547d6",null,null,"11f8ea","aec8ec","4b38b7","53da57","e02f66","893f25",null,"5387a2","cbbe78","a2086d","ba7326",null,"3ff1bc",null,"9f6884",null,"057e7a","e61cb9",null,null,null,null,null,"ea3740",null,"71577a",null,null,"567136","894024","894024","71577a","b0c500","eb2277",null,"af1c1f",null,"62a2ef",null,"67be4e","d15be5","f36522","312ecf","26c588","e26da6"],["other","other","other",null,null,"other","other","other","other","other","other",null,"other","funeral","other","other",null,"funeral",null,"other",null,"other","other",null,null,null,null,null,"other",null,"other",null,null,"other","funeral","funeral","other","other","funeral",null,"other",null,"other",null,"other","other","other","other","other","other"],[18,35,78,18,68,66,57,25,64,41,72,45,29,53,71,77,52,71,0,35,45,82,92,34,40,42,67,75,66,52,84,39,66,52,55,60,67,59,75,28,61,55,77,68,51,44,88,46,33,53],[50,74,148,61,198,161,116,48,156,75,144,109,99,140,157,146,118,162,22,62,58,195,257,114,144,96,206,172,176,125,229,88,177,88,150,151,169,136,186,24,124,147,163,167,152,89,188,112,72,139],[22,21,22,23,21,21,22,20,22,23,22,20,22,22,21,22,22,23,23,21,23,20,22,22,22,22,22,22,22,22,23,23,23,22,23,23,20,22,21,22,23,23,23,20,21,21,22,21,22,23],[null,"no","no",null,null,"no",null,"no","no","no","no","no","no","no",null,null,null,"no","no",null,"no","no","no","no","no",null,"no",null,null,"no",null,null,"no",null,"no","no","no","no","no","no","no","no","no","no","no","no",null,"no","no","no"],[null,"no","yes",null,null,"no",null,"yes","no","no","no","no","yes","yes",null,null,null,"no","no",null,"no","no","no","no","no",null,"no",null,null,"no",null,null,"yes",null,"no","no","no","yes","no","no","no","yes","yes","yes","no","no",null,"no","no","yes"],[null,"yes","yes",null,null,"yes",null,"no","yes","yes","yes","no","yes","yes",null,null,null,"yes","yes",null,"yes","no","yes","yes","yes",null,"yes",null,null,"yes",null,null,"yes",null,"no","yes","yes","yes","yes","no","yes","yes","no","yes","yes","yes",null,"yes","yes","yes"],[null,"no","yes",null,null,"no",null,"no","no","no","no","no","no","no",null,null,null,"no","no",null,"no","no","no","no","no",null,"no",null,null,"no",null,null,"no",null,"no","no","no","no","no","no","no","no","yes","no","no","yes",null,"no","no","no"],[null,"yes","yes",null,null,"yes",null,"yes","yes","no","yes","no","yes","yes",null,null,null,"no","yes",null,"no","yes","yes","no","yes",null,"yes",null,null,"yes",null,null,"no",null,"yes","yes","no","no","no","no","yes","yes","no","yes","no","no",null,"no","yes","no"],[37.3,37.4,37,36,36.7,37.3,36.8,37,36.4,37.2,37.3,36.9,37,36.9,37.3,37.1,36.7,36.6,37.7,37.6,36.8,36.9,36.6,37.7,37,36.4,36.4,37.4,36.3,37,37.5,37.8,36.8,37.5,37.4,36.5,37.2,36.6,37.3,36.3,37.2,36.9,36.4,36.4,36.2,37,37.2,37.3,36.4,37.5],["20:35","14:16","09:17","11:32","18:52","16:51",null,"14:29","11:57","09:21","13:08","23:20","17:29",null,"18:39",null,"14:16",null,"08:00","11:43","11:10","15:10","11:53","19:11",null,"14:26","04:17","17:32",null,null,"12:28",null,"10:12","10:39","16:46","19:50","16:06","13:52","11:28","07:40","12:60","15:24","06:27","06:17","09:36","14:01","17:06","12:57","13:07",null],[72,63.9152666179693,35.6099342585829,48.3740929857565,17.3451688603204,25.4619806334632,42.3602853745541,108.506944444444,26.2984878369494,72.8888888888889,34.7222222222222,37.8755996969952,29.5888174676053,27.0408163265306,28.8044139721693,36.1231000187652,37.3455903476013,27.0538027739674,0,91.05098855359,133.769322235434,21.5647600262985,13.9290526730155,26.1618959679902,19.2901234567901,45.5729166666667,15.7884814779904,25.3515413737155,21.3068181818182,33.28,16.018001182281,50.3615702479339,21.0667432730058,67.1487603305785,24.4444444444444,26.3146353230121,23.458562375267,31.8987889273356,21.6788067984738,486.111111111111,39.6722164412071,25.4523578138738,28.9811434378411,24.3823729785937,22.0740997229917,55.5485418507764,24.8981439565414,36.6709183673469,63.6574074074074,27.431292376171],[2,2,2,1,2,1,1,2,2,1,2,0,1,1,1,1,1,2,2,0,2,1,0,0,1,1,2,1,2,2,1,2,1,0,2,0,2,2,2,1,2,1,1,1,2,2,0,0,2,2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,8,10,14,15,18,19,20,26,28,29]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="clean-data" class="section level3 unnumbered">
<h3>Clean data<a class="anchor" aria-label="anchor" href="#clean-data"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Store the explanatory variables</strong></p>
<div class="sourceCode" id="cb792"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## define variables of interest </span>
<span class="va">explanatory_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"fever"</span>, <span class="st">"chills"</span>, <span class="st">"cough"</span>, <span class="st">"aches"</span>, <span class="st">"vomit"</span><span class="op">)</span></code></pre></div>
<p><strong>Convert to 1’s and 0’s</strong></p>
<p>Below we convert the explanatory columns from “yes”/“no” “m”/“f”, and “dead”/“alive” to <strong>1 / 0</strong>, to cooperate with the expectations of logistic regression models. To do this efficiently, we define a vector of the column names of our explanatory variables.</p>
<p>We apply the function <code>case_when()</code> to convert specified values to 1’s and 0’s. This function is applied all the <code>explanatory_vars</code> columns using <code>across()</code> (see page on <a href="grouping-data.html#grouping-data">Grouping data</a>).</p>
<div class="sourceCode" id="cb793"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## convert dichotomous variables to 0/1 </span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    <span class="co">## for each of the variables listed and "outcome"</span>
    <span class="fu">across</span><span class="op">(</span>
      <span class="fu">all_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">explanatory_vars</span>, <span class="st">"outcome"</span><span class="op">)</span><span class="op">)</span>, 
      <span class="co">## recode male, yes and death to 1; female, no and recover to 0</span>
      <span class="co">## otherwise set to missing</span>
           <span class="op">~</span><span class="fu">case_when</span><span class="op">(</span>
             <span class="va">.</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"yes"</span>, <span class="st">"Death"</span><span class="op">)</span>   <span class="op">~</span> <span class="fl">1</span>,
             <span class="va">.</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"no"</span>,  <span class="st">"Recover"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">0</span>, 
             <span class="cn">TRUE</span>                            <span class="op">~</span> <span class="cn">NA_real_</span>
           <span class="op">)</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><strong>Drop rows with missing values</strong></p>
<p>To drop rows with missing values, we add the column <code>age</code> to the <code>explanatory_vars</code> (<code>age</code> would have produced an error in the previous <code>case_when()</code> operation). Then we pipe the <code>linelist</code> to <code>drop_na()</code> to remove any rows with missing values in the <code>outcome</code> column or any of the <code>explanatory_vars</code> columns.</p>
<div class="sourceCode" id="cb794"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## add in age_category to the explanatory vars </span>
<span class="va">explanatory_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">explanatory_vars</span>, <span class="st">"age_cat"</span><span class="op">)</span>

<span class="co">## drop rows with missing information for variables of interest </span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">drop_na</span><span class="op">(</span><span class="fu">any_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"outcome"</span>, <span class="va">explanatory_vars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The number of rows remaining in <code>linelist</code> is 4166.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="univariate" class="section level2" number="18.3">
<h2>
<span class="header-section-number">18.3</span> Univariate<a class="anchor" aria-label="anchor" href="#univariate"><i class="fas fa-link"></i></a>
</h2>
<p>Just like in the page on <a href="time-series-and-outbreak-detection.html#descriptive-analysis-2">Descriptive analysis</a>, your use case will determine which R package you use. We present two options for doing univariate analysis:</p>
<ul>
<li>Use functions available in <strong>base</strong> to quickly print results to the console. Use the <strong>broom</strong> package to tidy up the outputs.<br>
</li>
<li>Use the <strong>gtsummary</strong> package to model and get publication-ready outputs</li>
</ul>
<!-- ======================================================= --><div id="base-r-2" class="section level3 unnumbered">
<h3>
<strong>base</strong> R<a class="anchor" aria-label="anchor" href="#base-r-2"><i class="fas fa-link"></i></a>
</h3>
<p>The function <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> from the <strong>stats</strong> package (part of <strong>base</strong> R) is used to fit Generalized Linear Models (GLM).</p>
<p><code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> can be used for univariate and multivariate logistic regression (e.g. to get Odds Ratios). Here are the core parts:</p>
<div class="sourceCode" id="cb795"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># arguments for glm()</span>
<span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">family</span>, <span class="va">data</span>, <span class="va">weights</span>, <span class="va">subset</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
<ul>
<li>
<code>formula =</code> The model is provided to <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> as an equation, with the outcome on the left and explanatory variables on the right of a tilde <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code>. In this example we are assessing the association between different age categories and the outcome of death (now coded as 1, see Preparation section).<br>
</li>
<li>
<code>family =</code> This determines the type of model to run. For logistic regression, use <code>family = "binomial"</code>, for poisson use <code>family = "poisson"</code>. Other examples are in the table below.<br>
</li>
<li>
<code>data =</code> Specify your data frame</li>
</ul>
<p>If necessary, you can also specify the link function via the syntax <code>family = familytype(link = "linkfunction"))</code>. You can read more in the documentation about other families and optional arguments such as <code>weights =</code> and <code>subset =</code> (<code><a href="https://rdrr.io/r/stats/glm.html">?glm</a></code>).</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Family</th>
<th>Default link function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"binomial"</code></td>
<td><code>(link = "logit")</code></td>
</tr>
<tr class="even">
<td><code>"gaussian"</code></td>
<td><code>(link = "identity")</code></td>
</tr>
<tr class="odd">
<td><code>"Gamma"</code></td>
<td><code>(link = "inverse")</code></td>
</tr>
<tr class="even">
<td><code>"inverse.gaussian"</code></td>
<td><code>(link = "1/mu^2")</code></td>
</tr>
<tr class="odd">
<td><code>"poisson"</code></td>
<td><code>(link = "log")</code></td>
</tr>
<tr class="even">
<td><code>"quasi"</code></td>
<td><code>(link = "identity", variance = "constant")</code></td>
</tr>
<tr class="odd">
<td><code>"quasibinomial"</code></td>
<td><code>(link = "logit")</code></td>
</tr>
<tr class="even">
<td><code>"quasipoisson"</code></td>
<td><code>(link = "log")</code></td>
</tr>
</tbody>
</table></div>
<p>When running <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> it is most common to save the results as a named R object. Then you can print the results to your console using <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> as shown below, or perform other operations on the results (e.g. exponentiate).</p>
<div id="univariate-glm" class="section level4 unnumbered">
<h4>Univariate <code>glm()</code><a class="anchor" aria-label="anchor" href="#univariate-glm"><i class="fas fa-link"></i></a>
</h4>
<p>Below is a univariate model of <code>outcome</code> by age category. We save the model output as <code>model</code> and then print it within <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> to the console. Note the Estimates provided are the <em>log odds</em>. The baseline level is the first factor level of <code>age_cat</code> (0-4).</p>
<div class="sourceCode" id="cb796"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">age_cat</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = outcome ~ age_cat, family = "binomial", data = linelist)
## 
## Deviance Residuals: 
##              Min                1Q            Median                3Q               Max  
## -1.3905703945051  -1.2701673184884   0.9870317033277   1.0873950463246   1.1774100225155  
## 
## Coefficients:
##                       Estimate        Std. Error  z value     Pr(&gt;|z|)    
## (Intercept)   0.35048297369081  0.07252815161421  4.83237 0.0000013492 ***
## age_cat5-9    0.11534528414444  0.10337173771809  1.11583     0.264495    
## age_cat10-14 -0.13503445859841  0.10748786953665 -1.25628     0.209016    
## age_cat15-19 -0.12007839813956  0.11191224175662 -1.07297     0.283285    
## age_cat20-29 -0.17044713217772  0.10143169289383 -1.68041     0.092877 .  
## age_cat30-49 -0.15757930756632  0.11412459794028 -1.38077     0.167351    
## age_cat50-69  0.13786979422313  0.25499929430514  0.54067     0.588737    
## age_cat70+   -0.35048297369080  0.63660060695586 -0.55055     0.581939    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 5692.6000855303  on 4165  degrees of freedom
## Residual deviance: 5680.3295910511  on 4158  degrees of freedom
## AIC: 5696.3295910511
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>To alter the baseline level of a given variable, ensure the column is class Factor and set the first level (see page on <a href="factors.html#factors">Factors</a>. For example below we take <code>linelist</code> column <code>age_cat</code> and set “20-29” as the baseline before piping the modified dataset into <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>.</p>
<div class="sourceCode" id="cb798"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>age_cat <span class="op">=</span> <span class="fu">fct_relevel</span><span class="op">(</span><span class="va">age_cat</span>, <span class="st">"20-29"</span>, after <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">outcome</span> <span class="op">~</span> <span class="va">age_cat</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = outcome ~ age_cat, family = "binomial", data = .)
## 
## Deviance Residuals: 
##              Min                1Q            Median                3Q               Max  
## -1.3905703945051  -1.2701673184884   0.9870317033276   1.0873950463246   1.1774100225155  
## 
## Coefficients:
##                       Estimate        Std. Error  z value  Pr(&gt;|z|)   
## (Intercept)   0.18003584151310  0.07090878328341  2.53898 0.0111177 * 
## age_cat0-4    0.17044713217770  0.10143169289382  1.68041 0.0928770 . 
## age_cat5-9    0.28579241632215  0.10224206046934  2.79525 0.0051859 **
## age_cat10-14  0.03541267357931  0.10640190255670  0.33282 0.7392702   
## age_cat15-19  0.05036873403815  0.11086961993779  0.45431 0.6496086   
## age_cat30-49  0.01286782461139  0.11310237232344  0.11377 0.9094189   
## age_cat50-69  0.30831692640084  0.25454344003780  1.21125 0.2257978   
## age_cat70+   -0.18003584151317  0.63641814520542 -0.28289 0.7772617   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 5692.6000855303  on 4165  degrees of freedom
## Residual deviance: 5680.3295910511  on 4158  degrees of freedom
## AIC: 5696.3295910511
## 
## Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div id="printing-results" class="section level4 unnumbered">
<h4>Printing results<a class="anchor" aria-label="anchor" href="#printing-results"><i class="fas fa-link"></i></a>
</h4>
<p>For most uses, several modifications must be made to the above outputs. The function <code>tidy()</code> from the package <strong>broom</strong> is very convenient for making the model results presentable. Here we demonstrate how to combine model outputs with a table of counts.</p>
<ol style="list-style-type: decimal">
<li>Get the <em>exponentiated</em> log odds ratio estimates and confidence intervals by passing the model to <code>tidy()</code> and setting <code>exponentiate = TRUE</code> and <code>conf.int = TRUE</code>.</li>
</ol>
<div class="sourceCode" id="cb800"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">age_cat</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># clean up the outputs of the regression (exponentiate and produce CIs)</span>
  <span class="fu">tidy</span><span class="op">(</span>exponentiate <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># round all numeric columns</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Below is the outputted tibble <code>model</code>:</p>
<div id="htmlwidget-3ddf91605c40bcf2b873" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3ddf91605c40bcf2b873">{"x":{"filter":"none","data":[["(Intercept)","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[1.42,1.12,0.87,0.89,0.84,0.85,1.15,0.7],[0.07,0.1,0.11,0.11,0.1,0.11,0.25,0.64],[4.83,1.12,-1.26,-1.07,-1.68,-1.38,0.54,-0.55],[0,0.26,0.21,0.28,0.09,0.17,0.59,0.58],[1.23,0.92,0.71,0.71,0.69,0.68,0.7,0.19],[1.64,1.37,1.08,1.1,1.03,1.07,1.91,2.55]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><ol start="2" style="list-style-type: decimal">
<li>Combine these model results with a table of counts. Below, we create the counts table by applying <strong>dplyr</strong> functions on the <code>linelist</code> (see page on <a href="grouping-data.html#grouping-data">Grouping data</a>).</li>
</ol>
<ul>
<li>Group rows by outcome, and get counts by age category<br>
</li>
<li>Pivot wider so the column are <code>age_cat</code>, <code>0</code>, and <code>1</code><br>
</li>
<li>Remove row for <code>NA</code> <code>age_cat</code>, if applicable, to align with the model results</li>
</ul>
<div class="sourceCode" id="cb801"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts_table</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="co">## remove cases with missing outcome or age category</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">age_cat</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## get counts of variable of interest grouped by outcome</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## gets number or rows by unique outcome-age category combinations  </span>
  <span class="fu">count</span><span class="op">(</span><span class="va">age_cat</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## spread data to wide format (as in cross-tabulation)</span>
  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">outcome</span>, values_from <span class="op">=</span> <span class="va">n</span><span class="op">)</span> </code></pre></div>
<p>Here is what this <code>counts_table</code> data frame looks like:</p>
<div id="htmlwidget-9e9de8d8a9dbc4d8127c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9e9de8d8a9dbc4d8127c">{"x":{"filter":"none","data":[["0-4","5-9","10-14","15-19","20-29","30-49","50-69","70+"],[324,300,287,247,365,235,27,5],[460,478,356,311,437,285,44,5]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>age_cat<\/th>\n      <th>0<\/th>\n      <th>1<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>Now we can bind the <code>counts_table</code> and the <code>model</code> results together horizontally with <code>bind_cols()</code> (<strong>dplyr</strong>). In this code, the <code>.</code> represents the piped object <code>counts_table</code> and we bind it to <code>model</code>. To finish the process, we use <code>select()</code> to pick the desired columns and their order, and apply the <strong>base</strong> R <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code> function to all numeric columns specifying 2 decimal places.</p>
<div class="sourceCode" id="cb802"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">combined</span> <span class="op">&lt;-</span> <span class="va">counts_table</span> <span class="op">%&gt;%</span> 
  <span class="co">## merge with the outputs of the regression </span>
  <span class="fu">bind_cols</span><span class="op">(</span><span class="va">.</span>, <span class="va">model</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## only keep columns interested in </span>
  <span class="fu">select</span><span class="op">(</span><span class="va">term</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="va">estimate</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span>, <span class="va">p.value</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## round values to 2 decimal places</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Here is what the combined data frame looks like:</p>
<div id="htmlwidget-b84fbce808ffa327a995" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b84fbce808ffa327a995">{"x":{"filter":"none","data":[["(Intercept)","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[324,300,287,247,365,235,27,5],[460,478,356,311,437,285,44,5],[1.42,1.12,0.87,0.89,0.84,0.85,1.15,0.7],[1.23,0.92,0.71,0.71,0.69,0.68,0.7,0.19],[1.64,1.37,1.08,1.1,1.03,1.07,1.91,2.55],[0,0.26,0.21,0.28,0.09,0.17,0.59,0.58]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>0<\/th>\n      <th>1<\/th>\n      <th>estimate<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n      <th>p.value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="looping-multiple-univariate-models" class="section level4 unnumbered">
<h4>Looping multiple univariate models<a class="anchor" aria-label="anchor" href="#looping-multiple-univariate-models"><i class="fas fa-link"></i></a>
</h4>
<p>Below we present a method using <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> and <code>tidy()</code> for a more simple approach, see the section on <strong>gtsummary</strong>.</p>
<p>To run the models on several exposure variables to produce univariate odds ratios (i.e. 
not controlling for each other), you can use the approach below. It uses <code>str_c()</code> from <strong>stringr</strong> to create univariate formulas,, runs the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> regression on each formula, passes each <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> output to <code>tidy()</code> and finally collapses all the model outputs together with <code>bind_rows()</code> from <strong>tidyr</strong>*. This approach uses <code>map()</code> from the package <strong>purrr</strong> to iterate - see the page on <a href="iteration-and-loops.html#iteration-and-loops">Iteration and loops</a> for more information on this tool.</p>
<ol style="list-style-type: decimal">
<li><p>Create a vector of column names of the explanatory variables. We already have this as <code>explanatory_vars</code> from the data Preparation section of this page.</p></li>
<li><p>Use <code>str_c()</code> to create multiple string formulas, with <code>outcome</code> on the left, and a column name from <code>explanatory_vars</code> on the right. The period <code>.</code> substitutes for the column name in <code>explanatory_vars</code>.</p></li>
</ol>
<div class="sourceCode" id="cb803"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">explanatory_vars</span> <span class="op">%&gt;%</span> <span class="fu">str_c</span><span class="op">(</span><span class="st">"outcome ~ "</span>, <span class="va">.</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "outcome ~ gender"  "outcome ~ fever"   "outcome ~ chills"  "outcome ~ cough"   "outcome ~ aches"   "outcome ~ vomit"  
## [7] "outcome ~ age_cat"</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Pass these string formulas to <code>map()</code> and set <code>~glm()</code> as the function to apply to each input. Within <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>, set the regression formula as <code><a href="https://rdrr.io/r/stats/formula.html">as.formula(.x)</a></code> where <code>.x</code> will be replaced by the string formula defined in the step above. <code>map()</code> will loop over each of the string formulas, running regressions for each one.</p></li>
<li><p>The outputs of this first <code>map()</code> are passed to a second <code>map()</code> command, which applied <code>tidy()</code> to the regression outputs.</p></li>
<li><p>Finally the output of the second <code>map()</code> (a list of tidied data frames) is condensed with <code>bind_rows()</code>, resulting in one data frame with all the univariate results.</p></li>
</ol>
<div class="sourceCode" id="cb805"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">models</span> <span class="op">&lt;-</span> <span class="va">explanatory_vars</span> <span class="op">%&gt;%</span>       <span class="co"># begin with variables of interest</span>
  <span class="fu">str_c</span><span class="op">(</span><span class="st">"outcome ~ "</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>         <span class="co"># combine each variable into formula ("outcome ~ variable of interest")</span>
  
  <span class="co"># iterate through each univariate formula</span>
  <span class="fu">map</span><span class="op">(</span>                               
    .f <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>                       <span class="co"># pass the formulas one-by-one to glm()</span>
      formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>,      <span class="co"># within glm(), the string formula is .x</span>
      family <span class="op">=</span> <span class="st">"binomial"</span>,           <span class="co"># specify type of glm (logistic)</span>
      data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>          <span class="co"># dataset</span>
  
  <span class="co"># tidy up each of the glm regression outputs from above</span>
  <span class="fu">map</span><span class="op">(</span>
    .f <span class="op">=</span> <span class="op">~</span><span class="fu">tidy</span><span class="op">(</span>
      <span class="va">.x</span>, 
      exponentiate <span class="op">=</span> <span class="cn">TRUE</span>,           <span class="co"># exponentiate </span>
      conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>          <span class="co"># return confidence intervals</span>
  
  <span class="co"># collapse the list of regression outputs in to one data frame</span>
  <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  
  <span class="co"># round all numeric columns</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>This time, the end object <code>models</code> is longer because it now represents the combined results of several univariate regressions. Click through to see all the rows of <code>model</code>.</p>
<div id="htmlwidget-6c3fec42fc4cb666b7a0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6c3fec42fc4cb666b7a0">{"x":{"filter":"none","data":[["(Intercept)","gender","(Intercept)","fever","(Intercept)","chills","(Intercept)","cough","(Intercept)","aches","(Intercept)","vomit","(Intercept)","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[1.32,1,1.39,0.94,1.33,1,1.24,1.09,1.32,1.09,1.31,1.02,1.42,1.12,0.87,0.89,0.84,0.85,1.15,0.7],[0.04,0.06,0.07,0.08,0.03,0.08,0.08,0.09,0.03,0.1,0.04,0.06,0.07,0.1,0.11,0.11,0.1,0.11,0.25,0.64],[6.38,0.06,4.7,-0.73,8.12,-0.03,2.6,0.92,8.33,0.79,6.16,0.34,4.83,1.12,-1.26,-1.07,-1.68,-1.38,0.54,-0.55],[0,0.95,0,0.47,0,0.98,0.01,0.36,0,0.43,0,0.73,0,0.26,0.21,0.28,0.09,0.17,0.59,0.58],[1.22,0.89,1.21,0.81,1.24,0.86,1.05,0.91,1.23,0.89,1.2,0.9,1.23,0.92,0.71,0.71,0.69,0.68,0.7,0.19],[1.44,1.13,1.59,1.1,1.42,1.16,1.45,1.29,1.4,1.33,1.43,1.15,1.64,1.37,1.08,1.1,1.03,1.07,1.91,2.55]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>As before, we can create a counts table from the <code>linelist</code> for each explanatory variable, bind it to <code>models</code>, and make a nice table. We begin with the variables, and iterate through them with <code>map()</code>. We iterate through a user-defined function which involves creating a counts table with <strong>dplyr</strong> functions. Then the results are combined and bound with the <code>models</code> model results.</p>
<div class="sourceCode" id="cb806"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## for each explanatory variable</span>
<span class="va">univ_tab_base</span> <span class="op">&lt;-</span> <span class="va">explanatory_vars</span> <span class="op">%&gt;%</span> 
  <span class="fu">map</span><span class="op">(</span>.f <span class="op">=</span> 
    <span class="op">~</span><span class="op">{</span><span class="va">linelist</span> <span class="op">%&gt;%</span>                <span class="co">## begin with linelist</span>
        <span class="fu">group_by</span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span>     <span class="co">## group data set by outcome</span>
        <span class="fu">count</span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span>    <span class="co">## produce counts for variable of interest</span>
        <span class="fu">pivot_wider</span><span class="op">(</span>              <span class="co">## spread to wide format (as in cross-tabulation)</span>
          names_from <span class="op">=</span> <span class="va">outcome</span>,
          values_from <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span> 
        <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co">## drop rows with missings</span>
        <span class="fu">rename</span><span class="op">(</span><span class="st">"variable"</span> <span class="op">=</span> <span class="va">.x</span><span class="op">)</span> <span class="op">%&gt;%</span>      <span class="co">## change variable of interest column to "variable"</span>
        <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="co">## convert to character, else non-dichotomous (categorical) variables come out as factor and cant be merged</span>
      <span class="op">)</span> <span class="op">%&gt;%</span> 
  
  <span class="co">## collapse the list of count outputs in to one data frame</span>
  <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  
  <span class="co">## merge with the outputs of the regression </span>
  <span class="fu">bind_cols</span><span class="op">(</span><span class="va">.</span>, <span class="va">models</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  
  <span class="co">## only keep columns interested in </span>
  <span class="fu">select</span><span class="op">(</span><span class="va">term</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="va">estimate</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span>, <span class="va">p.value</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  
  <span class="co">## round decimal places</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Below is what the data frame looks like. See the page on <a href="tables.html#tables">Tables</a> for ideas on how to further convert this table to pretty HTML output (e.g. with <strong>flextable</strong>).</p>
<div id="htmlwidget-392326c211b6cd2829ec" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-392326c211b6cd2829ec">{"x":{"filter":"none","data":[["(Intercept)","gender","(Intercept)","fever","(Intercept)","chills","(Intercept)","cough","(Intercept)","aches","(Intercept)","vomit","(Intercept)","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[902,888,352,1438,1436,354,269,1521,1615,175,900,890,324,300,287,247,365,235,27,5],[1195,1181,489,1887,1907,469,333,2043,2126,250,1182,1194,460,478,356,311,437,285,44,5],[1.32,1,1.39,0.94,1.33,1,1.24,1.09,1.32,1.09,1.31,1.02,1.42,1.12,0.87,0.89,0.84,0.85,1.15,0.7],[1.22,0.89,1.21,0.81,1.24,0.86,1.05,0.91,1.23,0.89,1.2,0.9,1.23,0.92,0.71,0.71,0.69,0.68,0.7,0.19],[1.44,1.13,1.59,1.1,1.42,1.16,1.45,1.29,1.4,1.33,1.43,1.15,1.64,1.37,1.08,1.1,1.03,1.07,1.91,2.55],[0,0.95,0,0.47,0,0.98,0.01,0.36,0,0.43,0,0.73,0,0.26,0.21,0.28,0.09,0.17,0.59,0.58]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>0<\/th>\n      <th>1<\/th>\n      <th>estimate<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n      <th>p.value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
</div>
<div id="gtsummary-package-2" class="section level3 unnumbered">
<h3>
<strong>gtsummary</strong> package<a class="anchor" aria-label="anchor" href="#gtsummary-package-2"><i class="fas fa-link"></i></a>
</h3>
<p>Below we present the use of <code>tbl_uvregression()</code> from the <strong>gtsummary</strong> package. Just like in the page on <a href="time-series-and-outbreak-detection.html#descriptive-analysis-2">Descriptive analysis</a>, <strong>gtsummary</strong> functions do a good job of running statistics <em>and</em> producing professional-looking outputs. This function produces a table of univariate regression results.</p>
<p>We select only the necessary columns from the <code>linelist</code> (explanatory variables and the outcome variable) and pipe them into <code>tbl_uvregression()</code>. We are going to run univariate regression on each of the columns we defined as <code>explanatory_vars</code> in the data Preparation section (gender, fever, chills, cough, aches, vomit, and age_cat).</p>
<p>Within the function itself, we provide the <code>method =</code> as <code>glm</code> (no quotes), the <code>y =</code> outcome column (<code>outcome</code>), specify to <code>method.args =</code> that we want to run logistic regression via <code>family = binomial</code>, and we tell it to exponentiate the results.</p>
<p>The output is HTML and contains the counts</p>
<div class="sourceCode" id="cb807"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">univ_tab</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">explanatory_vars</span>, <span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">## select variables of interest</span>

  <span class="fu">tbl_uvregression</span><span class="op">(</span>                         <span class="co">## produce univariate table</span>
    method <span class="op">=</span> <span class="va">glm</span>,                           <span class="co">## define regression want to run (generalised linear model)</span>
    y <span class="op">=</span> <span class="va">outcome</span>,                            <span class="co">## define outcome variable</span>
    method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span>,  <span class="co">## define what type of glm want to run (logistic)</span>
    exponentiate <span class="op">=</span> <span class="cn">TRUE</span>                     <span class="co">## exponentiate to produce odds ratios (rather than log odds)</span>
  <span class="op">)</span>

<span class="co">## view univariate results table </span>
<span class="va">univ_tab</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pprjjigiyp .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pprjjigiyp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pprjjigiyp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pprjjigiyp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pprjjigiyp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pprjjigiyp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pprjjigiyp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pprjjigiyp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pprjjigiyp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pprjjigiyp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pprjjigiyp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pprjjigiyp .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pprjjigiyp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pprjjigiyp .gt_from_md > :first-child {
  margin-top: 0;
}

#pprjjigiyp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pprjjigiyp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pprjjigiyp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#pprjjigiyp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pprjjigiyp .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#pprjjigiyp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pprjjigiyp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pprjjigiyp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pprjjigiyp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pprjjigiyp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pprjjigiyp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#pprjjigiyp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pprjjigiyp .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#pprjjigiyp .gt_left {
  text-align: left;
}

#pprjjigiyp .gt_center {
  text-align: center;
}

#pprjjigiyp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pprjjigiyp .gt_font_normal {
  font-weight: normal;
}

#pprjjigiyp .gt_font_bold {
  font-weight: bold;
}

#pprjjigiyp .gt_font_italic {
  font-style: italic;
}

#pprjjigiyp .gt_super {
  font-size: 65%;
}

#pprjjigiyp .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="pprjjigiyp" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><div class="inline-table"><table class="gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>OR</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">gender</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.89, 1.13</td>
      <td class="gt_row gt_center">&gt;0.9</td>
    </tr>
<tr>
<td class="gt_row gt_left">fever</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">0.94</td>
      <td class="gt_row gt_center">0.8100000000000001, 1.10</td>
      <td class="gt_row gt_center">0.5</td>
    </tr>
<tr>
<td class="gt_row gt_left">chills</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.86, 1.16</td>
      <td class="gt_row gt_center">&gt;0.9</td>
    </tr>
<tr>
<td class="gt_row gt_left">cough</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.91, 1.29</td>
      <td class="gt_row gt_center">0.4</td>
    </tr>
<tr>
<td class="gt_row gt_left">aches</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.89, 1.33</td>
      <td class="gt_row gt_center">0.4</td>
    </tr>
<tr>
<td class="gt_row gt_left">vomit</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.02</td>
      <td class="gt_row gt_center">0.90, 1.15</td>
      <td class="gt_row gt_center">0.7</td>
    </tr>
<tr>
<td class="gt_row gt_left">age_cat</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">0-4</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center"></td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">5-9</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">1.12</td>
      <td class="gt_row gt_center">0.92, 1.37</td>
      <td class="gt_row gt_center">0.3</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">10-14</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
      <td class="gt_row gt_center">0.71, 1.08</td>
      <td class="gt_row gt_center">0.2</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">15-19</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.89</td>
      <td class="gt_row gt_center">0.71, 1.10</td>
      <td class="gt_row gt_center">0.3</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">20-29</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.84</td>
      <td class="gt_row gt_center">0.69, 1.03</td>
      <td class="gt_row gt_center">0.093</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">30-49</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.85</td>
      <td class="gt_row gt_center">0.6800000000000000, 1.07</td>
      <td class="gt_row gt_center">0.2</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">50-69</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">1.15</td>
      <td class="gt_row gt_center">0.70, 1.91</td>
      <td class="gt_row gt_center">0.6</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">70+</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.70</td>
      <td class="gt_row gt_center">0.19, 2.55</td>
      <td class="gt_row gt_center">0.6</td>
    </tr>
</tbody>
<tfoot><tr class="gt_footnotes">
<td colspan="5">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks"><em>1</em>
          </sup>
           
          OR = Odds Ratio, CI = Confidence Interval
          <br></p>
      </td>
    </tr></tfoot>
</table></div></div>
<p>There are many modifications you can make to this table output, such as adjusting the text labels, bolding rows by their p-value, etc. See tutorials <a href="http://www.danieldsjoberg.com/gtsummary/articles/tbl_regression.html">here</a> and elsewhere online.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="stratified" class="section level2" number="18.4">
<h2>
<span class="header-section-number">18.4</span> Stratified<a class="anchor" aria-label="anchor" href="#stratified"><i class="fas fa-link"></i></a>
</h2>
<p>Stratified analysis is currently still being worked on for <strong>gtsummary</strong>,
this page will be updated in due course.</p>
<!-- ======================================================= -->
<div id="gtsummary-package-3" class="section level3 unnumbered">
<h3>
<strong>gtsummary</strong> package<a class="anchor" aria-label="anchor" href="#gtsummary-package-3"><i class="fas fa-link"></i></a>
</h3>
<p>TODO</p>
<!-- ======================================================= -->
</div>
<div id="base-r-3" class="section level3 unnumbered">
<h3>
<strong>base</strong> R<a class="anchor" aria-label="anchor" href="#base-r-3"><i class="fas fa-link"></i></a>
</h3>
<p>TODO</p>
<!-- ======================================================= -->
</div>
</div>
<div id="multivariate" class="section level2" number="18.5">
<h2>
<span class="header-section-number">18.5</span> Multivariate<a class="anchor" aria-label="anchor" href="#multivariate"><i class="fas fa-link"></i></a>
</h2>
<p>For multivariate analysis, we again present two approaches:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> and <code>tidy()</code><br>
</li>
<li>
<strong>gtsummary</strong> package</li>
</ul>
<p>The workflow is similar for each, as shown below, and only the last step of pulling a final table together is different.</p>
<div id="conduct-multivariate" class="section level3 unnumbered">
<h3>Conduct multivariate<a class="anchor" aria-label="anchor" href="#conduct-multivariate"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> but add more variables to the right side of the equation, separated by plus symbols (<code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>).</p>
<p>To run the model with all of our explanatory variables we would run:</p>
<div class="sourceCode" id="cb808"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mv_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">fever</span> <span class="op">+</span> <span class="va">chills</span> <span class="op">+</span> <span class="va">cough</span> <span class="op">+</span> <span class="va">aches</span> <span class="op">+</span> <span class="va">vomit</span> <span class="op">+</span> <span class="va">age_cat</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mv_reg</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = outcome ~ gender + fever + chills + cough + aches + 
##     vomit + age_cat, family = "binomial", data = linelist)
## 
## Deviance Residuals: 
##              Min                1Q            Median                3Q               Max  
## -1.4579622097102  -1.2683553246862   0.9916736000624   1.0782510223063   1.1848257235044  
## 
## Coefficients:
##                          Estimate           Std. Error  z value Pr(&gt;|z|)  
## (Intercept)   0.28493722176843700  0.13065096175228633  2.18090 0.029191 *
## gender        0.03742865638450952  0.06558747299793158  0.57067 0.568225  
## fever        -0.05370896183541740  0.07840929132410068 -0.68498 0.493355  
## chills        0.00006619053917735  0.07879146891286493  0.00084 0.999330  
## cough         0.08773254239123822  0.08889980651346900  0.98687 0.323706  
## aches         0.09387777261175211  0.10428569682170367  0.90020 0.368015  
## vomit         0.01519181379066035  0.06282746366096337  0.24180 0.808933  
## age_cat5-9    0.11980912558061459  0.10346741941768253  1.15794 0.246888  
## age_cat10-14 -0.13387795202515468  0.10758368423834101 -1.24441 0.213350  
## age_cat15-19 -0.12292817172644459  0.11224527096290894 -1.09517 0.273440  
## age_cat20-29 -0.17504784480124599  0.10222185048564314 -1.71243 0.086817 .
## age_cat30-49 -0.16993218070234825  0.11698354183297995 -1.45262 0.146330  
## age_cat50-69  0.11501080170873494  0.25780946526901688  0.44611 0.655519  
## age_cat70+   -0.37383104142866802  0.63815559776078368 -0.58580 0.558010  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 5692.6000855303  on 4165  degrees of freedom
## Residual deviance: 5677.7607156867  on 4152  degrees of freedom
## AIC: 5705.7607156867
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>If you want to include two variables and an interaction between them you can separate them with an asterisk <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> instead of a <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>. Separate them with a colon <code><a href="https://rdrr.io/r/base/Colon.html">:</a></code> if you are only specifying the interaction. For example:</p>
<div class="sourceCode" id="cb810"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age_cat</span> <span class="op">*</span> <span class="va">fever</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span></code></pre></div>
<p><em>Optionally</em>, you can leverage the pre-defined vector of column names and re-create the above command using <code>str_c()</code> as shown below. This might be useful if your explanatory variable names are changing, or you don’t want to type them all out again.</p>
<div class="sourceCode" id="cb811"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## run a regression with all variables of interest </span>
<span class="va">mv_reg</span> <span class="op">&lt;-</span> <span class="va">explanatory_vars</span> <span class="op">%&gt;%</span>  <span class="co">## begin with vector of explanatory column names</span>
  <span class="fu">str_c</span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span> <span class="op">%&gt;%</span>     <span class="co">## combine all names of the variables of interest separated by a plus</span>
  <span class="fu">str_c</span><span class="op">(</span><span class="st">"outcome ~ "</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>    <span class="co">## combine the names of variables of interest with outcome in formula style</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span>,      <span class="co">## define type of glm as logistic,</span>
      data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span>          <span class="co">## define your dataset</span></code></pre></div>
<div id="building-the-model" class="section level4 unnumbered">
<h4>Building the model<a class="anchor" aria-label="anchor" href="#building-the-model"><i class="fas fa-link"></i></a>
</h4>
<p>You can build you model step-by-step, saving various models that include certain explanatory variables. You can compare these models with likelihood-ratio tests using <code>lrtest()</code> from the package <strong>lmtest</strong>, as below:</p>
<div class="sourceCode" id="cb812"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">age_cat</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span>
<span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">age_cat</span> <span class="op">+</span> <span class="va">gender</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">linelist</span><span class="op">)</span>

<span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">model2</span><span class="op">)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: outcome ~ age_cat
## Model 2: outcome ~ age_cat + gender
##   #Df           LogLik Df   Chisq Pr(&gt;Chisq)
## 1   8 -2840.1647955255                      
## 2   9 -2840.0200482391  1 0.28949    0.59054</code></pre>
<p>Another option is to take the model object and apply the <code><a href="https://rdrr.io/r/stats/step.html">step()</a></code> function from the <strong>stats</strong> package. Specify which variable selection direction you want use when building the model.</p>
<div class="sourceCode" id="cb814"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## choose a model using forward selection based on AIC</span>
<span class="co">## you can also do "backward" or "both" by adjusting the direction</span>
<span class="va">final_mv_reg</span> <span class="op">&lt;-</span> <span class="va">mv_reg</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/step.html">step</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"forward"</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>You can also turn off scientific notation in your R session, for clarity:</p>
<div class="sourceCode" id="cb815"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span></code></pre></div>
<p>As described in the section on univariate analysis, pass the model output to <code>tidy()</code> to exponentiate the log odds and CIs. Finally we round all numeric columns to two decimal places. Scroll through to see all the rows.</p>
<div class="sourceCode" id="cb816"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mv_tab_base</span> <span class="op">&lt;-</span> <span class="va">final_mv_reg</span> <span class="op">%&gt;%</span> 
  <span class="co">## get a tidy dataframe of estimates </span>
  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exponentiate <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## round </span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Here is what the resulting data frame looks like:</p>
<div id="htmlwidget-5379e75bd8bd85f4d7f8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5379e75bd8bd85f4d7f8">{"x":{"filter":"none","data":[["(Intercept)","gender","fever","chills","cough","aches","vomit","age_cat5-9","age_cat10-14","age_cat15-19","age_cat20-29","age_cat30-49","age_cat50-69","age_cat70+"],[1.33,1.04,0.95,1,1.09,1.1,1.02,1.13,0.87,0.88,0.84,0.84,1.12,0.69],[0.13,0.07,0.08,0.08,0.09,0.1,0.06,0.1,0.11,0.11,0.1,0.12,0.26,0.64],[2.18,0.57,-0.68,0,0.99,0.9,0.24,1.16,-1.24,-1.1,-1.71,-1.45,0.45,-0.59],[0.03,0.57,0.49,1,0.32,0.37,0.81,0.25,0.21,0.27,0.09,0.15,0.66,0.56],[1.03,0.91,0.81,0.86,0.92,0.9,0.9,0.92,0.71,0.71,0.69,0.67,0.68,0.19],[1.72,1.18,1.1,1.17,1.3,1.35,1.15,1.38,1.08,1.1,1.03,1.06,1.88,2.5]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!-- ======================================================= -->
</div>
</div>
<div id="combine-univariate-and-multivariate" class="section level3 unnumbered">
<h3>Combine univariate and multivariate<a class="anchor" aria-label="anchor" href="#combine-univariate-and-multivariate"><i class="fas fa-link"></i></a>
</h3>
<div id="combine-with-gtsummary" class="section level4 unnumbered">
<h4>Combine with <strong>gtsummary</strong><a class="anchor" aria-label="anchor" href="#combine-with-gtsummary"><i class="fas fa-link"></i></a>
</h4>
<p>The <code>gtsummary</code> package provides the <code>tbl_regression</code> function, which will
take the outputs from a regression (<code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> in this case) and produce an easy
summary table. You can also combine several different output tables produced by <code>gtsummary</code> with
the <code>tbl_merge</code> function.</p>
<div class="sourceCode" id="cb817"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## show results table of final regression </span>
<span class="va">mv_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span><span class="va">final_mv_reg</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>And now combine the univariate and multivariate results:</p>
<div class="sourceCode" id="cb818"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## combine with univariate results </span>
<span class="fu">tbl_merge</span><span class="op">(</span>
  tbls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">univ_tab</span>, <span class="va">mv_tab</span><span class="op">)</span>, 
  tab_spanner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"**Univariate**"</span>, <span class="st">"**Multivariable**"</span><span class="op">)</span><span class="op">)</span> <span class="co"># set header names</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#cqjbtfscnl .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cqjbtfscnl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cqjbtfscnl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cqjbtfscnl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cqjbtfscnl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqjbtfscnl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cqjbtfscnl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cqjbtfscnl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cqjbtfscnl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cqjbtfscnl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cqjbtfscnl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cqjbtfscnl .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#cqjbtfscnl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cqjbtfscnl .gt_from_md > :first-child {
  margin-top: 0;
}

#cqjbtfscnl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cqjbtfscnl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cqjbtfscnl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#cqjbtfscnl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqjbtfscnl .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#cqjbtfscnl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqjbtfscnl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cqjbtfscnl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cqjbtfscnl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqjbtfscnl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cqjbtfscnl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#cqjbtfscnl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cqjbtfscnl .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#cqjbtfscnl .gt_left {
  text-align: left;
}

#cqjbtfscnl .gt_center {
  text-align: center;
}

#cqjbtfscnl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cqjbtfscnl .gt_font_normal {
  font-weight: normal;
}

#cqjbtfscnl .gt_font_bold {
  font-weight: bold;
}

#cqjbtfscnl .gt_font_italic {
  font-style: italic;
}

#cqjbtfscnl .gt_super {
  font-size: 65%;
}

#cqjbtfscnl .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="cqjbtfscnl" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><div class="inline-table"><table class="gt_table">
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_center gt_columns_bottom_border" rowspan="2" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="4">
        <span class="gt_column_spanner"><strong>Univariate</strong></span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner"><strong>Multivariable</strong></span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>OR</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>OR</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">gender</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.89, 1.13</td>
      <td class="gt_row gt_center">&gt;0.9</td>
      <td class="gt_row gt_center">1.04</td>
      <td class="gt_row gt_center">0.91, 1.18</td>
      <td class="gt_row gt_center">0.6</td>
    </tr>
<tr>
<td class="gt_row gt_left">fever</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">0.94</td>
      <td class="gt_row gt_center">0.8100000000000001, 1.10</td>
      <td class="gt_row gt_center">0.5</td>
      <td class="gt_row gt_center">0.95</td>
      <td class="gt_row gt_center">0.8100000000000001, 1.10</td>
      <td class="gt_row gt_center">0.5</td>
    </tr>
<tr>
<td class="gt_row gt_left">chills</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.86, 1.16</td>
      <td class="gt_row gt_center">&gt;0.9</td>
      <td class="gt_row gt_center">1.00</td>
      <td class="gt_row gt_center">0.86, 1.17</td>
      <td class="gt_row gt_center">&gt;0.9</td>
    </tr>
<tr>
<td class="gt_row gt_left">cough</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.91, 1.29</td>
      <td class="gt_row gt_center">0.4</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.92, 1.30</td>
      <td class="gt_row gt_center">0.3</td>
    </tr>
<tr>
<td class="gt_row gt_left">aches</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.09</td>
      <td class="gt_row gt_center">0.89, 1.33</td>
      <td class="gt_row gt_center">0.4</td>
      <td class="gt_row gt_center">1.10</td>
      <td class="gt_row gt_center">0.90, 1.35</td>
      <td class="gt_row gt_center">0.4</td>
    </tr>
<tr>
<td class="gt_row gt_left">vomit</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center">1.02</td>
      <td class="gt_row gt_center">0.90, 1.15</td>
      <td class="gt_row gt_center">0.7</td>
      <td class="gt_row gt_center">1.02</td>
      <td class="gt_row gt_center">0.90, 1.15</td>
      <td class="gt_row gt_center">0.8</td>
    </tr>
<tr>
<td class="gt_row gt_left">age_cat</td>
      <td class="gt_row gt_center">4,166</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">0-4</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center">—</td>
      <td class="gt_row gt_center"></td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">5-9</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">1.12</td>
      <td class="gt_row gt_center">0.92, 1.37</td>
      <td class="gt_row gt_center">0.3</td>
      <td class="gt_row gt_center">1.13</td>
      <td class="gt_row gt_center">0.92, 1.38</td>
      <td class="gt_row gt_center">0.2</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">10-14</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.87</td>
      <td class="gt_row gt_center">0.71, 1.08</td>
      <td class="gt_row gt_center">0.2</td>
      <td class="gt_row gt_center">0.87</td>
      <td class="gt_row gt_center">0.71, 1.08</td>
      <td class="gt_row gt_center">0.2</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">15-19</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.89</td>
      <td class="gt_row gt_center">0.71, 1.10</td>
      <td class="gt_row gt_center">0.3</td>
      <td class="gt_row gt_center">0.88</td>
      <td class="gt_row gt_center">0.71, 1.10</td>
      <td class="gt_row gt_center">0.3</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">20-29</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.84</td>
      <td class="gt_row gt_center">0.69, 1.03</td>
      <td class="gt_row gt_center">0.093</td>
      <td class="gt_row gt_center">0.84</td>
      <td class="gt_row gt_center">0.69, 1.03</td>
      <td class="gt_row gt_center">0.08699999999999999</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">30-49</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.85</td>
      <td class="gt_row gt_center">0.6800000000000000, 1.07</td>
      <td class="gt_row gt_center">0.2</td>
      <td class="gt_row gt_center">0.84</td>
      <td class="gt_row gt_center">0.67, 1.06</td>
      <td class="gt_row gt_center">0.15</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">50-69</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">1.15</td>
      <td class="gt_row gt_center">0.70, 1.91</td>
      <td class="gt_row gt_center">0.6</td>
      <td class="gt_row gt_center">1.12</td>
      <td class="gt_row gt_center">0.6800000000000000, 1.88</td>
      <td class="gt_row gt_center">0.7</td>
    </tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">70+</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center">0.70</td>
      <td class="gt_row gt_center">0.19, 2.55</td>
      <td class="gt_row gt_center">0.6</td>
      <td class="gt_row gt_center">0.69</td>
      <td class="gt_row gt_center">0.19, 2.50</td>
      <td class="gt_row gt_center">0.6</td>
    </tr>
</tbody>
<tfoot><tr class="gt_footnotes">
<td colspan="8">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks"><em>1</em>
          </sup>
           
          OR = Odds Ratio, CI = Confidence Interval
          <br></p>
      </td>
    </tr></tfoot>
</table></div></div>
</div>
<div id="combine-with-dplyr" class="section level4 unnumbered">
<h4>Combine with <strong>dplyr</strong><a class="anchor" aria-label="anchor" href="#combine-with-dplyr"><i class="fas fa-link"></i></a>
</h4>
<p>An alternative way of combining the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>/<code>tidy()</code> univariate and multivariate outputs is with the <strong>dplyr</strong> join functions.</p>
<ul>
<li>Join the univariate results from earlier (which contains counts) with the tidied multivariate results<br>
</li>
<li>Use <code>select()</code> to keep only the columns we want, specify their order, and re-name them<br>
</li>
<li>Use <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code> with two decimal places on all the column that are class Double</li>
</ul>
<div class="sourceCode" id="cb819"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## combine univariate and multivariable tables </span>
<span class="fu">left_join</span><span class="op">(</span><span class="va">univ_tab_base</span>, <span class="va">mv_tab_base</span>, by <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## choose columns and rename them</span>
  <span class="fu">select</span><span class="op">(</span> <span class="co"># new name =  old name</span>
    <span class="st">"characteristic"</span> <span class="op">=</span> <span class="va">term</span>, 
    <span class="st">"recovered"</span>      <span class="op">=</span> <span class="st">"0"</span>, 
    <span class="st">"dead"</span>           <span class="op">=</span> <span class="st">"1"</span>, 
    <span class="st">"univ_or"</span>        <span class="op">=</span> <span class="va">estimate.x</span>, 
    <span class="st">"univ_ci_low"</span>    <span class="op">=</span> <span class="va">conf.low.x</span>, 
    <span class="st">"univ_ci_high"</span>   <span class="op">=</span> <span class="va">conf.high.x</span>,
    <span class="st">"univ_pval"</span>      <span class="op">=</span> <span class="va">p.value.x</span>, 
    <span class="st">"mv_or"</span>          <span class="op">=</span> <span class="va">estimate.y</span>, 
    <span class="st">"mvv_ci_low"</span>     <span class="op">=</span> <span class="va">conf.low.y</span>, 
    <span class="st">"mv_ci_high"</span>     <span class="op">=</span> <span class="va">conf.high.y</span>,
    <span class="st">"mv_pval"</span>        <span class="op">=</span> <span class="va">p.value.y</span> 
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">is.double</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 20 x 11
##    characteristic recovered  dead univ_or univ_ci_low univ_ci_high univ_pval mv_or mvv_ci_low mv_ci_high mv_pval
##    &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1 (Intercept)          902  1195    1.32        1.22         1.44     0      1.33       1.03       1.72   0.03 
##  2 gender               888  1181    1           0.89         1.13     0.95   1.04       0.91       1.18   0.570
##  3 (Intercept)          352   489    1.39        1.21         1.59     0      1.33       1.03       1.72   0.03 
##  4 fever               1438  1887    0.94        0.81         1.1      0.47   0.95       0.81       1.1    0.49 
##  5 (Intercept)         1436  1907    1.33        1.24         1.42     0      1.33       1.03       1.72   0.03 
##  6 chills               354   469    1           0.86         1.16     0.98   1          0.86       1.17   1    
##  7 (Intercept)          269   333    1.24        1.05         1.45     0.01   1.33       1.03       1.72   0.03 
##  8 cough               1521  2043    1.09        0.91         1.29     0.36   1.09       0.92       1.3    0.32 
##  9 (Intercept)         1615  2126    1.32        1.23         1.4      0      1.33       1.03       1.72   0.03 
## 10 aches                175   250    1.09        0.89         1.33     0.43   1.1        0.9        1.35   0.37 
## 11 (Intercept)          900  1182    1.31        1.2          1.43     0      1.33       1.03       1.72   0.03 
## 12 vomit                890  1194    1.02        0.9          1.15     0.73   1.02       0.9        1.15   0.81 
## 13 (Intercept)          324   460    1.42        1.23         1.64     0      1.33       1.03       1.72   0.03 
## 14 age_cat5-9           300   478    1.12        0.92         1.37     0.26   1.13       0.92       1.38   0.25 
## 15 age_cat10-14         287   356    0.87        0.71         1.08     0.21   0.87       0.71       1.08   0.21 
## 16 age_cat15-19         247   311    0.89        0.71         1.1      0.28   0.88       0.71       1.1    0.27 
## 17 age_cat20-29         365   437    0.84        0.69         1.03     0.09   0.84       0.69       1.03   0.09 
## 18 age_cat30-49         235   285    0.85        0.68         1.07     0.17   0.84       0.67       1.06   0.15 
## 19 age_cat50-69          27    44    1.15        0.7          1.91     0.59   1.12       0.68       1.88   0.66 
## 20 age_cat70+             5     5    0.7         0.19         2.55     0.580  0.69       0.19       2.5    0.56</code></pre>
<!-- ======================================================= -->
</div>
</div>
</div>
<div id="forest-plot" class="section level2" number="18.6">
<h2>
<span class="header-section-number">18.6</span> Forest plot<a class="anchor" aria-label="anchor" href="#forest-plot"><i class="fas fa-link"></i></a>
</h2>
<p>This section shows how to produce a plot with the outputs of your regression.
There are two options, you can build a plot yourself using <code>ggplot2</code> or use a
meta-package called <strong>easystats</strong> (package that includes many packages).</p>
<!-- ======================================================= -->
<div id="ggplot2-package" class="section level3 unnumbered">
<h3>
<strong>ggplot2</strong> package<a class="anchor" aria-label="anchor" href="#ggplot2-package"><i class="fas fa-link"></i></a>
</h3>
<p>You can build a forest plot with <code>ggplot()</code> by plotting elements of the multivariate regression results. Add the layers:</p>
<ul>
<li>estimates with <code>geom_point()</code><br>
</li>
<li>confidence intervals with <code>geom_errorbar()</code><br>
</li>
<li>a vertical line at OR = 1 with <code>geom_vline()</code>
</li>
</ul>
<p>You may want to re-arrange the order of the variables/levels on the y-axis (see how the order of age_cat levels is alphabetical and not sensical). To do this, use <code>fct_relevel()</code> from the <strong>forcats</strong> package to classify the column <code>term</code> as a factor and specify the order manually. See the page on <a href="factors.html#factors">Factors</a> for more details.</p>
<div class="sourceCode" id="cb821"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## remove the intercept term from your multivariable results</span>
<span class="va">mv_tab_base</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">## plot with variable on the y axis and estimate (OR) on the x axis</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, y <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">## show the estimate as a point</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="co">## add in an error bar for the confidence intervals</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">conf.low</span>, xmax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="co">## show where OR = 1 is for reference as a dashed line</span>
  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/ggplot_forest-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
<div id="easystats-packages" class="section level3 unnumbered">
<h3>
<strong>easystats</strong> packages<a class="anchor" aria-label="anchor" href="#easystats-packages"><i class="fas fa-link"></i></a>
</h3>
<p>The alternative if you do not want to decide all of the different things required
for a <code>ggplot</code>, is to use a combination of <strong>easystats</strong> packages.
In this case the <strong>parameters</strong> package function <code>model_parameters()</code> does the equivalent
of <strong>broom</strong> package function <code>tidy()</code>. The <strong>see</strong> package then accepts those outputs
and creates a default forest plot as a <code>ggplot()</code> object.</p>
<div class="sourceCode" id="cb822"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## remove the intercept term from your multivariable results</span>
<span class="va">final_mv_reg</span> <span class="op">%&gt;%</span> 
  <span class="fu">model_parameters</span><span class="op">(</span>exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/easystats_forest-1.png" width="672"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="resources-11" class="section level2" number="18.7">
<h2>
<span class="header-section-number">18.7</span> Resources<a class="anchor" aria-label="anchor" href="#resources-11"><i class="fas fa-link"></i></a>
</h2>
<p>Much of the information in this page is adapted from these resources and vignettes online:</p>
<p><a href="http://www.danieldsjoberg.com/gtsummary/articles/tbl_regression.html">gtsummary</a></p>
<p><a href="http://www.sthda.com/english/articles/36-classification-methods-essentials/150-stepwise-logistic-regression-essentials-in-r/">sthda stepwise regression</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="descriptive-analysis.html"><span class="header-section-number">17</span> Descriptive analysis</a></div>
<div class="next"><a href="missing-data.html"><span class="header-section-number">19</span> Missing data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#univariate-and-multivariate-regression"><span class="header-section-number">18</span> Univariate and multivariate regression</a></li>
<li><a class="nav-link" href="#overview-5"><span class="header-section-number">18.1</span> Overview</a></li>
<li>
<a class="nav-link" href="#preparation-9"><span class="header-section-number">18.2</span> Preparation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#load-packages-10">Load packages</a></li>
<li><a class="nav-link" href="#import-data-9">Import data</a></li>
<li><a class="nav-link" href="#clean-data">Clean data</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#univariate"><span class="header-section-number">18.3</span> Univariate</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#base-r-2">base R</a></li>
<li><a class="nav-link" href="#gtsummary-package-2">gtsummary package</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#stratified"><span class="header-section-number">18.4</span> Stratified</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#gtsummary-package-3">gtsummary package</a></li>
<li><a class="nav-link" href="#base-r-3">base R</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#multivariate"><span class="header-section-number">18.5</span> Multivariate</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#conduct-multivariate">Conduct multivariate</a></li>
<li><a class="nav-link" href="#combine-univariate-and-multivariate">Combine univariate and multivariate</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#forest-plot"><span class="header-section-number">18.6</span> Forest plot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ggplot2-package">ggplot2 package</a></li>
<li><a class="nav-link" href="#easystats-packages">easystats packages</a></li>
</ul>
</li>
<li><a class="nav-link" href="#resources-11"><span class="header-section-number">18.7</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2021-03-15.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
