<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>14 Characters and strings | The Epidemiologist R Handbook</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.15/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">About this book</li>
<li><a class="" href="editorial-and-technical-notes.html"><span class="header-section-number">1</span> Editorial and technical notes</a></li>
<li><a class="" href="download-handbook-and-data.html"><span class="header-section-number">2</span> Download handbook and data</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> R Basics</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transition to R</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">5</span> Suggested packages</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">7</span> Import and export</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Cleaning data and core functions</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with dates</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">10</span> Factors</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">11</span> Pivoting data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">12</span> Grouping data</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">13</span> Joining data</a></li>
<li><a class="active" href="characters-and-strings.html"><span class="header-section-number">14</span> Characters and strings</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></li>
<li><a class="" href="iteration-loops-and-lists.html"><span class="header-section-number">16</span> Iteration, loops, and lists</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="descriptive-tables.html"><span class="header-section-number">17</span> Descriptive tables</a></li>
<li><a class="" href="simple-statistical-tests.html"><span class="header-section-number">18</span> Simple statistical tests</a></li>
<li><a class="" href="univariate-and-multivariable-regression.html"><span class="header-section-number">19</span> Univariate and multivariable regression</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Missing data</a></li>
<li><a class="" href="standardization-1.html"><span class="header-section-number">21</span> Standardization</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">22</span> Moving averages</a></li>
<li><a class="" href="time-series-and-outbreak-detection-1.html"><span class="header-section-number">23</span> Time series and outbreak detection</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">24</span> Epidemic modeling</a></li>
<li><a class="" href="contact-tracing.html"><span class="header-section-number">25</span> Contact tracing</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">26</span> Survival analysis</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">27</span> GIS basics</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="tables-for-presentation.html"><span class="header-section-number">28</span> Tables for presentation</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">29</span> ggplot basics</a></li>
<li><a class="" href="plot-continuous-data.html"><span class="header-section-number">30</span> Plot continuous data</a></li>
<li><a class="" href="plot-categorical-data.html"><span class="header-section-number">31</span> Plot categorical data</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">32</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">33</span> Epidemic curves</a></li>
<li><a class="" href="demographic-pyramids-and-likert-scales.html"><span class="header-section-number">34</span> Demographic pyramids and Likert-scales</a></li>
<li><a class="" href="diagrams-and-charts.html"><span class="header-section-number">35</span> Diagrams and charts</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">36</span> Combinations analysis</a></li>
<li><a class="" href="heat-plots.html"><span class="header-section-number">37</span> Heat plots</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">38</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees-1.html"><span class="header-section-number">39</span> Phylogenetic trees</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">40</span> Interactive plots</a></li>
<li class="book-part">Reports and dashboards</li>
<li><a class="" href="reports-with-r-markdown.html"><span class="header-section-number">41</span> Reports with R Markdown</a></li>
<li><a class="" href="organizing-routine-reports.html"><span class="header-section-number">42</span> Organizing routine reports</a></li>
<li><a class="" href="dashboards-with-r-markdown.html"><span class="header-section-number">43</span> Dashboards with R Markdown</a></li>
<li><a class="" href="dashboards-with-shiny.html"><span class="header-section-number">44</span> Dashboards with Shiny</a></li>
<li class="book-part">Miscellaneous</li>
<li><a class="" href="writing-functions-1.html"><span class="header-section-number">45</span> Writing functions</a></li>
<li><a class="" href="version-control-and-collaboration-with-github.html"><span class="header-section-number">46</span> Version control and collaboration with Github</a></li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">47</span> Directory interactions</a></li>
<li><a class="" href="errors-help.html"><span class="header-section-number">48</span> Errors &amp; help</a></li>
<li><a class="" href="relational-databases.html"><span class="header-section-number">49</span> Relational databases</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">50</span> R on network drives</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">51</span> Data Table</a></li>
<li><a class="" href="advanced-rstudio.html"><span class="header-section-number">52</span> Advanced RStudio</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="characters-and-strings" class="section level1" number="14">
<h1>
<span class="header-section-number">14</span> Characters and strings<a class="anchor" aria-label="anchor" href="#characters-and-strings"><i class="fas fa-link"></i></a>
</h1>
<p>This page demonstrates use of the <strong>stringr</strong> package to evaluate and manage character (strings).</p>
<ol style="list-style-type: decimal">
<li>Combine, order, arrange - <code>str_c()</code>, <code>str_glue()</code>, <code>str_order()</code><br>
</li>
<li>Clean and standardise<br>
</li>
</ol>
<ul>
<li>Adjust length - <code>str_pad()</code>, <code>str_trunc()</code>, <code>str_wrap()</code><br>
</li>
<li>Change case - <code>str_to_upper()</code>, <code>str_to_title()</code>, <code>str_to_lower()</code>, <code>str_to_sentence()</code><br>
</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Evaluate and extract by position - <code>str_length()</code>, <code>str_sub()</code>, <code>word()</code><br>
</li>
<li>Patterns<br>
</li>
</ol>
<ul>
<li>Detect and locate - <code>str_detect()</code>, <code>str_subset()</code>, <code>str_match()</code>, <code>str_extract()</code><br>
</li>
<li>Modify and replace - <code>str_sub()</code>, <code>str_replace_all()</code><br>
</li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>Regular expressions (“regex”)</li>
</ol>
<p>For ease of display most examples are shown acting on a short defined character vector, however they can easily be applied/adapted to a column within a dataset.</p>
<p>Much of this page is adapted from this <a href="https://cran.r-project.org/web/packages/stringr/vignettes/stringr.html">online vignette</a></p>
<!-- ======================================================= -->
<div id="preparation-5" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> Preparation<a class="anchor" aria-label="anchor" href="#preparation-5"><i class="fas fa-link"></i></a>
</h2>
<p>Install or load the <strong>stringr</strong> package.</p>
<div class="sourceCode" id="cb563"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install/load the stringr package</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span>
  <span class="va">stringr</span>,    <span class="co"># many functions for handling strings</span>
  <span class="va">tidyverse</span>,  <span class="co"># for optional data manipulation</span>
  <span class="va">tools</span><span class="op">)</span>      <span class="co"># alternative for converting to title case</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="unite-split-and-arrange" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> Unite, split, and arrange<a class="anchor" aria-label="anchor" href="#unite-split-and-arrange"><i class="fas fa-link"></i></a>
</h2>
<p>This section covers:</p>
<ul>
<li>Using <code>str_c()</code>, <code>str_glue()</code>, and <code>unite()</code> to combine strings<br>
</li>
<li>Using <code>str_order()</code> to arrange strings<br>
</li>
<li>Using <code>str_split()</code> and <code>separate()</code> to split strings</li>
</ul>
<!-- ======================================================= --><div id="combine-strings" class="section level3 unnumbered">
<h3>Combine strings<a class="anchor" aria-label="anchor" href="#combine-strings"><i class="fas fa-link"></i></a>
</h3>
<p>To combine or concatenate multiple strings into one string, we suggest using <code>str_c</code> from <strong>stringr</strong>.</p>
<div class="sourceCode" id="cb564"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_c</span><span class="op">(</span><span class="st">"String1"</span>, <span class="st">"String2"</span>, <span class="st">"String3"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "String1String2String3"</code></pre>
<p>The argument <code>sep =</code> inserts characters between each input (e.g. a comma or newline <code>"\n"</code>)</p>
<div class="sourceCode" id="cb566"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_c</span><span class="op">(</span><span class="st">"String1"</span>, <span class="st">"String2"</span>, <span class="st">"String3"</span>, sep <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "String1, String2, String3"</code></pre>
<p>The argument <code>collapse =</code> is relevant if producing multiple combined elements in the output. The example below shows the combination of two vectors into one (first names and last names). Another similar example might be jurisdictions and their case counts.</p>
<p><code>sep</code> displays between the respective string inputs, while <code>collapse</code> displays between the elements produced.</p>
<p>In this example:</p>
<ul>
<li>The <code>sep</code> value goes between each first and last name<br>
</li>
<li>The <code>collapse</code> value goes between each person</li>
</ul>
<div class="sourceCode" id="cb568"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">first_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"abdul"</span>, <span class="st">"fahruk"</span>, <span class="st">"janice"</span><span class="op">)</span> 
<span class="va">last_names</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hussein"</span>, <span class="st">"akinleye"</span>, <span class="st">"musa"</span><span class="op">)</span>

<span class="co"># sep displays between the respective input strings, while collapse displays between the elements produced</span>
<span class="fu">str_c</span><span class="op">(</span><span class="va">first_names</span>, <span class="va">last_names</span>, sep <span class="op">=</span> <span class="st">" "</span>, collapse <span class="op">=</span> <span class="st">";  "</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "abdul hussein;  fahruk akinleye;  janice musa"</code></pre>
<p>When printing such a combined string with newlines, you may need to wrap the whole phrase in <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> for the newlines to print properly:</p>
<div class="sourceCode" id="cb570"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># For newlines to print correctly, the phrase may need to be wrapped in cat()</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu">str_c</span><span class="op">(</span><span class="va">first_names</span>, <span class="va">last_names</span>, sep <span class="op">=</span> <span class="st">" "</span>, collapse <span class="op">=</span> <span class="st">";\n"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## abdul hussein;
## fahruk akinleye;
## janice musa</code></pre>
<!-- ======================================================= -->
</div>
<div id="dynamic-strings" class="section level3 unnumbered">
<h3>Dynamic strings<a class="anchor" aria-label="anchor" href="#dynamic-strings"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>str_glue()</code> to insert dynamic R code into a string. This is a very useful function for creating dynamic plot captions, as demonstrated below.</p>
<ul>
<li>All content goes between quotation marks <code>str_glue("")</code><br>
</li>
<li>Any dynamic code or calls of defined values are within curly brackets <code>{}</code> within the parentheses. There can be many curly brackets.<br>
</li>
<li>To display quotes within the outer quotation marks, use single quotes (e.g. when providing date format)<br>
</li>
<li>You can use <code>\n</code> within the quotes to force a new line<br>
</li>
<li>You use <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> to adjust date display, and use <code><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date()</a></code> to display the current date</li>
</ul>
<p>A simple example, of a dynamic plot caption:</p>
<div class="sourceCode" id="cb572"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_glue</span><span class="op">(</span><span class="st">"The linelist is current to {format(Sys.Date(), '%d %b %Y')} and includes {nrow(linelist)} cases."</span><span class="op">)</span></code></pre></div>
<pre><code>## The linelist is current to 29 Apr 2021 and includes 5888 cases.</code></pre>
<p>An alternative format is to use placeholders within the brackets and define the code in separate arguments at the end of the <code>str_glue()</code> function, as below. This can improve code readability if the codes are long.</p>
<div class="sourceCode" id="cb574"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_glue</span><span class="op">(</span><span class="st">"Data source is the confirmed case linelist as of {current_date}.\nThe last case was reported hospitalized on {last_hospital}.\n{n_missing_onset} cases are missing date of onset and not shown"</span>,
         current_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'%d %b %Y'</span><span class="op">)</span>,
         last_hospital <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">date_hospitalisation</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>, <span class="st">'%d %b %Y'</span><span class="op">)</span>,
         n_missing_onset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
         <span class="op">)</span></code></pre></div>
<pre><code>## Data source is the confirmed case linelist as of 29 Apr 2021.
## The last case was reported hospitalized on 30 Apr 2015.
## 256 cases are missing date of onset and not shown</code></pre>
<p><strong>Pulling from a dataframe</strong></p>
<p>Sometimes, it is useful to pull data from dataframe and have it pasted together in sequence. Below is an example using this dataset to make a summary output of jurisdictions and the new and total cases:</p>
<div class="sourceCode" id="cb576"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># make case table</span>
<span class="va">case_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  zone       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Zone 1"</span>, <span class="st">"Zone 2"</span>, <span class="st">"Zone 3"</span>, <span class="st">"Zone 4"</span>, <span class="st">"Zone 5"</span><span class="op">)</span>,
  new_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">7</span>, <span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,
  total_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">4</span>, <span class="fl">25</span>, <span class="fl">10</span>, <span class="fl">103</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-617cdbc19a701061370f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-617cdbc19a701061370f">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"4\" data-max=\"103\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["Zone 1","Zone 2","Zone 3","Zone 4","Zone 5"],[3,0,7,0,15],[40,4,25,10,103]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>zone<\/th>\n      <th>new_cases<\/th>\n      <th>total_cases<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p><strong>Option 1:</strong></p>
<p>Use <code>str_c()</code> with the dataframe and column names. Provide <code>sep</code> and <code>collapse</code> arguments.</p>
<div class="sourceCode" id="cb577"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_c</span><span class="op">(</span><span class="va">case_table</span><span class="op">$</span><span class="va">zone</span>, <span class="va">case_table</span><span class="op">$</span><span class="va">new_cases</span>, sep <span class="op">=</span> <span class="st">" = "</span>, collapse <span class="op">=</span> <span class="st">";  "</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Zone 1 = 3;  Zone 2 = 0;  Zone 3 = 7;  Zone 4 = 0;  Zone 5 = 15"</code></pre>
<p>Add text “New Cases:” to the beginning of the summary by wrapping with a separate <code>str_c()</code> (if “New Cases:” was within the original <code>str_c()</code> it would appear multiple times).</p>
<div class="sourceCode" id="cb579"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_c</span><span class="op">(</span><span class="st">"New Cases: "</span>, <span class="fu">str_c</span><span class="op">(</span><span class="va">case_table</span><span class="op">$</span><span class="va">zone</span>, <span class="va">case_table</span><span class="op">$</span><span class="va">new_cases</span>, sep <span class="op">=</span> <span class="st">" = "</span>, collapse <span class="op">=</span> <span class="st">";  "</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "New Cases: Zone 1 = 3;  Zone 2 = 0;  Zone 3 = 7;  Zone 4 = 0;  Zone 5 = 15"</code></pre>
<p><strong>Option 2:</strong></p>
<p>You can achieve a similar result with <code>str_glue()</code>, with newlines added automatically:</p>
<div class="sourceCode" id="cb581"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_glue</span><span class="op">(</span><span class="st">"{case_table$zone}: {case_table$new_cases} new cases ({case_table$total_cases} total cases)"</span><span class="op">)</span></code></pre></div>
<pre><code>## Zone 1: 3 new cases (40 total cases)
## Zone 2: 0 new cases (4 total cases)
## Zone 3: 7 new cases (25 total cases)
## Zone 4: 0 new cases (10 total cases)
## Zone 5: 15 new cases (103 total cases)</code></pre>
<p>To use str_glue() but have more control (e.g. to use double newlines), wrap it within <code>str_c()</code> and adjust the <code>collapse</code> value. You may need to print using <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> to correctly print the newlines.</p>
<div class="sourceCode" id="cb583"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">case_summary</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="fu">str_glue</span><span class="op">(</span><span class="st">"{case_table$zone}: {case_table$new_cases} new cases ({case_table$total_cases} total cases)"</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"\n\n"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">case_summary</span><span class="op">)</span> <span class="co"># print</span></code></pre></div>
<pre><code>## Zone 1: 3 new cases (40 total cases)
## 
## Zone 2: 0 new cases (4 total cases)
## 
## Zone 3: 7 new cases (25 total cases)
## 
## Zone 4: 0 new cases (10 total cases)
## 
## Zone 5: 15 new cases (103 total cases)</code></pre>
</div>
<div id="unite-columns" class="section level3 unnumbered">
<h3>Unite columns<a class="anchor" aria-label="anchor" href="#unite-columns"><i class="fas fa-link"></i></a>
</h3>
<p>Within a dataframe, bringing together character values from multiple columns can be achieved with <code>unite()</code> from <strong>tidyr</strong>. This is the opposite of <code>separate()</code>.</p>
<p>Provide the name of the new united column. Then provide the names of the columns you wish to unite.</p>
<ul>
<li>By default the separator used in the united column is underscore <code>_</code>, but this can be changed with the <code>sep</code> argument.<br>
</li>
<li>
<code>remove =</code> removes the input columns from the data frame (TRUE by default)<br>
</li>
<li>
<code>na.rm =</code> removes missing values while uniting (FALSE by default)</li>
</ul>
<p>Below, we unite the three symptom columns in this dataframe.</p>
<div id="htmlwidget-ccebe07b5436076a865e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ccebe07b5436076a865e">{"x":{"filter":"none","data":[[1,2,3,4,5,6],["jaundice","chills","fever","vomiting","bleeding","rapid"],["fever","aches",null,"diarrhoea","from","pulse"],["chills","pains",null,null,"gums, fever","headache"],["Success","Failure","Failure","Success","Success","Success"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_ID<\/th>\n      <th>sym_1<\/th>\n      <th>sym_2<\/th>\n      <th>sym_3<\/th>\n      <th>outcome<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb585"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_split</span> <span class="op">%&gt;%</span> 
  <span class="fu">unite</span><span class="op">(</span>
    col <span class="op">=</span> <span class="st">"all_symptoms"</span>,         <span class="co"># name of the new united column</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sym_1"</span>, <span class="st">"sym_2"</span>, <span class="st">"sym_3"</span><span class="op">)</span>, <span class="co"># columns to unite</span>
    sep <span class="op">=</span> <span class="st">", "</span>,                   <span class="co"># separator to use in united column</span>
    remove <span class="op">=</span> <span class="cn">TRUE</span>,                <span class="co"># if TRUE, removes input cols from the data frame</span>
    na.rm <span class="op">=</span> <span class="cn">TRUE</span>                  <span class="co"># if TRUE, missing values are removed before uniting</span>
  <span class="op">)</span></code></pre></div>
<pre><code>##   case_ID                all_symptoms outcome
## 1       1     jaundice, fever, chills Success
## 2       2        chills, aches, pains Failure
## 3       3                       fever Failure
## 4       4         vomiting, diarrhoea Success
## 5       5 bleeding, from, gums, fever Success
## 6       6      rapid, pulse, headache Success</code></pre>
<!-- ======================================================= -->
</div>
<div id="split" class="section level3 unnumbered">
<h3>Split<a class="anchor" aria-label="anchor" href="#split"><i class="fas fa-link"></i></a>
</h3>
<p>To split a string based on a pattern, use <code>str_split()</code>. It evaluates the strings and returns a list of character vectors consisting of the newly-split values.</p>
<p>The simple example below evaluates one string and splits it into three. By default it returns a list with one element (a character vector) for each string provided. If <code>simplify = TRUE</code> it returns a character matrix.</p>
<p>One string is provided, and returned is a list with one element, which is a character vector with three values</p>
<div class="sourceCode" id="cb587"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_split</span><span class="op">(</span>string <span class="op">=</span> <span class="st">"jaundice, fever, chills"</span>,
          pattern <span class="op">=</span> <span class="st">","</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
## [1] "jaundice" " fever"   " chills"</code></pre>
<p>You can assign this as a named object, and access the nth symptom. To access a specific symptom you can use syntax like this: <code>the_split_return_object[[1]][2]</code>, which would access the second symptom from the first evaluated string (“fever”). See the <a href="r-basics.html#r-basics">R basics</a> page for more detail on accessing elements.</p>
<div class="sourceCode" id="cb589"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pt1_symptoms</span> <span class="op">&lt;-</span> <span class="fu">str_split</span><span class="op">(</span><span class="st">"jaundice, fever, chills"</span>, <span class="st">","</span><span class="op">)</span>

<span class="va">pt1_symptoms</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>  <span class="co"># extracts 2nd value from 1st (and only) element of the list</span></code></pre></div>
<pre><code>## [1] " fever"</code></pre>
<p>If multiple strings are evaluated, there will be more than one element in the returned list.</p>
<div class="sourceCode" id="cb591"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">symptoms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"jaundice, fever, chills"</span>,     <span class="co"># patient 1</span>
              <span class="st">"chills, aches, pains"</span>,        <span class="co"># patient 2 </span>
              <span class="st">"fever"</span>,                       <span class="co"># patient 3</span>
              <span class="st">"vomiting, diarrhoea"</span>,         <span class="co"># patient 4</span>
              <span class="st">"bleeding from gums, fever"</span>,   <span class="co"># patient 5</span>
              <span class="st">"rapid pulse, headache"</span><span class="op">)</span>       <span class="co"># patient 6</span>

<span class="fu">str_split</span><span class="op">(</span><span class="va">symptoms</span>, <span class="st">","</span><span class="op">)</span>                     <span class="co"># split each patient's symptoms</span></code></pre></div>
<pre><code>## [[1]]
## [1] "jaundice" " fever"   " chills" 
## 
## [[2]]
## [1] "chills" " aches" " pains"
## 
## [[3]]
## [1] "fever"
## 
## [[4]]
## [1] "vomiting"   " diarrhoea"
## 
## [[5]]
## [1] "bleeding from gums" " fever"            
## 
## [[6]]
## [1] "rapid pulse" " headache"</code></pre>
<p>To return a “character matrix” instead, which may be useful if creating dataframe columns, set the argument <code>simplify = TRUE</code> as shown below:</p>
<div class="sourceCode" id="cb593"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_split</span><span class="op">(</span><span class="va">symptoms</span>, <span class="st">","</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1]                 [,2]         [,3]     
## [1,] "jaundice"           " fever"     " chills"
## [2,] "chills"             " aches"     " pains" 
## [3,] "fever"              ""           ""       
## [4,] "vomiting"           " diarrhoea" ""       
## [5,] "bleeding from gums" " fever"     ""       
## [6,] "rapid pulse"        " headache"  ""</code></pre>
<p>You can also adjust the number of splits to create with the <code>n =</code> argument. For example, this restricts the number of splits (from the left side) to 2 splits. The further commas remain within the second split.</p>
<div class="sourceCode" id="cb595"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_split</span><span class="op">(</span><span class="va">symptoms</span>, <span class="st">","</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1]                 [,2]            
## [1,] "jaundice"           " fever, chills"
## [2,] "chills"             " aches, pains" 
## [3,] "fever"              ""              
## [4,] "vomiting"           " diarrhoea"    
## [5,] "bleeding from gums" " fever"        
## [6,] "rapid pulse"        " headache"</code></pre>
<p><em>Note - the same outputs can be achieved with <code>str_split_fixed()</code>, in which you do not give the <code>simplify</code> argument, but must instead designate the number of columns (<code>n</code>).</em></p>
<div class="sourceCode" id="cb597"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_split_fixed</span><span class="op">(</span><span class="va">symptoms</span>, <span class="st">","</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
</div>
<div id="split-columns" class="section level3 unnumbered">
<h3>Split columns<a class="anchor" aria-label="anchor" href="#split-columns"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>separate()</code> from <strong>dplyr</strong> within a dataframe, to split one character column into other columns.</p>
<p>If we have a simple dataframe <code>df</code> consisting of a case ID column, one character column with symptoms, and one outcome column:</p>
<div id="htmlwidget-22c8b3ffa596c40ade02" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-22c8b3ffa596c40ade02">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1\" data-max=\"6\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[[1,2,3,4,5,6],["jaundice, fever, chills","chills, aches, pains","fever","vomiting, diarrhoea","bleeding from gums, fever","rapid pulse, headache"],["Success","Failure","Failure","Success","Success","Success"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_ID<\/th>\n      <th>symptoms<\/th>\n      <th>outcome<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p>First, provide the column to be separated. Then provide <code>into =</code> as a vector <code><a href="https://rdrr.io/r/base/c.html">c( )</a></code> containing the <em>new</em> columns names, as shown below.</p>
<ul>
<li>
<code>sep =</code> the separator, can be a character, or a number (interpreted as the character position to split at).</li>
<li>
<code>remove =</code> FALSE by default, removes the input column<br>
</li>
<li>
<code>convert =</code> FALSE by default, will cause string “NA”s to become <code>NA</code><br>
</li>
<li>
<code>extra =</code> this controls what happens if there are more values created by the separation than new columns named.
<ul>
<li>
<code>extra = "warn"</code> means you will see a warning but it will drop excess values (the default)<br>
</li>
<li>
<code>extra = "drop"</code> means the excess values will be dropped with no warning<br>
</li>
<li><strong><code>extra = "merge"</code> will only split to the number of new columns listed in <code>into</code> - <em>this setting will preserve all your data</em></strong></li>
</ul>
</li>
</ul>
<p>An example with <code>extra = "merge"</code> - no data is lost and third symptoms are combined into the second new named column:</p>
<div class="sourceCode" id="cb598"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># third symptoms combined into second new column</span>
<span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span><span class="va">symptoms</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sym_1"</span>, <span class="st">"sym_2"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">","</span>, extra <span class="op">=</span> <span class="st">"merge"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 1 rows [3].</code></pre>
<pre><code>##   case_ID              sym_1          sym_2 outcome
## 1       1           jaundice  fever, chills Success
## 2       2             chills   aches, pains Failure
## 3       3              fever           &lt;NA&gt; Failure
## 4       4           vomiting      diarrhoea Success
## 5       5 bleeding from gums          fever Success
## 6       6        rapid pulse       headache Success</code></pre>
<p>When the default <code>extra = "drop"</code> is used below, a warning is given but the third symptoms are lost:</p>
<div class="sourceCode" id="cb601"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># third symptoms are lost</span>
<span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span><span class="va">symptoms</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sym_1"</span>, <span class="st">"sym_2"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">","</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Additional pieces discarded in 2 rows [1, 2].</code></pre>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 1 rows [3].</code></pre>
<pre><code>##   case_ID              sym_1      sym_2 outcome
## 1       1           jaundice      fever Success
## 2       2             chills      aches Failure
## 3       3              fever       &lt;NA&gt; Failure
## 4       4           vomiting  diarrhoea Success
## 5       5 bleeding from gums      fever Success
## 6       6        rapid pulse   headache Success</code></pre>
<p><span style="color: orange;"><strong><em>CAUTION:</em></strong> If you do not provide enough <code>into</code> values for the new columns, your data may be truncated.</span></p>
<!-- ======================================================= -->
</div>
<div id="arrange" class="section level3 unnumbered">
<h3>Arrange<a class="anchor" aria-label="anchor" href="#arrange"><i class="fas fa-link"></i></a>
</h3>
<p>Several strings can be sorted by alphabetical order. <code>str_order()</code> returns the order, while <code>str_sort()</code> returns the strings in that order.</p>
<div class="sourceCode" id="cb605"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># strings</span>
<span class="va">health_zones</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Alba"</span>, <span class="st">"Takota"</span>, <span class="st">"Delta"</span><span class="op">)</span>

<span class="co"># return the alphabetical order</span>
<span class="fu">str_order</span><span class="op">(</span><span class="va">health_zones</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1 3 2</code></pre>
<div class="sourceCode" id="cb607"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># return the strings in alphabetical order</span>
<span class="fu">str_sort</span><span class="op">(</span><span class="va">health_zones</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Alba"   "Delta"  "Takota"</code></pre>
<p>To use a different alphabet, add the argument <code>locale =</code>. See the full list of locales by entering <code><a href="https://rdrr.io/pkg/stringi/man/stri_locale_list.html">stringi::stri_locale_list()</a></code> in the R console.</p>
<p>To arrange strings in order of their value in another column, use <code>arrange()</code> like this: TO DO</p>
<!-- ======================================================= -->
</div>
<div id="base-r-functions" class="section level3 unnumbered">
<h3>base R functions<a class="anchor" aria-label="anchor" href="#base-r-functions"><i class="fas fa-link"></i></a>
</h3>
<p>It is common to see <strong>base</strong> R functions <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> and <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>, which concatenate vectors after converting all parts to character. They act similarly to <code>str_c()</code> but the syntax differs - in the code each part is separated by a comma. The parts are either text (in quotes) or pre-defined code objects. For example:</p>
<div class="sourceCode" id="cb609"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n_beds</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">n_masks</span> <span class="op">&lt;-</span> <span class="fl">20</span>

<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Regional hospital needs"</span>, <span class="va">n_beds</span>, <span class="st">"beds and"</span>, <span class="va">n_masks</span>, <span class="st">"masks."</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Regional hospital needs 10 beds and 20 masks."</code></pre>
<p><code>sep</code> and <code>collapse</code> arguments can be adjusted. By default, <code>sep</code> is a space, unless using <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> where there is no space between parts.</p>
</div>
</div>
<div id="clean-and-standardise" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> Clean and standardise<a class="anchor" aria-label="anchor" href="#clean-and-standardise"><i class="fas fa-link"></i></a>
</h2>
<!-- ======================================================= -->
<div id="change-case" class="section level3" number="14.3.1">
<h3>
<span class="header-section-number">14.3.1</span> Change case<a class="anchor" aria-label="anchor" href="#change-case"><i class="fas fa-link"></i></a>
</h3>
<p>Often one must alter the case/capitalization of a string value, for example names of jursidictions. Use <code>str_to_upper()</code>, <code>str_to_upper()</code>, and <code>str_to_title()</code>, from <strong>stringr</strong>, as shown below:</p>
<div class="sourceCode" id="cb611"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_to_upper</span><span class="op">(</span><span class="st">"California"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "CALIFORNIA"</code></pre>
<div class="sourceCode" id="cb613"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_to_lower</span><span class="op">(</span><span class="st">"California"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "california"</code></pre>
<p>Using *base** R, the above can also be achieved with <code><a href="https://rdrr.io/r/base/chartr.html">toupper()</a></code>, <code><a href="https://rdrr.io/r/base/chartr.html">tolower()</a></code>.</p>
<p><strong>Title case</strong></p>
<p>Transforming the string so each word is capitalized can be achieved with <code>str_to_title()</code>:</p>
<div class="sourceCode" id="cb615"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_to_title</span><span class="op">(</span><span class="st">"go to the US state of california "</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Go To The Us State Of California "</code></pre>
<p>Use <code>toTitleCase()</code> from the <strong>tools</strong> package to achieve more nuanced capitalization (words like “to”, “the”, and “of” are not capitalized).</p>
<div class="sourceCode" id="cb617"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/toTitleCase.html">toTitleCase</a></span><span class="op">(</span><span class="st">"This is the US state of california"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "This is the US State of California"</code></pre>
<p>You can also use <code>str_to_sentence()</code>, which capitalizes only the first letter of the string.</p>
<div class="sourceCode" id="cb619"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_to_sentence</span><span class="op">(</span><span class="st">"the patient must be transported"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "The patient must be transported"</code></pre>
</div>
<div id="pad-length" class="section level3 unnumbered">
<h3>Pad length<a class="anchor" aria-label="anchor" href="#pad-length"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>str_pad()</code> to add characters to a string, to a minimum length. By default spaces are added, but you can also pad with other characters using the <code>pad =</code> argument.</p>
<div class="sourceCode" id="cb621"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ICD codes of differing length</span>
<span class="va">ICD_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"R10.13"</span>,
               <span class="st">"R10.819"</span>,
               <span class="st">"R17"</span><span class="op">)</span>

<span class="co"># ICD codes padded to 7 characters on the right side</span>
<span class="fu">str_pad</span><span class="op">(</span><span class="va">ICD_codes</span>, <span class="fl">7</span>, <span class="st">"right"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "R10.13 " "R10.819" "R17    "</code></pre>
<div class="sourceCode" id="cb623"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pad with periods instead of spaces</span>
<span class="fu">str_pad</span><span class="op">(</span><span class="va">ICD_codes</span>, <span class="fl">7</span>, <span class="st">"right"</span>, pad <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "R10.13." "R10.819" "R17...."</code></pre>
<p>For example, to pad numbers with leading zeros (such as for hours or minutes), you can pad the number to minimum length of 2 with <code>pad = "0"</code>.</p>
<div class="sourceCode" id="cb625"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add leading zeros to two digits (e.g. for times minutes/hours)</span>
<span class="fu">str_pad</span><span class="op">(</span><span class="st">"4"</span>, <span class="fl">2</span>, pad <span class="op">=</span> <span class="st">"0"</span><span class="op">)</span> </code></pre></div>
<pre><code>## [1] "04"</code></pre>
<div class="sourceCode" id="cb627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># example using a numeric column named "hours"</span>
<span class="co"># hours &lt;- str_pad(hours, 2, pad = "0")</span></code></pre></div>
</div>
<div id="truncate" class="section level3 unnumbered">
<h3>Truncate<a class="anchor" aria-label="anchor" href="#truncate"><i class="fas fa-link"></i></a>
</h3>
<p><code>str_trunc()</code> sets a maximum length for each string. If a string exceeds this length, it is truncated (shortened) and an ellipsis (…) is included to indicate that the string was previously longer. Note that the ellipsis <em>is</em> counted in the length. The ellipsis characters can be changed with the argument <code>ellipsis =</code>. The optional <code>side =</code> argument specifies which where the ellipsis will appear within the truncated string (“left”, “right”, or “center”).</p>
<div class="sourceCode" id="cb628"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">original</span> <span class="op">&lt;-</span> <span class="st">"Symptom onset on 4/3/2020 with vomiting"</span>
<span class="fu">str_trunc</span><span class="op">(</span><span class="va">original</span>, <span class="fl">10</span>, <span class="st">"center"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Symp...ing"</code></pre>
</div>
<div id="standardize-length" class="section level3 unnumbered">
<h3>Standardize length<a class="anchor" aria-label="anchor" href="#standardize-length"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>str_trunc()</code> to set a maximum length, and then use <code>str_pad()</code> to expand the very short strings to that truncated length. In the example below, 6 is set as the maximum length (one value is truncated), and then a very short value is padded to achieve length of 6.</p>
<div class="sourceCode" id="cb630"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ICD codes of differing length</span>
<span class="va">ICD_codes</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"R10.13"</span>,
                 <span class="st">"R10.819"</span>,
                 <span class="st">"R17"</span><span class="op">)</span>

<span class="co"># truncate to maximum length of 6</span>
<span class="va">ICD_codes_2</span> <span class="op">&lt;-</span> <span class="fu">str_trunc</span><span class="op">(</span><span class="va">ICD_codes</span>, <span class="fl">6</span><span class="op">)</span>
<span class="va">ICD_codes_2</span></code></pre></div>
<pre><code>## [1] "R10.13" "R10..." "R17"</code></pre>
<div class="sourceCode" id="cb632"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># expand to minimum length of 6</span>
<span class="va">ICD_codes_3</span> <span class="op">&lt;-</span> <span class="fu">str_pad</span><span class="op">(</span><span class="va">ICD_codes_2</span>, <span class="fl">6</span>, <span class="st">"right"</span><span class="op">)</span>
<span class="va">ICD_codes_3</span></code></pre></div>
<pre><code>## [1] "R10.13" "R10..." "R17   "</code></pre>
</div>
<div id="remove-leadingtrailing-whitespace" class="section level3 unnumbered">
<h3>Remove leading/trailing whitespace<a class="anchor" aria-label="anchor" href="#remove-leadingtrailing-whitespace"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>str_trim()</code> to remove spaces, newlines (<code>\n</code>) or tabs (<code>\t</code>) on sides of a string input. Add <code>"right"</code> <code>"left"</code>, or <code>"both"</code> to the command to specify which side to trim (e.g. <code>str_trim(x, "right")</code>.</p>
<div class="sourceCode" id="cb634"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ID numbers with excess spaces on right</span>
<span class="va">IDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"provA_1852  "</span>, <span class="co"># two excess spaces</span>
         <span class="st">"provA_2345"</span>,   <span class="co"># zero excess spaces</span>
         <span class="st">"provA_9460 "</span><span class="op">)</span>  <span class="co"># one excess space</span>

<span class="co"># IDs trimmed to remove excess spaces on right side only</span>
<span class="fu">str_trim</span><span class="op">(</span><span class="va">IDs</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "provA_1852" "provA_2345" "provA_9460"</code></pre>
</div>
<div id="remove-repeated-whitespace-within" class="section level3 unnumbered">
<h3>Remove repeated whitespace within<a class="anchor" aria-label="anchor" href="#remove-repeated-whitespace-within"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>str_squish()</code> to remove repeated spaces that appear <em>inside</em> a string. For example, to convert double spaces into single spaces. It also removes spaces, newlines, or tabs on the outside of the string like <code>str_trim()</code>.</p>
<div class="sourceCode" id="cb636"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># original contains excess spaces within string</span>
<span class="fu">str_squish</span><span class="op">(</span><span class="st">"  Pt requires   IV saline\n"</span><span class="op">)</span> </code></pre></div>
<pre><code>## [1] "Pt requires IV saline"</code></pre>
<p>Enter <code>?str_trim</code>, <code>?str_pad</code> in your R console to see further details.</p>
</div>
<div id="wrap-into-paragraphs" class="section level3 unnumbered">
<h3>Wrap into paragraphs<a class="anchor" aria-label="anchor" href="#wrap-into-paragraphs"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>str_wrap()</code> to wrap a long unstructured text into a structured paragraph with fixed line length. Provide the ideal character length for each line, and it applies an algorithm to insert newlines (<code>\n</code>) within the paragraph, as seen in the example below.</p>
<div class="sourceCode" id="cb638"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pt_course</span> <span class="op">&lt;-</span> <span class="st">"Symptom onset 1/4/2020 vomiting chills fever. Pt saw traditional healer in home village on 2/4/2020. On 5/4/2020 pt symptoms worsened and was admitted to Lumta clinic. Sample was taken and pt was transported to regional hospital on 6/4/2020. Pt died at regional hospital on 7/4/2020."</span>

<span class="fu">str_wrap</span><span class="op">(</span><span class="va">pt_course</span>, <span class="fl">40</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Symptom onset 1/4/2020 vomiting chills\nfever. Pt saw traditional healer in\nhome village on 2/4/2020. On 5/4/2020\npt symptoms worsened and was admitted\nto Lumta clinic. Sample was taken and pt\nwas transported to regional hospital on\n6/4/2020. Pt died at regional hospital\non 7/4/2020."</code></pre>
<p>The <strong>base</strong> function <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> can be wrapped around the above command in order to print the output, displaying the new lines added.</p>
<div class="sourceCode" id="cb640"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu">str_wrap</span><span class="op">(</span><span class="va">pt_course</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Symptom onset 1/4/2020 vomiting chills
## fever. Pt saw traditional healer in
## home village on 2/4/2020. On 5/4/2020
## pt symptoms worsened and was admitted
## to Lumta clinic. Sample was taken and pt
## was transported to regional hospital on
## 6/4/2020. Pt died at regional hospital
## on 7/4/2020.</code></pre>
<!-- ======================================================= -->
</div>
</div>
<div id="handle-by-position" class="section level2" number="14.4">
<h2>
<span class="header-section-number">14.4</span> Handle by position<a class="anchor" aria-label="anchor" href="#handle-by-position"><i class="fas fa-link"></i></a>
</h2>
<div id="extract-by-character-position" class="section level3 unnumbered">
<h3>Extract by character position<a class="anchor" aria-label="anchor" href="#extract-by-character-position"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>str_sub()</code> to return only a part of a string. The function takes three main arguments:</p>
<ol style="list-style-type: decimal">
<li>the character vector(s)<br>
</li>
<li>start position<br>
</li>
<li>end position</li>
</ol>
<p>A few notes on position numbers:</p>
<ul>
<li>If a position number is positive, the position is counted starting from the left end of the string.<br>
</li>
<li>If a position number is negative, it is counted starting from the right end of the string.<br>
</li>
<li>Position numbers are inclusive.<br>
</li>
<li>Positions extending beyond the string will be truncated (removed).</li>
</ul>
<p>Below are some examples applied to the string “pneumonia”:</p>
<div class="sourceCode" id="cb642"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># start and end third from left (3rd letter from left)</span>
<span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "e"</code></pre>
<div class="sourceCode" id="cb644"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 0 is not present</span>
<span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] ""</code></pre>
<div class="sourceCode" id="cb646"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 6th from left, to the 1st from right</span>
<span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="fl">6</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "onia"</code></pre>
<div class="sourceCode" id="cb648"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 5th from right, to the 2nd from right</span>
<span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "moni"</code></pre>
<div class="sourceCode" id="cb650"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 4th from left to a position outside the string</span>
<span class="fu">str_sub</span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="fl">4</span>, <span class="fl">15</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "umonia"</code></pre>
</div>
<div id="extract-by-word-position" class="section level3 unnumbered">
<h3>Extract by word position<a class="anchor" aria-label="anchor" href="#extract-by-word-position"><i class="fas fa-link"></i></a>
</h3>
<p>To extract the nth ‘word’, use <code>word()</code>, also from <strong>stringr</strong>. Provide the string(s), then the first word position to extract, and the last word position to extract.</p>
<p>By default, the separator between ‘words’ is assumed to be a space, unless otherwise indicated with <code>sep =</code> (e.g. <code>sep = "_"</code> when words are separated by underscores.</p>
<div class="sourceCode" id="cb652"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># strings to evaluate</span>
<span class="va">chief_complaints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I just got out of the hospital 2 days ago, but still can barely breathe."</span>,
                      <span class="st">"My stomach hurts"</span>,
                      <span class="st">"Severe ear pain"</span><span class="op">)</span>

<span class="co"># extract 1st to 3rd words of each string</span>
<span class="fu">word</span><span class="op">(</span><span class="va">chief_complaints</span>, start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">3</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "I just got"       "My stomach hurts" "Severe ear pain"</code></pre>
</div>
<div id="replace-by-character-position" class="section level3 unnumbered">
<h3>Replace by character position<a class="anchor" aria-label="anchor" href="#replace-by-character-position"><i class="fas fa-link"></i></a>
</h3>
<p><code>str_sub()</code> paired with the assignment operator (<code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code>) can be used to modify a part of a string:</p>
<div class="sourceCode" id="cb654"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word</span> <span class="op">&lt;-</span> <span class="st">"pneumonia"</span>

<span class="co"># convert the third and fourth characters to X </span>
<span class="fu">str_sub</span><span class="op">(</span><span class="va">word</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"XX"</span>

<span class="va">word</span></code></pre></div>
<pre><code>## [1] "pnXXmonia"</code></pre>
<p>An example applied to multiple strings (e.g. a column). Note the expansion in length of “HIV”.</p>
<div class="sourceCode" id="cb656"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">words</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pneumonia"</span>, <span class="st">"tubercolosis"</span>, <span class="st">"HIV"</span><span class="op">)</span>

<span class="co"># convert the third and fourth characters to X </span>
<span class="fu">str_sub</span><span class="op">(</span><span class="va">words</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"XX"</span>

<span class="va">words</span></code></pre></div>
<pre><code>## [1] "pnXXmonia"    "tuXXrcolosis" "HIXX"</code></pre>
</div>
<div id="evaluate-length" class="section level3 unnumbered">
<h3>Evaluate length<a class="anchor" aria-label="anchor" href="#evaluate-length"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb658"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_length</span><span class="op">(</span><span class="st">"abc"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Alternatively, use <code><a href="https://rdrr.io/r/base/nchar.html">nchar()</a></code> from <strong>base</strong> R</p>
<!-- ======================================================= -->
</div>
</div>
<div id="patterns" class="section level2" number="14.5">
<h2>
<span class="header-section-number">14.5</span> Patterns<a class="anchor" aria-label="anchor" href="#patterns"><i class="fas fa-link"></i></a>
</h2>
<p>Many <strong>stringr</strong> functions work to detect, locate, extract, match, replace, and split based on a specified <em>pattern</em>.</p>
<!-- ======================================================= -->
<div id="detect-a-pattern" class="section level3 unnumbered">
<h3>Detect a pattern<a class="anchor" aria-label="anchor" href="#detect-a-pattern"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>str_detect()</code> as below to detect presence/absence of a pattern within a string. First list the string or vector to search in, and then the pattern to look for. Note that by default the search <em>is case sensitive</em>!</p>
<div class="sourceCode" id="cb660"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_detect</span><span class="op">(</span><span class="st">"primary school teacher"</span>, <span class="st">"teach"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The argument <code>negate =</code> can be included and set to <code>TRUE</code> if you want to know if the pattern is NOT present.</p>
<div class="sourceCode" id="cb662"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_detect</span><span class="op">(</span><span class="st">"primary school teacher"</span>, <span class="st">"teach"</span>, negate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>To ignore case/capitalization, wrap the pattern within <code><a href="https://rdrr.io/r/base/regex.html">regex()</a></code> and <em>within</em> <code><a href="https://rdrr.io/r/base/regex.html">regex()</a></code> add the argument <code>ignore_case = T</code>.</p>
<div class="sourceCode" id="cb664"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_detect</span><span class="op">(</span><span class="st">"Teacher"</span>, <span class="fu"><a href="https://rdrr.io/r/base/regex.html">regex</a></span><span class="op">(</span><span class="st">"teach"</span>, ignore_case <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>When <code>str_detect()</code> is applied to a character vector/column, it will return a TRUE/FALSE for each of the values in the vector.</p>
<div class="sourceCode" id="cb666"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a vector/column of occupations </span>
<span class="va">occupations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"field laborer"</span>,
                 <span class="st">"university professor"</span>,
                 <span class="st">"primary school teacher &amp; tutor"</span>,
                 <span class="st">"tutor"</span>,
                 <span class="st">"nurse at regional hospital"</span>,
                 <span class="st">"lineworker at Amberdeen Fish Factory"</span>,
                 <span class="st">"physican"</span>,
                 <span class="st">"cardiologist"</span>,
                 <span class="st">"office worker"</span>,
                 <span class="st">"food service"</span><span class="op">)</span>

<span class="co"># Detect presence of pattern "teach" in each string - output is vector of TRUE/FALSE</span>
<span class="fu">str_detect</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach"</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>If you need to count these, apply <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> to the output. This counts the number TRUE.</p>
<div class="sourceCode" id="cb668"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>To search inclusive of multiple terms, include them separated by OR bars (|) within the pattern, as shown below:</p>
<div class="sourceCode" id="cb670"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach|professor|tutor"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>If you need to make a long list of search terms, you can combine them using <code>str_c()</code> and <code>sep = |</code>, define this is a character object, and reference it later more succinctly. The example below includes possible occupation search terms for frontline medical providers.</p>
<div class="sourceCode" id="cb672"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># search terms</span>
<span class="va">occupation_med_frontline</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="st">"medical"</span>, <span class="st">"medicine"</span>, <span class="st">"hcw"</span>, <span class="st">"healthcare"</span>, <span class="st">"home care"</span>, <span class="st">"home health"</span>,
                                <span class="st">"surgeon"</span>, <span class="st">"doctor"</span>, <span class="st">"doc"</span>, <span class="st">"physician"</span>, <span class="st">"surgery"</span>, <span class="st">"peds"</span>, <span class="st">"pediatrician"</span>,
                               <span class="st">"intensivist"</span>, <span class="st">"cardiologist"</span>, <span class="st">"coroner"</span>, <span class="st">"nurse"</span>, <span class="st">"nursing"</span>, <span class="st">"rn"</span>, <span class="st">"lpn"</span>,
                               <span class="st">"cna"</span>, <span class="st">"pa"</span>, <span class="st">"physician assistant"</span>, <span class="st">"mental health"</span>,
                               <span class="st">"emergency department technician"</span>, <span class="st">"resp therapist"</span>, <span class="st">"respiratory"</span>,
                                <span class="st">"phlebotomist"</span>, <span class="st">"pharmacy"</span>, <span class="st">"pharmacist"</span>, <span class="st">"hospital"</span>, <span class="st">"snf"</span>, <span class="st">"rehabilitation"</span>,
                               <span class="st">"rehab"</span>, <span class="st">"activity"</span>, <span class="st">"elderly"</span>, <span class="st">"subacute"</span>, <span class="st">"sub acute"</span>,
                                <span class="st">"clinic"</span>, <span class="st">"post acute"</span>, <span class="st">"therapist"</span>, <span class="st">"extended care"</span>,
                                <span class="st">"dental"</span>, <span class="st">"dential"</span>, <span class="st">"dentist"</span>, sep <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span>

<span class="va">occupation_med_frontline</span></code></pre></div>
<pre><code>## [1] "medical|medicine|hcw|healthcare|home care|home health|surgeon|doctor|doc|physician|surgery|peds|pediatrician|intensivist|cardiologist|coroner|nurse|nursing|rn|lpn|cna|pa|physician assistant|mental health|emergency department technician|resp therapist|respiratory|phlebotomist|pharmacy|pharmacist|hospital|snf|rehabilitation|rehab|activity|elderly|subacute|sub acute|clinic|post acute|therapist|extended care|dental|dential|dentist"</code></pre>
<p>This command returns the number of occupations which contain any one of the search terms for front-line medical providers (<code>occupation_med_frontline</code>):</p>
<div class="sourceCode" id="cb674"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">occupations</span>, <span class="va">occupation_med_frontline</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p><strong>Base R string search functions</strong></p>
<p>The <strong>base</strong> function <code><a href="https://rdrr.io/r/base/grep.html">grepl()</a></code> works similarly to <code>str_detect()</code>, in that it searches for matches to a pattern and returns a logical vector. The basic syntax is <code><a href="https://rdrr.io/r/base/grep.html">grepl(pattern, strings_to_search, ignore.case = FALSE, ...)</a></code>. One advantage is that the <code>ignore.case</code> argument is easier to write (there is no need to involve <code><a href="https://rdrr.io/r/base/regex.html">regex()</a></code> function).</p>
<p>Likewise, the <strong>base</strong> functions <code><a href="https://rdrr.io/r/base/grep.html">sub()</a></code> and <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> act similarly to <code>str_replace()</code>. Their basic syntax is: <code><a href="https://rdrr.io/r/base/grep.html">gsub(pattern, replacement, strings_to_search, ignore.case = FALSE)</a></code>. <code><a href="https://rdrr.io/r/base/grep.html">sub()</a></code> will replace the first instance of the pattern, whereas <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> will replace all instances of the pattern.</p>
<div id="convert-commas-to-periods" class="section level4 unnumbered">
<h4>Convert commas to periods<a class="anchor" aria-label="anchor" href="#convert-commas-to-periods"><i class="fas fa-link"></i></a>
</h4>
<p>Here is an example of using <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> to convert commas to periods in a vector of numbers. This could be useful if your data come from much of the world other from the United States or Great Britain.</p>
<p>The inner <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> which acts first on <code>lengths</code> is converting any periods to no space "“. The period character”." has to be “escaped” with two slashes to actually signify a period, because “.” in regex means “any character”. Then, the result (with only commas) is passed to the outer <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> in which commas are replaced by periods.</p>
<div class="sourceCode" id="cb676"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2.454,56"</span>, <span class="st">"1,2"</span>, <span class="st">"6.096,5"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">","</span>,                <span class="co"># find commas     </span>
                replacement <span class="op">=</span> <span class="st">"."</span>,            <span class="co"># replace with periods</span>
                x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">""</span>, <span class="va">lengths</span><span class="op">)</span>  <span class="co"># vector with other periods removed (periods escaped)</span>
                <span class="op">)</span>
           <span class="op">)</span>                                  <span class="co"># convert outcome to numeric</span></code></pre></div>
</div>
</div>
<div id="replace-all" class="section level3 unnumbered">
<h3>Replace all<a class="anchor" aria-label="anchor" href="#replace-all"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code>str_replace_all()</code> as a “find and replace” tool. First, provide the strings to be evaluated, then the pattern to be replaced, and then the replacement value. The example below replaces all instances of “dead” with “deceased”. Note, this IS case sensitive.</p>
<div class="sourceCode" id="cb677"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Karl: dead"</span>,
            <span class="st">"Samantha: dead"</span>,
            <span class="st">"Marco: not dead"</span><span class="op">)</span>

<span class="fu">str_replace_all</span><span class="op">(</span><span class="va">outcome</span>, <span class="st">"dead"</span>, <span class="st">"deceased"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Karl: deceased"      "Samantha: deceased"  "Marco: not deceased"</code></pre>
<p>To replace a pattern with <code>NA</code>, use <code>str_replace_na()</code>. The function <code>str_replace()</code> replaces only the first instance of the pattern within each evaluated string.</p>
<!-- ======================================================= -->
</div>
<div id="detect-within-logic" class="section level3 unnumbered">
<h3>Detect within logic<a class="anchor" aria-label="anchor" href="#detect-within-logic"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Within <code>case_when()</code></strong></p>
<p><code>str_detect()</code> is often used within <code>case_when()</code> (from <strong>dplyr</strong>). Let’s say the occupations are a column in the linelist called <code>occupations</code>. The <code>mutate()</code> below creates a new column called <code>is_educator</code> by using conditional logic via <code>case_when()</code>. See the page on data cleaning to learn more about <code>case_when()</code>.</p>
<div class="sourceCode" id="cb679"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>is_educator <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
    <span class="co"># term search within occupation, not case sensitive</span>
    <span class="fu">str_detect</span><span class="op">(</span><span class="va">occupations</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/regex.html">regex</a></span><span class="op">(</span><span class="st">"teach|prof|tutor|university"</span>,
                     ignore_case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>              <span class="op">~</span> <span class="st">"Educator"</span>,
    <span class="co"># all others</span>
    <span class="cn">TRUE</span>                                               <span class="op">~</span> <span class="st">"Not an educator"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>As a reminder, it may be important to add exclusion criteria to the conditional logic (<code>negate = F</code>):</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="characters-and-strings.html#cb680-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb680-2"><a href="characters-and-strings.html#cb680-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># value in new column is_educator is based on conditional logic</span></span>
<span id="cb680-3"><a href="characters-and-strings.html#cb680-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_educator =</span> <span class="fu">case_when</span>(</span>
<span id="cb680-4"><a href="characters-and-strings.html#cb680-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb680-5"><a href="characters-and-strings.html#cb680-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># occupation column must meet 2 criteria to be assigned "Educator":</span></span>
<span id="cb680-6"><a href="characters-and-strings.html#cb680-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># it must have a search term AND NOT any exclusion term</span></span>
<span id="cb680-7"><a href="characters-and-strings.html#cb680-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb680-8"><a href="characters-and-strings.html#cb680-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Must have a search term AND</span></span>
<span id="cb680-9"><a href="characters-and-strings.html#cb680-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(occupations,</span>
<span id="cb680-10"><a href="characters-and-strings.html#cb680-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">regex</span>(<span class="st">"teach|prof|tutor|university"</span>, <span class="at">ignore_case =</span> T)) <span class="sc">&amp;</span>              </span>
<span id="cb680-11"><a href="characters-and-strings.html#cb680-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Must NOT have an exclusion term</span></span>
<span id="cb680-12"><a href="characters-and-strings.html#cb680-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(occupations,</span>
<span id="cb680-13"><a href="characters-and-strings.html#cb680-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">regex</span>(<span class="st">"admin"</span>, <span class="at">ignore_case =</span> T),</span>
<span id="cb680-14"><a href="characters-and-strings.html#cb680-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">negate =</span> T)                          <span class="sc">~</span> <span class="st">"Educator"</span></span>
<span id="cb680-15"><a href="characters-and-strings.html#cb680-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb680-16"><a href="characters-and-strings.html#cb680-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># All rows not meeting above criteria</span></span>
<span id="cb680-17"><a href="characters-and-strings.html#cb680-17" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span>                                            <span class="sc">~</span> <span class="st">"Not an educator"</span>))</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="locate-pattern-position" class="section level3 unnumbered">
<h3>Locate pattern position<a class="anchor" aria-label="anchor" href="#locate-pattern-position"><i class="fas fa-link"></i></a>
</h3>
<p>To locate the <em>first</em> position of a pattern, use <code>str_locate()</code>. It outputs a start and end position.</p>
<div class="sourceCode" id="cb681"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_locate</span><span class="op">(</span><span class="st">"I wish"</span>, <span class="st">"sh"</span><span class="op">)</span></code></pre></div>
<pre><code>##      start end
## [1,]     5   6</code></pre>
<p>Like other <code>str</code> functions, there is an "_all" version (<code>str_locate_all()</code>) which will return the positions of <em>all</em> instances of the pattern within each string. This outputs as a <code>list</code>.</p>
<div class="sourceCode" id="cb683"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phrases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I wish"</span>, <span class="st">"I hope"</span>, <span class="st">"he hopes"</span>, <span class="st">"He hopes"</span><span class="op">)</span>

<span class="fu">str_locate</span><span class="op">(</span><span class="va">phrases</span>, <span class="st">"h"</span> <span class="op">)</span>     <span class="co"># position of *first* instance of the pattern</span></code></pre></div>
<pre><code>##      start end
## [1,]     6   6
## [2,]     3   3
## [3,]     1   1
## [4,]     4   4</code></pre>
<div class="sourceCode" id="cb685"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_locate_all</span><span class="op">(</span><span class="va">phrases</span>, <span class="st">"h"</span> <span class="op">)</span> <span class="co"># position of *every* instance of the pattern</span></code></pre></div>
<pre><code>## [[1]]
##      start end
## [1,]     6   6
## 
## [[2]]
##      start end
## [1,]     3   3
## 
## [[3]]
##      start end
## [1,]     1   1
## [2,]     4   4
## 
## [[4]]
##      start end
## [1,]     4   4</code></pre>
<!-- ======================================================= -->
</div>
<div id="extract-a-match" class="section level3 unnumbered">
<h3>Extract a match<a class="anchor" aria-label="anchor" href="#extract-a-match"><i class="fas fa-link"></i></a>
</h3>
<p><code>str_extract_all()</code> returns the matching patterns themselves, which is most useful when you have offered several patterns via “OR” conditions. For example, looking in the string vector of occupations (see previous tab) for <em>either</em> “teach”, “prof”, or “tutor”.</p>
<p><code>str_extract_all()</code> returns a <code>list</code> which contains <em>all matches</em> for each evaluated string. See below how occupation 3 has two pattern matches within it.</p>
<div class="sourceCode" id="cb687"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach|prof|tutor"</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
## character(0)
## 
## [[2]]
## [1] "prof"
## 
## [[3]]
## [1] "teach" "tutor"
## 
## [[4]]
## [1] "tutor"
## 
## [[5]]
## character(0)
## 
## [[6]]
## character(0)
## 
## [[7]]
## character(0)
## 
## [[8]]
## character(0)
## 
## [[9]]
## character(0)
## 
## [[10]]
## character(0)</code></pre>
<p><code>str_extract()</code> extracts <em>only the first match</em> in each evaluated string, producing a character vector with one element for each evaluated string. It returns <code>NA</code> where there was no match. The <code>NA</code>s can be removed by wrapping the returned vector with <code><a href="https://rdrr.io/r/stats/na.fail.html">na.exclude()</a></code>. Note how the second of occupation 3’s matches is not shown.</p>
<div class="sourceCode" id="cb689"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_extract</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach|prof|tutor"</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] NA      "prof"  "teach" "tutor" NA      NA      NA      NA      NA      NA</code></pre>
<!-- ======================================================= -->
</div>
<div id="subset-and-count" class="section level3 unnumbered">
<h3>Subset and count<a class="anchor" aria-label="anchor" href="#subset-and-count"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Subset, Count</strong></p>
<p>Aligned functions include <code>str_subset()</code> and <code>str_count()</code>.</p>
<p><code>str_subset()</code> returns the actual values which contained the pattern:</p>
<div class="sourceCode" id="cb691"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_subset</span><span class="op">(</span><span class="va">occupations</span>, <span class="st">"teach|prof|tutor"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "university professor"           "primary school teacher &amp; tutor" "tutor"</code></pre>
<p>`str_count() returns a vector of numbers: the <strong>number of times</strong> a search term appears in each evaluated value.</p>
<div class="sourceCode" id="cb693"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_count</span><span class="op">(</span><span class="va">occupations</span>, <span class="fu"><a href="https://rdrr.io/r/base/regex.html">regex</a></span><span class="op">(</span><span class="st">"teach|prof|tutor"</span>, ignore_case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] 0 1 2 1 0 0 0 0 0 0</code></pre>
<!-- ======================================================= -->
</div>
<div id="regex-groups" class="section level3 unnumbered">
<h3>Regex groups<a class="anchor" aria-label="anchor" href="#regex-groups"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Groups within strings</strong></p>
<p><code>str_match()</code> TBD</p>
<!-- ======================================================= -->
</div>
</div>
<div id="regex-and-special-characters" class="section level2" number="14.6">
<h2>
<span class="header-section-number">14.6</span> Regex and special characters<a class="anchor" aria-label="anchor" href="#regex-and-special-characters"><i class="fas fa-link"></i></a>
</h2>
<p>Regular expressions, or “regex”, is a concise language for describing patterns in strings.</p>
<p><em>Much of this section is adapted from <a href="https://towardsdatascience.com/a-gentle-introduction-to-regular-expressions-with-r-df5e897ca432">this tutorial</a> and <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf">this cheatsheet</a></em></p>
<!-- ======================================================= -->
<div id="special-characters" class="section level3 unnumbered">
<h3>Special characters<a class="anchor" aria-label="anchor" href="#special-characters"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Backslash <code>\</code> as escape</strong></p>
<p>The backslash <code>\</code> is used to “escape” the meaning of the next character. This way, a backslash can be used to have a quote mark display <em>within</em> other quote marks (<code>\"</code>) - the middle quote mark will not “break” the surrounding quote marks.</p>
<p>Note - thus, if you want to <em>display</em> a backslash, you must escape it’s meaning with *another backslash. So you must write two backslashes <code>\\</code> to display one.</p>
<p><strong>Special characters</strong></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Special character</th>
<th>Represents</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"\\"</code></td>
<td>backslash</td>
</tr>
<tr class="even">
<td><code>"\n"</code></td>
<td>a new line (newline)</td>
</tr>
<tr class="odd">
<td><code>"\""</code></td>
<td>double-quote <em>within</em> double quotes</td>
</tr>
<tr class="even">
<td><code>'\''</code></td>
<td>single-quote <em>within</em> single quotes</td>
</tr>
<tr class="odd">
<td>
<code>"\</code>“<code>| grave accent</code>”<code>| carriage return</code>“<code>| tab</code>”<code>| vertical tab</code>"`</td>
<td>backspace</td>
</tr>
</tbody>
</table></div>
<p>Run <code><a href="https://rdrr.io/r/base/Quotes.html">?"'"</a></code> in the R Console to display a complete list of these special characters (it will appear in the RStudio Help pane).</p>
<!-- ======================================================= -->
</div>
<div id="regular-expressions-regex" class="section level3 unnumbered">
<h3>Regular expressions (regex)<a class="anchor" aria-label="anchor" href="#regular-expressions-regex"><i class="fas fa-link"></i></a>
</h3>
<p>If you are not familiar with it, a regular expression can look like an alien language:</p>
<p>A regular expression is applied to extract specific patterns from unstructured text - for example medical notes, chief complaint, matient history, or other free text columns in a dataset.</p>
<p>There are four basic tools one can use to create a basic regular expression:</p>
<ol style="list-style-type: decimal">
<li>Character sets<br>
</li>
<li>Meta characters<br>
</li>
<li>Quantifiers<br>
</li>
<li>Groups</li>
</ol>
<p><strong>Character sets</strong></p>
<p>Character sets, are a way of expressing listing options for a character match, within brackets. So any a match will be triggered if any of the characters within the brackets are found in the string. For example, to look for vowels one could use this character set: “[aeiou]”. Some other common character sets are:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Character set</th>
<th>Matches for</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"[A-Z]"</code></td>
<td>any single capital letter</td>
</tr>
<tr class="even">
<td><code>"[a-z]"</code></td>
<td>any single lowercase letter</td>
</tr>
<tr class="odd">
<td><code>"[0-9]"</code></td>
<td>any digit</td>
</tr>
<tr class="even">
<td><code>[:alnum:]</code></td>
<td>any alphanumeric character</td>
</tr>
<tr class="odd">
<td><code>[:digit:]</code></td>
<td>any numeric digit</td>
</tr>
<tr class="even">
<td><code>[:alpha:]</code></td>
<td>any letter (upper or lowercase)</td>
</tr>
<tr class="odd">
<td><code>[:upper:]</code></td>
<td>any uppercase letter</td>
</tr>
<tr class="even">
<td><code>[:lower:]</code></td>
<td>any lowercase letter</td>
</tr>
</tbody>
</table></div>
<p>Character sets can be combined within one bracket (no spaces!), such as <code>"[A-Za-z]"</code> (any upper or lowercase letter), or another example <code>"[t-z0-5]"</code> (lowercase t through z OR number 0 through 5).</p>
<p><strong>Meta characters</strong></p>
<p>Meta characters are shorthand for character sets. Some of the important ones are listed below:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Meta character</th>
<th>Represents</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"\\s"</code></td>
<td>a single space</td>
</tr>
<tr class="even">
<td><code>"\\w"</code></td>
<td>any single alphanumeric character (A-Z, a-z, or 0-9)</td>
</tr>
<tr class="odd">
<td><code>"\\d"</code></td>
<td>any single numeric digit (0-9)</td>
</tr>
</tbody>
</table></div>
<p><strong>Quantifiers</strong></p>
<p>Typically you do not want to search for a match on only one character. Quantifiers allow you to designate the length of letters/numbers to allow for the match.</p>
<p>Quantifiers are numbers written within curly brackets <code>{ }</code> <em>after</em> the character they are quantifying, for example,</p>
<ul>
<li>
<code>"A{2}"</code> will return instances of <strong>two</strong> capital A letters.<br>
</li>
<li>
<code>"A{2,4}"</code> will return instances of <strong>between two and four</strong> capital A letters <em>(do not put spaces!)</em>.<br>
</li>
<li>
<code>"A{2,}"</code> will return instances of <strong>two or more</strong> capital A letters.<br>
</li>
<li>
<code>"A+"</code> will return instances of <strong>one or more</strong> capital A letters (group extended until a different character is encountered).<br>
</li>
<li>Precede with an <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> asterisk to return <strong>zero or more</strong> matches (useful if you are not sure the pattern is present)</li>
</ul>
<p>Using the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> plus symbol as a quantifier, the match will occur until a different character is encountered. For example, this expression will return all <em>words</em> (alpha characters: <code>"[A-Za-z]+"</code></p>
<div class="sourceCode" id="cb695"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># test string for quantifiers</span>
<span class="va">test</span> <span class="op">&lt;-</span> <span class="st">"A-AA-AAA-AAAA"</span></code></pre></div>
<p>When a quantifier of {2} is used, only pairs of consecutive A’s are returned. Two pairs are identified within <code>AAAA</code>.</p>
<div class="sourceCode" id="cb696"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">test</span>, <span class="st">"A{2}"</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
## [1] "AA" "AA" "AA" "AA"</code></pre>
<p>When a quantifier of {2,4} is used, groups of consecutive A’s that are two to four in length are returned.</p>
<div class="sourceCode" id="cb698"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">test</span>, <span class="st">"A{2,4}"</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
## [1] "AA"   "AAA"  "AAAA"</code></pre>
<p>With the quantifier <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>, groups of <strong>one or more</strong> are returned:</p>
<div class="sourceCode" id="cb700"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">test</span>, <span class="st">"A+"</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
## [1] "A"    "AA"   "AAA"  "AAAA"</code></pre>
<p><strong>Relative position</strong></p>
<p>These express requirements for what precedes or follows a pattern. For example, to extract sentences, “two numbers that are followed by a period” (<code>""</code>). (?&lt;=\.)\s(?=[A-Z])</p>
<div class="sourceCode" id="cb702"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">test</span>, <span class="st">""</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] "A" "-" "A" "A" "-" "A" "A" "A" "-" "A" "A" "A" "A"</code></pre>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Position statement</th>
<th>Matches to</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"(?&lt;=b)a"</code></td>
<td>“a” that <strong>is preceded</strong> by a “b”</td>
</tr>
<tr class="even">
<td><code>"(?&lt;!b)a"</code></td>
<td>“a” that <strong>is NOT preceded</strong> by a “b”</td>
</tr>
<tr class="odd">
<td><code>"a(?=b)"</code></td>
<td>“a” that <strong>is followed</strong> by a “b”</td>
</tr>
<tr class="even">
<td><code>"a(?!b)"</code></td>
<td>“a” that <strong>is NOT followed</strong> by a “b”</td>
</tr>
</tbody>
</table></div>
<p><strong>Groups</strong></p>
<p>Capturing groups in your regular expression is a way to have a more organized output upon extraction.</p>
<p><strong>Regex examples</strong></p>
<p>Below is a free text for the examples. We will try to extract useful information from it using a regular expression search term.</p>
<div class="sourceCode" id="cb704"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pt_note</span> <span class="op">&lt;-</span> <span class="st">"Patient arrived at Broward Hospital emergency ward at 18:00 on 6/12/2005. Patient presented with radiating abdominal pain from LR quadrant. Patient skin was pale, cool, and clammy. Patient temperature was 99.8 degrees farinheit. Patient pulse rate was 100 bpm and thready. Respiratory rate was 29 per minute."</span></code></pre></div>
<p>This expression matches to all words (any character until hitting non-character such as a space):</p>
<div class="sourceCode" id="cb705"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">pt_note</span>, <span class="st">"[A-Za-z]+"</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] "Patient"     "arrived"     "at"          "Broward"     "Hospital"    "emergency"   "ward"        "at"         
##  [9] "on"          "Patient"     "presented"   "with"        "radiating"   "abdominal"   "pain"        "from"       
## [17] "LR"          "quadrant"    "Patient"     "skin"        "was"         "pale"        "cool"        "and"        
## [25] "clammy"      "Patient"     "temperature" "was"         "degrees"     "farinheit"   "Patient"     "pulse"      
## [33] "rate"        "was"         "bpm"         "and"         "thready"     "Respiratory" "rate"        "was"        
## [41] "per"         "minute"</code></pre>
<p>The expression <code>"[0-9]{1,2}"</code> matches to consecutive numbers that are 1 or 2 digits in length. It could also be written <code>"\\d{1,2}"</code>, or <code>"[:digit:]{1,2}"</code>.</p>
<div class="sourceCode" id="cb707"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">pt_note</span>, <span class="st">"[0-9]{1,2}"</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] "18" "00" "6"  "12" "20" "05" "99" "8"  "10" "0"  "29"</code></pre>
<div class="sourceCode" id="cb709"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_split</span><span class="op">(</span><span class="va">pt_note</span>, <span class="st">"."</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
##   [1] "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
##  [39] "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
##  [77] "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
## [115] "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
## [153] "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
## [191] "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
## [229] "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
## [267] "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" "" ""
## [305] "" "" "" "" ""</code></pre>
<p>This expression will extract all sentences (assuming first letter is capitalized, and the sentence ends with a period). The pattern reads in English as: "A capital letter followed by some lowercase letters, a space, some letters, a space,</p>
<div class="sourceCode" id="cb711"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">str_extract_all</span><span class="op">(</span><span class="va">pt_note</span>, <span class="st">"[A-Z][a-z]+\\s\\w+\\s\\d{1,2}\\s\\w+\\s*\\w*"</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
## character(0)</code></pre>
<p>You can view a useful list of regex expressions and tips on page 2 of <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf">this cheatsheet</a></p>
<p>Also see this <a href="https://towardsdatascience.com/a-gentle-introduction-to-regular-expressions-with-r-df5e897ca432">tutorial</a>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="resources-7" class="section level2" number="14.7">
<h2>
<span class="header-section-number">14.7</span> Resources<a class="anchor" aria-label="anchor" href="#resources-7"><i class="fas fa-link"></i></a>
</h2>
<p>A reference sheet for <strong>stringr</strong> functions can be found <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf">here</a></p>
<p>A vignette on <strong>stringr</strong> can be found <a href="https://cran.r-project.org/web/packages/stringr/vignettes/stringr.html">here</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="joining-data.html"><span class="header-section-number">13</span> Joining data</a></div>
<div class="next"><a href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#characters-and-strings"><span class="header-section-number">14</span> Characters and strings</a></li>
<li><a class="nav-link" href="#preparation-5"><span class="header-section-number">14.1</span> Preparation</a></li>
<li>
<a class="nav-link" href="#unite-split-and-arrange"><span class="header-section-number">14.2</span> Unite, split, and arrange</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#combine-strings">Combine strings</a></li>
<li><a class="nav-link" href="#dynamic-strings">Dynamic strings</a></li>
<li><a class="nav-link" href="#unite-columns">Unite columns</a></li>
<li><a class="nav-link" href="#split">Split</a></li>
<li><a class="nav-link" href="#split-columns">Split columns</a></li>
<li><a class="nav-link" href="#arrange">Arrange</a></li>
<li><a class="nav-link" href="#base-r-functions">base R functions</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#clean-and-standardise"><span class="header-section-number">14.3</span> Clean and standardise</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#change-case"><span class="header-section-number">14.3.1</span> Change case</a></li>
<li><a class="nav-link" href="#pad-length">Pad length</a></li>
<li><a class="nav-link" href="#truncate">Truncate</a></li>
<li><a class="nav-link" href="#standardize-length">Standardize length</a></li>
<li><a class="nav-link" href="#remove-leadingtrailing-whitespace">Remove leading/trailing whitespace</a></li>
<li><a class="nav-link" href="#remove-repeated-whitespace-within">Remove repeated whitespace within</a></li>
<li><a class="nav-link" href="#wrap-into-paragraphs">Wrap into paragraphs</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#handle-by-position"><span class="header-section-number">14.4</span> Handle by position</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#extract-by-character-position">Extract by character position</a></li>
<li><a class="nav-link" href="#extract-by-word-position">Extract by word position</a></li>
<li><a class="nav-link" href="#replace-by-character-position">Replace by character position</a></li>
<li><a class="nav-link" href="#evaluate-length">Evaluate length</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#patterns"><span class="header-section-number">14.5</span> Patterns</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#detect-a-pattern">Detect a pattern</a></li>
<li><a class="nav-link" href="#replace-all">Replace all</a></li>
<li><a class="nav-link" href="#detect-within-logic">Detect within logic</a></li>
<li><a class="nav-link" href="#locate-pattern-position">Locate pattern position</a></li>
<li><a class="nav-link" href="#extract-a-match">Extract a match</a></li>
<li><a class="nav-link" href="#subset-and-count">Subset and count</a></li>
<li><a class="nav-link" href="#regex-groups">Regex groups</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#regex-and-special-characters"><span class="header-section-number">14.6</span> Regex and special characters</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#special-characters">Special characters</a></li>
<li><a class="nav-link" href="#regular-expressions-regex">Regular expressions (regex)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#resources-7"><span class="header-section-number">14.7</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2021-04-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
