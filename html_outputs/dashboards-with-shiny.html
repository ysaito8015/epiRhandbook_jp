<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>44 Dashboards with Shiny | The Epidemiologist R Handbook</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.15/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">About this book</li>
<li><a class="" href="editorial-and-technical-notes.html"><span class="header-section-number">1</span> Editorial and technical notes</a></li>
<li><a class="" href="download-handbook-and-data.html"><span class="header-section-number">2</span> Download handbook and data</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> R Basics</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transition to R</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">5</span> Suggested packages</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">7</span> Import and export</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Cleaning data and core functions</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with dates</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">10</span> Factors</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">11</span> Pivoting data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">12</span> Grouping data</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">13</span> Joining data</a></li>
<li><a class="" href="characters-and-strings.html"><span class="header-section-number">14</span> Characters and strings</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></li>
<li><a class="" href="iteration-loops-and-lists.html"><span class="header-section-number">16</span> Iteration, loops, and lists</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="descriptive-tables.html"><span class="header-section-number">17</span> Descriptive tables</a></li>
<li><a class="" href="simple-statistical-tests.html"><span class="header-section-number">18</span> Simple statistical tests</a></li>
<li><a class="" href="univariate-and-multivariable-regression.html"><span class="header-section-number">19</span> Univariate and multivariable regression</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Missing data</a></li>
<li><a class="" href="standardization-1.html"><span class="header-section-number">21</span> Standardization</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">22</span> Moving averages</a></li>
<li><a class="" href="time-series-and-outbreak-detection-1.html"><span class="header-section-number">23</span> Time series and outbreak detection</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">24</span> Epidemic modeling</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">25</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">26</span> Survival analysis</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">27</span> GIS basics</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="tables-for-presentation.html"><span class="header-section-number">28</span> Tables for presentation</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">29</span> ggplot basics</a></li>
<li><a class="" href="plot-continuous-data.html"><span class="header-section-number">30</span> Plot continuous data</a></li>
<li><a class="" href="plot-categorical-data.html"><span class="header-section-number">31</span> Plot categorical data</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">32</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">33</span> Epidemic curves</a></li>
<li><a class="" href="demographic-pyramids-and-likert-scales.html"><span class="header-section-number">34</span> Demographic pyramids and Likert-scales</a></li>
<li><a class="" href="diagrams-and-charts.html"><span class="header-section-number">35</span> Diagrams and charts</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">36</span> Combinations analysis</a></li>
<li><a class="" href="heat-tiles.html"><span class="header-section-number">37</span> Heat tiles</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">38</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees-1.html"><span class="header-section-number">39</span> Phylogenetic trees</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">40</span> Interactive plots</a></li>
<li class="book-part">Reports and dashboards</li>
<li><a class="" href="r-markdown-reports.html"><span class="header-section-number">41</span> R Markdown reports</a></li>
<li><a class="" href="organizing-routine-reports.html"><span class="header-section-number">42</span> Organizing routine reports</a></li>
<li><a class="" href="dashboards-with-r-markdown.html"><span class="header-section-number">43</span> Dashboards with R Markdown</a></li>
<li><a class="active" href="dashboards-with-shiny.html"><span class="header-section-number">44</span> Dashboards with Shiny</a></li>
<li class="book-part">Miscellaneous</li>
<li><a class="" href="writing-functions-1.html"><span class="header-section-number">45</span> Writing functions</a></li>
<li><a class="" href="version-control-and-collaboration-with-github.html"><span class="header-section-number">46</span> Version control and collaboration with Github</a></li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">47</span> Directory interactions</a></li>
<li><a class="" href="errors-help.html"><span class="header-section-number">48</span> Errors &amp; help</a></li>
<li><a class="" href="relational-databases.html"><span class="header-section-number">49</span> Relational databases</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">50</span> R on network drives</a></li>
<li><a class="" href="advanced-rstudio.html"><span class="header-section-number">51</span> Advanced RStudio</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="dashboards-with-shiny" class="section level1" number="44">
<h1>
<span class="header-section-number">44</span> Dashboards with Shiny<a class="anchor" aria-label="anchor" href="#dashboards-with-shiny"><i class="fas fa-link"></i></a>
</h1>
<p>THIS PAGE IS UNDER CONSTRUCTION</p>
<p>One of the largest drawbacks of <code>R</code> is its usability for people who are new to or have no experience with programming languages. While these skills are very valuable, most people will find that this represents a barrier to sharing analyses, especially in multidisciplinary environments. It requires some work to maintain an <code>R</code> installation, and not everyone will be comfortable running shared code, even if it’s well documented and easy to read. This is <em>especially</em> true when users have to change parameters of code! For this reason dashboards are often a great way to share results from analyses with others without having to interface with code itself.</p>
<p>R based dashboards are also advantageous in that they centralise how code is run - when the same code is run on different machines, often people will have to deal with differing file paths, different R versions, and different package installations. For this reason, dashboards are a great way to share code with others in a user friendly way!</p>
<p>Despite this, making dashboards in <code>R</code> requires a relatively advanced knowledge of the language. For this reason, it is recommended that someone learning dashboards has good knowledge of data transformation and visualisation, and is comfortable debugging code, and writing functions. Working with dashboards is not intuitive when you’re starting, and is difficult to understand at times, but is a great skill to learn and gets much easier with practice!</p>
<p>This section will give a short overview of how you can use <code>R</code> to make dashboards, primarily by using the excellent <code>shiny</code> package, and its extensions.</p>
<!-- ======================================================= -->
<div id="the-structure-of-a-shiny-app" class="section level2" number="44.1">
<h2>
<span class="header-section-number">44.1</span> The structure of a shiny app<a class="anchor" aria-label="anchor" href="#the-structure-of-a-shiny-app"><i class="fas fa-link"></i></a>
</h2>
<div id="basic-file-structures" class="section level3" number="44.1.1">
<h3>
<span class="header-section-number">44.1.1</span> Basic file structures<a class="anchor" aria-label="anchor" href="#basic-file-structures"><i class="fas fa-link"></i></a>
</h3>
<p>To understand <code>shiny</code>, we first need to understand the file structure of an app works! We should make a brand new directory before we start. This can actually be made easier by choosing <em>New project</em> in <em>Rstudio</em>, and choosing <em>Shiny Web Application</em>. This will create the basic structure of a shiny app for you.</p>
<p>Lets also install shiny before we go any further:</p>
<div class="sourceCode" id="cb1681"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"shiny"</span><span class="op">)</span></code></pre></div>
<p>When opening this project, you’ll notice there is a <code>.R</code> file already present called <em>app.R</em>. It is <em>essential</em> that we either have one of two basic file structures in our file structure:</p>
<ol style="list-style-type: decimal">
<li>A file called <em>app.R</em>
</li>
<li>Two files called <em>ui.R</em> and <em>server.R</em>
</li>
</ol>
<div class="sourceCode" id="cb1682"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># an example of app.R</span>

<span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">fluidPage</span><span class="op">(</span>

    <span class="co"># Application title</span>
    <span class="fu">titlePanel</span><span class="op">(</span><span class="st">"My app"</span><span class="op">)</span>,

    <span class="co"># Sidebar with a slider input widget</span>
    <span class="fu">sidebarLayout</span><span class="op">(</span>
        <span class="fu">sidebarPanel</span><span class="op">(</span>
            <span class="fu">sliderInput</span><span class="op">(</span><span class="st">"input_1"</span><span class="op">)</span>
        <span class="op">)</span>,

        <span class="co"># Show a plot </span>
        <span class="fu">mainPanel</span><span class="op">(</span>
           <span class="fu">plotOutput</span><span class="op">(</span><span class="st">"my_plot"</span><span class="op">)</span>
        <span class="op">)</span>
    <span class="op">)</span>
<span class="op">)</span>

<span class="co"># Define server logic required to draw a histogram</span>
<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span>
     
     <span class="va">plot_1</span> <span class="op">&lt;-</span> <span class="fu">reactive</span><span class="op">(</span><span class="op">{</span>
          <span class="fu">plot_func</span><span class="op">(</span>param <span class="op">=</span> <span class="va">input_1</span><span class="op">)</span>
     <span class="op">}</span><span class="op">)</span>
     
    <span class="va">output</span><span class="op">$</span><span class="va">my_plot</span> <span class="op">&lt;-</span> <span class="fu">renderPlot</span><span class="op">(</span><span class="op">{</span>
       <span class="fu">plot_1</span><span class="op">(</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>


<span class="co"># Run the application </span>
<span class="fu">shinyApp</span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>If you open this file, you’ll notice that two different objects are defined one called <code>ui</code> and another called <code>server</code>. These objects <em>must</em> be defined in <em>every</em> shiny app and are central to the structure of the app itself! The only difference between the two structures above is that in structure 1, both <code>ui</code> and <code>server</code> are defined in one file, while they are defined in separate files in structure 2. We can also (and we should if we have a larger app) have other .R files in our structure that we can <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> into our app, but we need these core files at all times.</p>
</div>
<div id="the-server-and-the-ui" class="section level3" number="44.1.2">
<h3>
<span class="header-section-number">44.1.2</span> The server and the ui<a class="anchor" aria-label="anchor" href="#the-server-and-the-ui"><i class="fas fa-link"></i></a>
</h3>
<p>We next need to understand what the server and ui objects actually <em>do</em>. Put simply, these are two objects that are interacting with each other whenever the user interacts with the shiny app.</p>
<p>The UI element of a shiny app is, on a basic level, R code that creates an HTML interface. This means that everything that is <em>displayed</em> in the UI of an app. This largely includes:</p>
<ul>
<li>“Widgets” - dropdown menus, check boxes, sliders, etc that can be interacted with by the user</li>
<li>Plots, tables, etc - outputs that are generated with R code</li>
<li>Navigation aspects of an app - tabs, panes, etc.</li>
<li>Generic text, hyperlinks, etc</li>
<li>HTML and CSS elements (addressed later)</li>
</ul>
<p>The most important thing to understand about the UI is that it <em>receives inputs</em> from the user and <em>displays outputs</em> from the server. There is no <em>active</em> code running in the ui <em>at any time</em> - all changes seen in the UI are passed through the server (more or less). So we have to make our plots, downloads, etc in the server</p>
<p>The server of the shiny app is where all code is being run once the app starts up. The way this works is a little confusing. The server function will effectively <em>react</em> to the user interfacing with the UI, and run chunks of code in response. If things change in the server, these will be passed back up to the ui, where the changes can be seen. Importantly, the code in the server will be executed <em>non-consecutively</em> (or it’s best to think of it this way). Basically, whenever a ui input affects a chunk of code in the server, it will run automatically, and the output will be produced.</p>
<p>This all probably sounds very abstract for now, so we’ll have to dive into some examples to get a clear idea of how this actually works.</p>
</div>
<div id="before-you-start-to-build-an-app" class="section level3" number="44.1.3">
<h3>
<span class="header-section-number">44.1.3</span> Before you start to build an app<a class="anchor" aria-label="anchor" href="#before-you-start-to-build-an-app"><i class="fas fa-link"></i></a>
</h3>
<p>Before you begin to build an app, its immensely helpful to know <em>what</em> you want to build. Since your UI will be written in code, you can’t really visualise what you’re building unless you are aiming for something specific. For this reason, it is immensely helpful to look at lots of examples of shiny apps to get an idea of what you can make - even better if you can look at the source code behind these apps! Some great resources for this are:</p>
<ul>
<li><a href="https://shiny.rstudio.com/gallery/">Rstudio app gallery</a></li>
<li>
</ul>
<p>Once you get an idea for what is possible, it’s also helpful to map out what you want yours to look like - you can do this in any drawing software (PowerPoint, MS paint, etc.). It’s helpful to start simple for your first app! There’s also no shame in using code you find online of a nice app as a template for your work - its much easier than building something from scratch!</p>
</div>
</div>
<div id="building-a-ui" class="section level2" number="44.2">
<h2>
<span class="header-section-number">44.2</span> Building a UI<a class="anchor" aria-label="anchor" href="#building-a-ui"><i class="fas fa-link"></i></a>
</h2>
<p>When building our app, its easier to work on the UI first so we can see what we’re making, and not risk the app failing because of any server errors. As mentioned previously, its often good to use a template when working on the UI. There are a number of standard layouts that can be used with shiny that are available from the base shiny package, but it’s worth noting that there are also a number of package extensions such as <code>shinydashboard</code>. We’ll use an example from base shiny to start with.</p>
<p>A shiny UI is generally defined as a series of nested functions, in the following order</p>
<ol style="list-style-type: decimal">
<li>A function defining the general layout (the most basic is <code>fluidPage()</code>, but more are available)</li>
<li>Panels within the layout such as:
<ul>
<li>a sidebar (<code>sidebarPanel()</code>)</li>
<li>a “main” panel (<code>mainPanel()</code>)</li>
<li>a tab (<code>tabPanel()</code>)</li>
<li>a generic “column” (<code>column()</code>)</li>
</ul>
</li>
<li>Widgets and outputs - these can confer inputs to the server (widgets) or outputs from the server (outputs)
<ul>
<li>Widgets generally are styled as <code>xxxInput()</code> e.g. <code>selectInput()</code>
</li>
<li>Outputs are generally styled as <code>xxxOutput()</code> e.g. <code>plotOutput()</code>
</li>
</ul>
</li>
</ol>
<p>It’s worth stating again that these can’t be visualised easily in an abstract way, so it’s best to look at an example! Lets consider making a basic app that visualises our malaria facility count data by district. This data has a lot of differnet parameters, so it would be great if the end user could apply some filters to see the data by age group/district as they see fit! We can use a very simple shiny layout to start - the sidebar layout. This is a layout where widgets are placed in a sidebar on the left, and the plot is placed on the right.</p>
<p>Lets plan our app - we can start with a selector that lets us choose the district where we want to visualise data, and another to let us visualise the age group we are interested in. We’ll aim to use these filters to show an epicurve that reflects these parameters. So for this we need:</p>
<ol style="list-style-type: decimal">
<li>Two dropdown menus that let us choose the district we want, and the age group we’re interested in.</li>
<li>An area where we can show our resulting epicurve.</li>
</ol>
<p>This might look something like this:</p>
<div class="sourceCode" id="cb1683"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">fluidPage</span><span class="op">(</span>

  <span class="fu">titlePanel</span><span class="op">(</span><span class="st">"Malaria facility visualisation app"</span><span class="op">)</span>,

  <span class="fu">sidebarLayout</span><span class="op">(</span>

    <span class="fu">sidebarPanel</span><span class="op">(</span>
         <span class="co"># selector for district</span>
         <span class="fu">selectInput</span><span class="op">(</span>
              inputId <span class="op">=</span> <span class="st">"select_district"</span>,
              label <span class="op">=</span> <span class="st">"Select district"</span>,
              choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                   <span class="st">"All"</span>,
                   <span class="st">"Spring"</span>,
                   <span class="st">"Bolo"</span>,
                   <span class="st">"Dingo"</span>,
                   <span class="st">"Barnard"</span>
              <span class="op">)</span>,
              selected <span class="op">=</span> <span class="st">"All"</span>,
              multiple <span class="op">=</span> <span class="cn">TRUE</span>
         <span class="op">)</span>,
         <span class="co"># selector for age group</span>
         <span class="fu">selectInput</span><span class="op">(</span>
              inputId <span class="op">=</span> <span class="st">"select_agegroup"</span>,
              label <span class="op">=</span> <span class="st">"Select age group"</span>,
              choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                   <span class="st">"All ages"</span> <span class="op">=</span> <span class="st">"malaria_tot"</span>,
                   <span class="st">"0-4 yrs"</span> <span class="op">=</span> <span class="st">"malaria_rdt_0-4"</span>,
                   <span class="st">"5-14 yrs"</span> <span class="op">=</span> <span class="st">"malaria_rdt_5-14"</span>,
                   <span class="st">"15+ yrs"</span> <span class="op">=</span> <span class="st">"malaria_rdt_15"</span>
              <span class="op">)</span>, 
              selected <span class="op">=</span> <span class="st">"All"</span>,
              multiple <span class="op">=</span> <span class="cn">FALSE</span>
         <span class="op">)</span>

    <span class="op">)</span>,

    <span class="fu">mainPanel</span><span class="op">(</span>
      <span class="co"># epicurve goes here</span>
      <span class="fu">plotOutput</span><span class="op">(</span><span class="st">"malaria_epicurve"</span><span class="op">)</span>
    <span class="op">)</span>
    
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>This layout looks something like this - note that there will be no plot if there is no server to render it, but our inputs are working!</p>
<p>This is a good opportunity to discuss how widgets work - note that each widget is accepting an <code>inputId</code>, a <code>label</code>, and a series of other options that are specific to the widget type. This <code>inputId</code> is extremely important - these are the IDs that are used to pass information from the UI to the server. For this reason, they <em>must be unique</em>. You should make an effort to name them something sensible, and specific to what they are interacting with in cases of larger apps.</p>
<p>You should read documentation carefully for full details on what each of these widgets do. Widgets will pass specific types of data to the server depending on the widget type, and this needs to be fully understood. For example, <code>selectInput()</code> will pass a character type to the server:</p>
<ul>
<li>If we select <em>Spring</em> for the first widget here, it will pass the character object <code>"Spring"</code> to the server.</li>
<li>If we select two items from the dropdown menu, they will come through as a vector (e.g. <code><a href="https://rdrr.io/r/base/c.html">c("Spring", "Bolo")</a></code>).</li>
</ul>
<p>Other widgets will pass different types of object to the server! For example:</p>
<ul>
<li>
<code>numericInput()</code> will pass a numeric type object to the server</li>
<li>
<code>checkboxInput()</code> will pass a logical type object to the server</li>
</ul>
<p>It’s also worth noting the named vector used for the age data here. For many widgets, using a named vector as the choices will display the names of the objects, but pass the contents of the vector to the server. I.e. here we can select <em>15+</em> and it will pass <code>"malaria_rdt_15"</code> to the server - which happens to be the name of the column we’re interested in!</p>
<p>There are loads of widgets that you can use to do lots of things with your app. Widgets also allow you to upload files into your app, and download outputs. There are also some excellent shiny extensions that give you access to more widgets than base shiny - <code>shinyWidgets</code> is a great example of this. To look at some examples you can look at the following links:</p>
<ul>
<li><a href="https://shiny.rstudio.com/gallery/widget-gallery.html">base shiny widget gallery</a></li>
<li><a href="https://github.com/dreamRs/shinyWidgets">shinyWidgets gallery</a></li>
</ul>
</div>
<div id="loading-data-into-our-app" class="section level2" number="44.3">
<h2>
<span class="header-section-number">44.3</span> Loading data into our app<a class="anchor" aria-label="anchor" href="#loading-data-into-our-app"><i class="fas fa-link"></i></a>
</h2>
<p>The next step in our development is getting a server up and running. To do this however, we need to get some data into our app, and figure out all the calculations we’re going to do. A shiny app is not straightforward to debug, as it’s often not clear where errors are coming from, so it’s ideal to get all our data processing and visualisation code working before we start making the server itself.</p>
<p>So given we want to make an app that shows epi curves that change based on user input, we should think about what code we would need to run this in a normal R script. We’ll need to:</p>
<ol style="list-style-type: decimal">
<li>Load our packages</li>
<li>Load our data</li>
<li>Transform our data</li>
<li>Develop a <em>function</em> to visualise our data based on user inputs</li>
</ol>
<p>This list is pretty straightforward, and shouldn’t be too hard to do. It’s now important to think about which parts of this process need to <em>be done only once</em> and which parts need to <em>run in response to user inputs</em>. This is because shiny apps generally run some code before running, which is only performed once. It will help our app’s performance if as much of our code can be moved to this section. For this example, we only need to load our data/packages and do basic transformations once, so we can put that code <em>outside the server</em>. This means the only thing we’ll need in the server is the code to visualise our data. Lets develop all of these componenets in a script first. However, since we’re visualising our data with a function, we can also put the code <em>for the function</em> outside the server so our function is in the environment when the app runs!</p>
<p>First lets load our data. Since we’re working with a new project, and we want to make it clean, we can create a new directory called data, and add our malaria data in there. We can run this code below in a testing script we will eventually delete when we clean up the structure of our app.</p>
<div class="sourceCode" id="cb1684"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="st">"tidyverse"</span>, <span class="st">"lubridate"</span><span class="op">)</span>

<span class="co"># read data</span>
<span class="va">malaria_data</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"malaria_facility_count_data.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">malaria_data</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3,038 x 10
##    location_name data_date  submitted_date Province District `malaria_rdt_0-4` `malaria_rdt_5-14` malaria_rdt_15
##    &lt;chr&gt;         &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;    &lt;chr&gt;                &lt;int&gt;              &lt;int&gt;          &lt;int&gt;
##  1 Facility 1    2019-06-13 2019-06-14     North    Spring                  11                 12             23
##  2 Facility 2    2019-06-13 2019-06-14     North    Bolo                    11                 10              5
##  3 Facility 3    2019-06-13 2019-06-14     North    Dingo                    8                  5              5
##  4 Facility 4    2019-06-13 2019-06-14     North    Bolo                    16                 16             17
##  5 Facility 5    2019-06-13 2019-06-14     North    Bolo                     9                  2              6
##  6 Facility 6    2019-06-13 2019-06-14     North    Dingo                    3                  1              4
##  7 Facility 6    2019-06-12 2019-06-14     North    Dingo                    4                  0              3
##  8 Facility 5    2019-06-12 2019-06-14     North    Bolo                    15                 14             13
##  9 Facility 5    2019-06-11 2019-06-14     North    Bolo                    11                 11             13
## 10 Facility 5    2019-06-10 2019-06-14     North    Bolo                    19                 15             15
## # ... with 3,028 more rows, and 2 more variables: malaria_tot &lt;int&gt;, newid &lt;int&gt;</code></pre>
<p>It will be easier to work with this data if we use tidy data standards, so we should also transform into a longer data format, where age group is a column, and cases is another column. We can do this easily using what we’ve learned in the xxx section:</p>
<div class="sourceCode" id="cb1686"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">malaria_data</span> <span class="op">&lt;-</span> <span class="va">malaria_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">newid</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">starts_with</span><span class="op">(</span><span class="st">"malaria_"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"age_group"</span>, values_to <span class="op">=</span> <span class="st">"cases_reported"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">malaria_data</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 12,152 x 7
##    location_name data_date  submitted_date Province District age_group        cases_reported
##    &lt;chr&gt;         &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;                     &lt;int&gt;
##  1 Facility 1    2019-06-13 2019-06-14     North    Spring   malaria_rdt_0-4              11
##  2 Facility 1    2019-06-13 2019-06-14     North    Spring   malaria_rdt_5-14             12
##  3 Facility 1    2019-06-13 2019-06-14     North    Spring   malaria_rdt_15               23
##  4 Facility 1    2019-06-13 2019-06-14     North    Spring   malaria_tot                  46
##  5 Facility 2    2019-06-13 2019-06-14     North    Bolo     malaria_rdt_0-4              11
##  6 Facility 2    2019-06-13 2019-06-14     North    Bolo     malaria_rdt_5-14             10
##  7 Facility 2    2019-06-13 2019-06-14     North    Bolo     malaria_rdt_15                5
##  8 Facility 2    2019-06-13 2019-06-14     North    Bolo     malaria_tot                  26
##  9 Facility 3    2019-06-13 2019-06-14     North    Dingo    malaria_rdt_0-4               8
## 10 Facility 3    2019-06-13 2019-06-14     North    Dingo    malaria_rdt_5-14              5
## # ... with 12,142 more rows</code></pre>
<p>And with that we’ve finished preparing our data! This crosses items 1, 2, and 3 off our list of things to develop for our “testing R script”. The last, and most difficult task will be building a function to produce an epicurve based on user defined parameters. As mentioned previously, it’s <em>highly recommended</em> that anyone learning shiny first look at the section on functional programming to understand how this works!</p>
<p>When defining out function, it might be hard to think about what parameters we want to include. For functional programming with shiny, every relevent parameter will generally have a widget associated with it, so thinking about this is usually quite easy! For example in our current app, we want to be able to filter by province, and have a widget for this, so we can add a province parameter to reflect this. We <em>don’t</em> have any app functionality to filter by facility (for now), so we don’t need to add this as a parameter. Lets start by making a function with three parameters:</p>
<ol style="list-style-type: decimal">
<li>The core dataset</li>
<li>The district of choice</li>
<li>The age group of choice</li>
</ol>
<div class="sourceCode" id="cb1688"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_epicurve</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">district</span> <span class="op">=</span> <span class="st">"All"</span>, <span class="va">agegroup</span> <span class="op">=</span> <span class="st">"malaria_tot"</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"All"</span> <span class="op">%in%</span> <span class="va">district</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">District</span> <span class="op">%in%</span> <span class="va">district</span><span class="op">)</span>
    
    <span class="va">plot_title_district</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"{paste0(district, collapse = "</span>,<span class="st">")} districts"</span><span class="op">)</span>
    
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    
    <span class="va">plot_title_district</span> <span class="op">&lt;-</span> <span class="st">"all districts"</span>
    
  <span class="op">}</span>
  
  <span class="co"># if no remaining data, return NULL</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">age_group</span> <span class="op">==</span> <span class="va">agegroup</span><span class="op">)</span>
  
  
  <span class="co"># if no remaining data, return NULL</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="va">agegroup</span> <span class="op">==</span> <span class="st">"malaria_tot"</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">agegroup_title</span> <span class="op">&lt;-</span> <span class="st">"All ages"</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">agegroup_title</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"{str_remove(agegroup, 'malaria_rdt')} years"</span><span class="op">)</span>
  <span class="op">}</span>
  
  
  <span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data_date</span>, y <span class="op">=</span> <span class="va">cases_reported</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>
      x <span class="op">=</span> <span class="st">"date"</span>,
      y <span class="op">=</span> <span class="st">"number of cases"</span>,
      title <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"Malaria cases - {plot_title_district}"</span><span class="op">)</span>,
      subtitle <span class="op">=</span> 
    <span class="op">)</span>
  
  
  
<span class="op">}</span></code></pre></div>
<p>We won’t go into great detail about this function, as it’s relatively simple in how it works. One thing to note however, is we handle errors by returning <code>NULL</code> when it would otherwise give an error. This is because when a shiny server produces a <code>NULL</code> object instead of a plot object, nothing will be shown in the ui! This is important, as otherwise errors will often cause your app to stop working.</p>
<p>Let’s test our function!</p>
<div class="sourceCode" id="cb1689"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_epicurve</span><span class="op">(</span><span class="va">malaria_data</span>, district <span class="op">=</span> <span class="st">"Bolo"</span>, agegroup <span class="op">=</span> <span class="st">"malaria_rdt_0-4"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-1291-1.png" width="672"></div>
<p>With our function working, we now have to understand how this all is going to fit into our shiny app. We mentioned the concept of <em>startup code</em> before, but lets look at how we can actually incorporate this into the structure of our app. There are two ways we can do this!</p>
<ol style="list-style-type: decimal">
<li>Put this code in your <em>app.R</em> file at the start of the script</li>
<li>Create a new file in your directory called <em>global.R</em>, and put the startup code in this file.</li>
</ol>
<p>It’s worth noting at this point that it’s generally easier, especially with bigger apps, to use the second file structure, as it lets you separate your file structure in a simple way. Lets fully develop a this global.R script now. Here is what it could look like:</p>
<div class="sourceCode" id="cb1690"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># global.R script</span>

<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="st">"tidyverse"</span>, <span class="st">"lubridate"</span>, <span class="st">"shiny"</span><span class="op">)</span>

<span class="co"># read data</span>
<span class="va">malaria_data</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"malaria_facility_count_data.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span>


<span class="va">malaria_data</span> <span class="op">&lt;-</span> <span class="va">malaria_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">newid</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">starts_with</span><span class="op">(</span><span class="st">"malaria_"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"age_group"</span>, values_to <span class="op">=</span> <span class="st">"cases_reported"</span><span class="op">)</span>



<span class="va">plot_epicurve</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">district</span> <span class="op">=</span> <span class="st">"All"</span>, <span class="va">agegroup</span> <span class="op">=</span> <span class="st">"malaria_tot"</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"All"</span> <span class="op">%in%</span> <span class="va">district</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">District</span> <span class="op">%in%</span> <span class="va">district</span><span class="op">)</span>
    
    <span class="va">plot_title_district</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"{paste0(district, collapse = "</span>,<span class="st">")} districts"</span><span class="op">)</span>
    
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    
    <span class="va">plot_title_district</span> <span class="op">&lt;-</span> <span class="st">"all districts"</span>
    
  <span class="op">}</span>
  
  <span class="co"># if no remaining data, return NULL</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">age_group</span> <span class="op">==</span> <span class="va">agegroup</span><span class="op">)</span>
  
  
  <span class="co"># if no remaining data, return NULL</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="va">agegroup</span> <span class="op">==</span> <span class="st">"malaria_tot"</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">agegroup_title</span> <span class="op">&lt;-</span> <span class="st">"All ages"</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">agegroup_title</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"{str_remove(agegroup, 'malaria_rdt')} years"</span><span class="op">)</span>
  <span class="op">}</span>
  
  
  <span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data_date</span>, y <span class="op">=</span> <span class="va">cases_reported</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>
      x <span class="op">=</span> <span class="st">"date"</span>,
      y <span class="op">=</span> <span class="st">"number of cases"</span>,
      title <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"Malaria cases - {plot_title_district}"</span><span class="op">)</span>,
      subtitle <span class="op">=</span> 
    <span class="op">)</span>
  
  
  
<span class="op">}</span></code></pre></div>
<p>Easy! One great feature of shiny is that it will understand what files named <em>app.R</em>, <em>server.R</em>, <em>ui.R</em>, and <em>global.R</em> are for, so there is no need to connect them to each other via any code. So just by having this code in <em>global.R</em> it will run before we start our app!. We should also note that it would improve our apps organisation if we moved this function to its own file - this will be especially helpful as apps become larger. To do this, we could make another directory called <em>funcs</em>, and put this function in as a file called <em>plot_epicurve.R</em>. We could then read this function in via the following command in <em>global.R</em></p>
<div class="sourceCode" id="cb1691"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"funcs"</span>, <span class="st">"plot_epicurve.R"</span><span class="op">)</span>, local <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Note that you should <em>always</em> specify <code>local = TRUE</code> in shiny apps, since it will affect sourcing when/if the app is published on a server.</p>
</div>
<div id="developing-an-app-server" class="section level2" number="44.4">
<h2>
<span class="header-section-number">44.4</span> Developing an app server<a class="anchor" aria-label="anchor" href="#developing-an-app-server"><i class="fas fa-link"></i></a>
</h2>
<p>Now that we have most of our code, we just have to develop our server. This is the final piece of our app, and is probably the hardest to understand. The server is a large R function, but its helpful to think of it as a series of smaller functions, or tasks that the app can perform. It’s important to understand that these functions are not executed in a linear order. There is an order to them, but it’s not fully necessary to understand when starting out with shiny. At a very basic level, these tasks or functions will activate when there is a change in user inputs that affects them, <em>unless the developer has set them up so they behave differently</em>. Again, this is all quite abstract, but lets first go through the three basic types of shiny <em>objects</em></p>
<ol style="list-style-type: decimal">
<li><p>Reactive sources - this is another term for user inputs. The shiny server has access to the outputs from the UI through the widgets we’ve programmed. Every time the values for these are changed, this is passed down to the server.</p></li>
<li><p>Reactive conductors - these are objects that exist <em>only</em> inside the shiny server. We don’t actually need these for simple apps, but they produce objects that can only be seen inside the server, and used in other operations. They generally depend on reactive sources.</p></li>
<li><p>Endpoints - these are outputs that are passed from the server to the UI. In our example, this would be the epi curve we are producing.</p></li>
</ol>
<p>With this in mind lets construct our server step by step. We’ll show our UI code again here just for reference:</p>
<div class="sourceCode" id="cb1692"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">fluidPage</span><span class="op">(</span>

  <span class="fu">titlePanel</span><span class="op">(</span><span class="st">"Malaria facility visualisation app"</span><span class="op">)</span>,

  <span class="fu">sidebarLayout</span><span class="op">(</span>

    <span class="fu">sidebarPanel</span><span class="op">(</span>
         <span class="co"># selector for district</span>
         <span class="fu">selectInput</span><span class="op">(</span>
              inputId <span class="op">=</span> <span class="st">"select_district"</span>,
              label <span class="op">=</span> <span class="st">"Select district"</span>,
              choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                   <span class="st">"All"</span>,
                   <span class="st">"Spring"</span>,
                   <span class="st">"Bolo"</span>,
                   <span class="st">"Dingo"</span>,
                   <span class="st">"Barnard"</span>
              <span class="op">)</span>,
              selected <span class="op">=</span> <span class="st">"All"</span>,
              multiple <span class="op">=</span> <span class="cn">TRUE</span>
         <span class="op">)</span>,
         <span class="co"># selector for age group</span>
         <span class="fu">selectInput</span><span class="op">(</span>
              inputId <span class="op">=</span> <span class="st">"select_agegroup"</span>,
              label <span class="op">=</span> <span class="st">"Select age group"</span>,
              choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                   <span class="st">"All ages"</span> <span class="op">=</span> <span class="st">"malaria_tot"</span>,
                   <span class="st">"0-4 yrs"</span> <span class="op">=</span> <span class="st">"malaria_rdt_0-4"</span>,
                   <span class="st">"5-14 yrs"</span> <span class="op">=</span> <span class="st">"malaria_rdt_5-14"</span>,
                   <span class="st">"15+ yrs"</span> <span class="op">=</span> <span class="st">"malaria_rdt_15"</span>
              <span class="op">)</span>, 
              selected <span class="op">=</span> <span class="st">"All"</span>,
              multiple <span class="op">=</span> <span class="cn">FALSE</span>
         <span class="op">)</span>

    <span class="op">)</span>,

    <span class="fu">mainPanel</span><span class="op">(</span>
      <span class="co"># epicurve goes here</span>
      <span class="fu">plotOutput</span><span class="op">(</span><span class="st">"malaria_epicurve"</span><span class="op">)</span>
    <span class="op">)</span>
    
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>From this code UI we have:</p>
<ul>
<li>Two inputs:
<ul>
<li>District selector (with an inputId of <code>select_district</code>)</li>
<li>Age group selector (with an inputId of <code>select_agegroup</code>)</li>
</ul>
</li>
<li>One output:
<ul>
<li>The epicurve (with an outputId of <code>malaria_epicurve</code>)</li>
</ul>
</li>
</ul>
<p>As stated previously, these unique names we have assigned to our inputs and outputs are crucial. They <em>must be unique</em> and are used to pass information between the ui and server. In our server, we access our inputs via the syntax <code>input$input_name</code> and outputs and passed to the ui through the syntax <code>output$output_name</code> Lets have a look at an example, because again this is hard to understand otherwise!</p>
<div class="sourceCode" id="cb1693"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">malaria_epicurve</span> <span class="op">&lt;-</span> <span class="fu">renderPlot</span><span class="op">(</span>
    <span class="fu">plot_epicurve</span><span class="op">(</span><span class="va">malaria_data</span>, district <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_district</span>, agegroup <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_agegroup</span><span class="op">)</span>
  <span class="op">)</span>
  
<span class="op">}</span></code></pre></div>
<p>The server for a simple app like this is actually quite straightforward! You’ll notice that the server is a function with three parameters - <code>input</code>, <code>output</code>, and <code>session</code> - this isn’t that important to understand for now, but its important to stick to this setup! In our server we only have one task - this renders a plot based on our function we made earlier, and the inputs from the server. Notice how the names of the input and output objects correspond exactly to those in the ui.</p>
<p>To understand the basics of how the server reacts to user inputs, you should note that the output will know (through the underlying package) when inputs change, and rerun this function to create a plot every time they change. Note that we also use the <code>renderPlot()</code> function here - this is one of a family of class specific functions that pass those objects to an output. There are a number of functions that behave similar, but you need to ensure the function matches the class of object you’re passing to the ui! For example:</p>
<ul>
<li>
<code>renderText()</code> - send text to the ui</li>
<li>
<code>renderDataTable</code> - send an interactive table to the ui.</li>
</ul>
<p>Remember that these need to match the output function used in the ui - so <code>renderPlot()</code> is paired with <code>plotOutput()</code>, and <code>renderText()</code> is matched with <code>textOutput()</code>.</p>
<p>So we’ve finally made a functioning app! We can run this by pressing the Run App button on the top right of the script window in Rstudio. <em>ADD SOMETHING ON DOWNLOADING A ZIP FILE OF THE APP MAYBE?</em></p>
</div>
<div id="adding-more-functionality" class="section level2" number="44.5">
<h2>
<span class="header-section-number">44.5</span> Adding more functionality<a class="anchor" aria-label="anchor" href="#adding-more-functionality"><i class="fas fa-link"></i></a>
</h2>
<p>At this point we’ve finally got a running app, but we have very little functionality. We also haven’t really scratched the surface of what shiny can do, so there’s a lot more to learn about! Lets continue to build our existing app by adding some extra features. Some things that could be nice to add could be:</p>
<ol style="list-style-type: decimal">
<li>Some explanatory text</li>
<li>A download button for our plot - this would provide the user with a high quality version of the image that they’re generating in the app</li>
<li>A selector for specific facilities, and maybe one for dates as well</li>
<li>Another dashboard page - this could show summary statistics for the full scope of the data.</li>
</ol>
<p>This is a lot to add, but we can use it to learn about a bunch of different shiny featues on the way. There is so much to learn about shiny (it can get <em>very</em> advanced, but its hopefully the case that once users have a better idea of how to use it they can become more comfortable using external learning sources as well).</p>
<p>ADD IN SECTION ON ADDING TEXT p() etc.</p>
<p>Lets move on to the second of the three features. A download button is a fairly common thing to add to an app and is fairly easy to make. We need to add another Widget to our ui, and we need to add another output to our server to attach to it. We can also introduce <em>reactive conductors</em> in this example!</p>
<p>Lets update our ui first - this is easy as shiny comes with a widget called <code>downloadButton()</code> - lets give it an inputId and a label.</p>
<div class="sourceCode" id="cb1694"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">fluidPage</span><span class="op">(</span>

  <span class="fu">titlePanel</span><span class="op">(</span><span class="st">"Malaria facility visualisation app"</span><span class="op">)</span>,

  <span class="fu">sidebarLayout</span><span class="op">(</span>

    <span class="fu">sidebarPanel</span><span class="op">(</span>
         <span class="co"># selector for district</span>
         <span class="fu">selectInput</span><span class="op">(</span>
              inputId <span class="op">=</span> <span class="st">"select_district"</span>,
              label <span class="op">=</span> <span class="st">"Select district"</span>,
              choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                   <span class="st">"All"</span>,
                   <span class="st">"Spring"</span>,
                   <span class="st">"Bolo"</span>,
                   <span class="st">"Dingo"</span>,
                   <span class="st">"Barnard"</span>
              <span class="op">)</span>,
              selected <span class="op">=</span> <span class="st">"All"</span>,
              multiple <span class="op">=</span> <span class="cn">TRUE</span>
         <span class="op">)</span>,
         <span class="co"># selector for age group</span>
         <span class="fu">selectInput</span><span class="op">(</span>
              inputId <span class="op">=</span> <span class="st">"select_agegroup"</span>,
              label <span class="op">=</span> <span class="st">"Select age group"</span>,
              choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
                   <span class="st">"All ages"</span> <span class="op">=</span> <span class="st">"malaria_tot"</span>,
                   <span class="st">"0-4 yrs"</span> <span class="op">=</span> <span class="st">"malaria_rdt_0-4"</span>,
                   <span class="st">"5-14 yrs"</span> <span class="op">=</span> <span class="st">"malaria_rdt_5-14"</span>,
                   <span class="st">"15+ yrs"</span> <span class="op">=</span> <span class="st">"malaria_rdt_15"</span>
              <span class="op">)</span>, 
              selected <span class="op">=</span> <span class="st">"All"</span>,
              multiple <span class="op">=</span> <span class="cn">FALSE</span>
         <span class="op">)</span>,
         <span class="co"># horizontal line</span>
         <span class="fu">hr</span><span class="op">(</span><span class="op">)</span>,
         <span class="fu">downloadButton</span><span class="op">(</span>
           inputId <span class="op">=</span> <span class="st">"download_epicurve"</span>,
           label <span class="op">=</span> <span class="st">"Download plot"</span>
         <span class="op">)</span>

    <span class="op">)</span>,

    <span class="fu">mainPanel</span><span class="op">(</span>
      <span class="co"># epicurve goes here</span>
      <span class="fu">plotOutput</span><span class="op">(</span><span class="st">"malaria_epicurve"</span><span class="op">)</span>
    <span class="op">)</span>
    
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Note that we’ve also added in a <code>hr()</code> tag - this adds a horizontal line separating our control widgets from our download widgets. This is another one of the HTML tags that we discussed previously.</p>
<p>Now that we have our ui ready, we need to add the server component. Downloads are done in the server with the <code>downloadHandler()</code> function. Similar to our plot, we need to attach it to an output that has the same inputId as the download button. This function takes two arguments - <code>filename</code> and <code>content</code> - these are both functions. As you might be able to guess, <code>filename</code> is used to specify the name of the downloaded file, and <code>content</code> is used to specify what should be downloaded. <code>content</code> contain a function that you would use to save data locally - so if you were downloading a csv file you could use <code><a href="https://rdrr.io/pkg/rio/man/export.html">rio::export()</a></code>. Since we’re downloading a plot, we’ll use <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggplot2::ggsave()</a></code>. Lets look at how we would program this (we won’t add it to the server yet).</p>
<div class="sourceCode" id="cb1695"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">malaria_epicurve</span> <span class="op">&lt;-</span> <span class="fu">renderPlot</span><span class="op">(</span>
    <span class="fu">plot_epicurve</span><span class="op">(</span><span class="va">malaria_data</span>, district <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_district</span>, agegroup <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_agegroup</span><span class="op">)</span>
  <span class="op">)</span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">download_epicurve</span> <span class="op">&lt;-</span> <span class="fu">downloadHandler</span><span class="op">(</span>
    filename <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"malaria_epicurve_{input$select_district}.png"</span><span class="op">)</span>
    <span class="op">}</span>,
    
    content <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu">ggsave</span><span class="op">(</span><span class="va">file</span>, 
             <span class="fu">plot_epicurve</span><span class="op">(</span><span class="va">malaria_data</span>, district <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_district</span>, agegroup <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_agegroup</span><span class="op">)</span>,
             width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>
    <span class="op">}</span>
    
  <span class="op">)</span>
  
<span class="op">}</span></code></pre></div>
<p>Note that the <code>content</code> function always takes a <code>file</code> argument, which we put where the output file name is specified. You might also notice that we’re repeating code here - we are using our <code>plot_epicurve()</code> function twice in this server, once for the download and once for the image displayed in the app. While this wont massively affect performance, this means that the code to generate this plot will have to be run when the user changes the widgets specifying the district and age group, <em>and</em> again when you want to download the plot. In larger apps, suboptimal decisions like this one will slow things down more and more, so it’s good to learn how to make our app more efficient in this sense. What would make more sense is if we had a way to run the epicurve code when the districts/age groups are changes, <em>and let that be used by</em> the renderPlot() and downloadHandler() functions. This is where reactive conductors come in!</p>
<p>Reactive conductors are objects that are created in the shiny server in a <em>reactive</em> way, but are not outputted - they can just be used by other parts of the server. There are a number of different kinds of <em>reactive conductors</em>, but we’ll go through the basic two.</p>
<p>1.<code>reactive()</code> - this is the most basic reactive conductor - it will react whenever any inputs used inside of it change (so our district/age group widgets)
2. <code>eventReactive()</code>- this rective conductor works the same as <code>reactive()</code>, except that the user can specify which inputs cause it to rerun. This is useful if your reactive conductor takes a long time to process, but this will be explained more later.</p>
<p>Lets look at the two examples:</p>
<div class="sourceCode" id="cb1696"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">malaria_plot_r</span> <span class="op">&lt;-</span> <span class="fu">reactive</span><span class="op">(</span><span class="op">{</span>
  
  <span class="fu">plot_epicurve</span><span class="op">(</span><span class="va">malaria_data</span>, district <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_district</span>, agegroup <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_agegroup</span><span class="op">)</span>
  
<span class="op">}</span><span class="op">)</span>


<span class="co"># only runs when the district selector changes!</span>
<span class="va">malaria_plot_er</span> <span class="op">&lt;-</span> <span class="fu">eventReactive</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">select_district</span>, <span class="op">{</span>
  
  <span class="fu">plot_epicurve</span><span class="op">(</span><span class="va">malaria_data</span>, district <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_district</span>, agegroup <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_agegroup</span><span class="op">)</span>
  
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>When we use the <code>eventReactive()</code> setup, we can specify which inputs cause this chunk of code to run - this isn’t very useful to us at the moment, so we can leave it for now. Note that you can include multiple inputs with <code><a href="https://rdrr.io/r/base/c.html">c()</a></code></p>
<p>Lets look at how we can integrate this into our server code:</p>
<div class="sourceCode" id="cb1697"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">malaria_plot</span> <span class="op">&lt;-</span> <span class="fu">reactive</span><span class="op">(</span><span class="op">{</span>
    <span class="fu">plot_epicurve</span><span class="op">(</span><span class="va">malaria_data</span>, district <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_district</span>, agegroup <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">select_agegroup</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
  
  
  
  <span class="va">output</span><span class="op">$</span><span class="va">malaria_epicurve</span> <span class="op">&lt;-</span> <span class="fu">renderPlot</span><span class="op">(</span>
    <span class="fu">malaria_plot</span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">download_epicurve</span> <span class="op">&lt;-</span> <span class="fu">downloadHandler</span><span class="op">(</span>
    
    filename <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"malaria_epicurve_{input$select_district}.png"</span><span class="op">)</span>
    <span class="op">}</span>,
    
    content <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu">ggsave</span><span class="op">(</span><span class="va">file</span>, 
             <span class="fu">malaria_plot</span><span class="op">(</span><span class="op">)</span>,
             width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>
    <span class="op">}</span>
    
  <span class="op">)</span>
  
<span class="op">}</span></code></pre></div>
<p>You can see we’re just calling on the output of our reactive we’ve defined in both our download and plot rendering functions. One thing to note that often trips people up is you have to use the outputs of reactives as if they were functions - so you <em>must add empty brackets at the end of them</em> (i.e. <code>malaria_plot()</code> is correct, and <code>malaria_plot</code> is not). Now that we’ve added this solution our app is a little tidyer, faster, and easier to change since all our code that runs the epicurve function is in one place. Great!</p>

</div>
</div>



<div class="chapter-nav">
<div class="prev"><a href="dashboards-with-r-markdown.html"><span class="header-section-number">43</span> Dashboards with R Markdown</a></div>
<div class="next"><a href="writing-functions-1.html"><span class="header-section-number">45</span> Writing functions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#dashboards-with-shiny"><span class="header-section-number">44</span> Dashboards with Shiny</a></li>
<li>
<a class="nav-link" href="#the-structure-of-a-shiny-app"><span class="header-section-number">44.1</span> The structure of a shiny app</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#basic-file-structures"><span class="header-section-number">44.1.1</span> Basic file structures</a></li>
<li><a class="nav-link" href="#the-server-and-the-ui"><span class="header-section-number">44.1.2</span> The server and the ui</a></li>
<li><a class="nav-link" href="#before-you-start-to-build-an-app"><span class="header-section-number">44.1.3</span> Before you start to build an app</a></li>
</ul>
</li>
<li><a class="nav-link" href="#building-a-ui"><span class="header-section-number">44.2</span> Building a UI</a></li>
<li><a class="nav-link" href="#loading-data-into-our-app"><span class="header-section-number">44.3</span> Loading data into our app</a></li>
<li><a class="nav-link" href="#developing-an-app-server"><span class="header-section-number">44.4</span> Developing an app server</a></li>
<li><a class="nav-link" href="#adding-more-functionality"><span class="header-section-number">44.5</span> Adding more functionality</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>
</div>
  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2021-04-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
