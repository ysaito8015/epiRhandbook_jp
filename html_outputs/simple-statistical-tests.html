<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>18 Simple statistical tests | The Epidemiologist R Handbook</title>

    <meta name="author" content="the handbook team" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/header-attrs-2.8/header-attrs.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.2.5.1/tabs.js"></script>
    <script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="style_bs4.css" />
    
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="simple-statistical-tests" class="section level1" number="18">
<h1><span class="header-section-number">18</span> Simple statistical tests</h1>
<p>This page demonstrates how to conduct simple statistical tests using <strong>base</strong> R, <strong>rstatix</strong>, and <strong>gtsummary</strong>.</p>
<ul>
<li>T-test<br />
</li>
<li>Shapiro-Wilk test<br />
</li>
<li>Wilcoxon rank sum test<br />
</li>
<li>Kruskal-Wallis test<br />
</li>
<li>Chi-squared test<br />
</li>
<li>Correlations between numeric variables</li>
</ul>
<p>…many other tests can be performed, but we showcase just these common ones and link to further documentation.</p>
<p>Each of the above packages bring certain advantages and disadvantages:</p>
<ul>
<li>Use <strong>base</strong> R functions to print a statistical outputs to the R Console<br />
</li>
<li>Use <strong>rstatix</strong> functions to return results in a data frame, or if you want tests to run by group<br />
</li>
<li>Use <strong>gtsummary</strong> if you want to quickly print publication-ready tables</li>
</ul>
<!-- ======================================================= -->
<div id="preparation-9" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> Preparation</h2>
<div id="load-packages-11" class="section level3 unnumbered">
<h3>Load packages</h3>
<p>This code chunk shows the loading of packages required for the analyses. In this handbook we emphasize <code>p_load()</code> from <strong>pacman</strong>, which installs the package if necessary <em>and</em> loads it for use. You can also load installed packages with <code>library()</code> from <strong>base</strong> R. See the page on <a href="r-basics.html#r-basics">R basics</a> for more information on R packages.</p>
</div>
<div id="import-data-11" class="section level3 unnumbered">
<h3>Import data</h3>
<p>We import the dataset of cases from a simulated Ebola epidemic. If you want to follow along, <a href='https://github.com/epirhandbook/Epi_R_handbook/raw/master/data/case_linelists/linelist_cleaned.rds' class='download-button'>click to download the “clean” linelist</a> (as .rds file). Import your data with the <code>import()</code> function from the <strong>rio</strong> package (it accepts many file types like .xlsx, .rds, .csv - see the <a href="import-and-export.html#import-and-export">Import and export</a> page for details).</p>
<p>The first 50 rows of the linelist are displayed below.</p>
</div>
</div>
<div id="base-r-2" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> <strong>base</strong> R</h2>
<p>You can use <strong>base</strong> R functions to conduct statistical tests. The commands are relatively simple and results will print to the R Console for simple viewing. However, the outputs are usually lists and so are harder to manipulate if you want to use the results in subsequent operations.</p>
<div id="t-tests" class="section level3 unnumbered">
<h3>T-tests</h3>
<p>A <a href="https://en.wikipedia.org/wiki/Student%27s_t-test">t-test</a>, also called “Student’s t-Test”, is typically used to determine if there is a significant difference between the means of some numeric variable between two groups. Here we’ll show the syntax to do this test depending on whether the columns are in the same data frame.</p>
<p><strong>Syntax 1:</strong> This is the syntax when your numeric and categorical columns are in the same data frame. Provide the numeric column on the left side of the equation and the categorical column on the right side. Specify the dataset to <code>data =</code>. Optionally, set <code>paired = TRUE</code>, and <code>conf.level =</code> (0.95 default), and <code>alternative =</code> (either “two.sided”, “less”, or “greater”). Enter <code>?t.test</code> for more details.</p>
<p><strong>Syntax 2:</strong> You can compare two separate numeric vectors using this alternative syntax. For example, if the two columns are in different data sets.</p>
<p>You can also use a t-test to determine whether a sample mean is significantly different from some specific value. Here we conduct a one-sample t-test with the known/hypothesized population mean as <code>mu =</code>:</p>
</div>
<div id="shapiro-wilk-test" class="section level3 unnumbered">
<h3>Shapiro-Wilk test</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test">Shapiro-Wilk test</a> can be used to determine whether a sample came from a normally-distributed population (an assumption of many other tests and analysis, such as the t-test). However, this can only be used on a sample between 3 and 5000 observations. For larger samples a <a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">quantile-quantile plot</a> may be helpful.</p>
</div>
<div id="wilcoxon-rank-sum-test" class="section level3 unnumbered">
<h3>Wilcoxon rank sum test</h3>
<p>The Wilcoxon rank sum test, also called the <a href="https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test">Mann–Whitney U test</a>, is often used to help determine if two numeric samples are from the same distribution when their populations are not normally distributed or have unequal variance.</p>
</div>
<div id="kruskal-wallis-test" class="section level3 unnumbered">
<h3>Kruskal-Wallis test</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Kruskal%E2%80%93Wallis_one-way_analysis_of_variance">Kruskal-Wallis test</a> is an extension of the Wilcoxon rank sum test that can be used to test for differences in the distribution of more than two samples. When only two samples are used it gives identical results to the Wilcoxon rank sum test.</p>
</div>
<div id="chi-squared-test" class="section level3 unnumbered">
<h3>Chi-squared test</h3>
<p><a href="https://en.wikipedia.org/wiki/Chi-squared_test">Pearson’s Chi-squared test</a> is used in testing for significant differences between categorical croups.</p>
</div>
</div>
<div id="rstatix-package" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> <strong>rstatix</strong> package</h2>
<p>The <strong>rstatix</strong> package offers the ability to run statistical tests and retrieve results in a “pipe-friendly” framework. The results are automatically in a data frame so that you can perform subsequent operations on the results. It is also easy to group the data being passed into the functions, so that the statistics are run for each group.</p>
<div id="summary-statistics-2" class="section level3 unnumbered">
<h3>Summary statistics</h3>
<p>The function <code>get_summary_stats()</code> is a quick way to return summary statistics. Simply pipe your dataset to this function and provide the columns to analyse. If no columns are specified, the statistics are calculated for all columns.</p>
<p>By default, a full range of summary statistics are returned: n, max, min, median, 25%ile, 75%ile, IQR, median absolute deviation (mad), mean, standard deviation, standard error, and a confidence interval of the mean.</p>
<p>You can specify a subset of summary statistics to return by providing one of the following values to <code>type =</code>: “full”, “common”, “robust”, “five_number”, “mean_sd”, “mean_se”, “mean_ci”, “median_iqr”, “median_mad”, “quantile”, “mean”, “median”, “min”, “max”.</p>
<p>It can be used with grouped data as well, such that a row is returned for each grouping-variable:</p>
<p>You can also use <strong>rstatix</strong> to conduct statistical tests:</p>
</div>
<div id="t-test" class="section level3 unnumbered">
<h3>T-test</h3>
<p>Use a formula syntax to specify the numeric and categorical columns:</p>
<p>Or use <code>~ 1</code> and specify <code>mu =</code> for a one-sample T-test. This can also be done by group.</p>
<p>If applicable, the statistical tests can be done by group, as shown below:</p>
</div>
<div id="shapiro-wilk-test-1" class="section level3 unnumbered">
<h3>Shapiro-Wilk test</h3>
<p>As stated above, sample size must be between 3 and 5000.</p>
</div>
<div id="wilcoxon-rank-sum-test-1" class="section level3 unnumbered">
<h3>Wilcoxon rank sum test</h3>
</div>
<div id="kruskal-wallis-test-1" class="section level3 unnumbered">
<h3>Kruskal-Wallis test</h3>
<p>Also known as the Mann-Whitney U test.</p>
</div>
<div id="chi-squared-test-1" class="section level3 unnumbered">
<h3>Chi-squared test</h3>
<p>The chi-square test function accepts a table, so first we create a cross-tabulation. There are many ways to create a cross-tabulation (see <a href="descriptive-tables.html#descriptive-tables">Descriptive tables</a>) but here we use <code>tabyl()</code> from <strong>janitor</strong> and remove the left-most column of value labels before passing to <code>chisq_test()</code>.</p>
<p>Many many more functions and statistical tests can be run with <strong>rstatix</strong> functions. See the documentation for <strong>rstatix</strong> <a href="https://github.com/kassambara/rstatix">online here</a> or by entering ?rstatix.</p>
</div>
</div>
<div id="stats_gt" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> <code>gtsummary</code> package</h2>
<p>Use <strong>gtsummary</strong> if you are looking to add the results of a statistical test to a pretty table that was created with this package (as described in the <strong>gtsummary</strong> section of the <a href="descriptive-tables.html#tbl_gt">Descriptive tables</a> page).</p>
<p>Performing statistical tests of comparison with <code>tbl_summary</code> is done by adding the
<code>add_p</code> function to a table and specifying which test to use. It is possible to get p-values corrected for multiple testing by using the
<code>add_q</code> function. Run <code>?tbl_summary</code> for details.</p>
<div id="chi-squared-test-2" class="section level3 unnumbered">
<h3>Chi-squared test</h3>
<p>Compare the proportions of a categorical variable in two groups. The default statistical test for <code>add_p()</code> when applied to a categorical variable is to perform a chi-squared test of independence with continuity correction, but if any expected call count is below 5 then a Fisher’s exact test is used.</p>
</div>
<div id="t-tests-1" class="section level3 unnumbered">
<h3>T-tests</h3>
<p>Compare the difference in means for a continuous variable in two groups.
For example, compare the mean age by patient outcome.</p>
</div>
<div id="wilcoxon-rank-sum-test-2" class="section level3 unnumbered">
<h3>Wilcoxon rank sum test</h3>
<p>Compare the distribution of a continuous variable in two groups. The default
is to use the Wilcoxon rank sum test and the median (IQR) when comparing two
groups. However for non-normally distributed data or comparing multiple groups,
the Kruskal-wallis test is more appropriate.</p>
</div>
<div id="kruskal-wallis-test-2" class="section level3 unnumbered">
<h3>Kruskal-wallis test</h3>
<p>Compare the distribution of a continuous variable in two or more groups,
regardless of whether the data is normally distributed.</p>
<!-- ## `dplyr` package {} -->
<!-- Performing statistical tests in `dplyr` alone is very dense, again because it  -->
<!-- does not fit within the tidy-data framework. It requires using `purrr` to create -->
<!-- a list of dataframes for each of the subgroups you want to compare. See the page on [Iteration, loops, and lists] to learn about **purrr**.   -->
<!-- An easier alternative may be the `rstatix` package.  -->
<!-- ### T-tests {.unnumbered}  -->
<!-- ```{r ttest_dplyr} -->
<!-- linelist %>%  -->
<!--   ## only keep variables of interest -->
<!--   select(age, outcome) %>%  -->
<!--   ## drop those missing outcome  -->
<!--   filter(!is.na(outcome)) %>%  -->
<!--   ## specify the grouping variable -->
<!--   group_by(outcome) %>%  -->
<!--   ## create a subset of data for each group (as a list) -->
<!--   nest() %>%  -->
<!--   ## spread in to wide format -->
<!--   pivot_wider(names_from = outcome, values_from = data) %>%  -->
<!--   mutate( -->
<!--     ## calculate the mean age for the death group -->
<!--     Death_mean = map(Death, ~mean(.x$age, na.rm = TRUE)), -->
<!--     ## calculate the sd among dead  -->
<!--     Death_sd = map(Death, ~sd(.x$age, na.rm = TRUE)), -->
<!--     ## calculate the mean age for the recover group -->
<!--     Recover_mean = map(Recover, ~mean(.x$age, na.rm = TRUE)),  -->
<!--     ## calculate the sd among recovered  -->
<!--     Recover_sd = map(Recover, ~sd(.x$age, na.rm = TRUE)), -->
<!--     ## using both grouped data sets compare mean age with a t-test -->
<!--     ## keep only the p.value -->
<!--     t_test = map2(Death, Recover, ~t.test(.x$age, .y$age)$p.value) -->
<!--   ) %>%  -->
<!--   ## drop datasets  -->
<!--   select(-Death, -Recover) %>%  -->
<!--   ## return a dataset with the medians and p.value (drop missing) -->
<!--   unnest(cols = everything()) -->
<!-- ``` -->
<!-- ### Wilcoxon rank sum test {.unnumbered} -->
<!-- ```{r wilcox_dplyr} -->
<!-- linelist %>%  -->
<!--   ## only keep variables of interest -->
<!--   select(age, outcome) %>%  -->
<!--   ## drop those missing outcome  -->
<!--   filter(!is.na(outcome)) %>%  -->
<!--   ## specify the grouping variable -->
<!--   group_by(outcome) %>%  -->
<!--   ## create a subset of data for each group (as a list) -->
<!--   nest() %>%  -->
<!--   ## spread in to wide format -->
<!--   pivot_wider(names_from = outcome, values_from = data) %>%  -->
<!--   mutate( -->
<!--     ## calculate the median age for the death group -->
<!--     Death_median = map(Death, ~median(.x$age, na.rm = TRUE)), -->
<!--     ## calculate the sd among dead  -->
<!--     Death_iqr = map(Death, ~str_c( -->
<!--       quantile(.x$age, probs = c(0.25, 0.75), na.rm = TRUE),  -->
<!--       collapse = ", " -->
<!--       )), -->
<!--     ## calculate the median age for the recover group -->
<!--     Recover_median = map(Recover, ~median(.x$age, na.rm = TRUE)),  -->
<!--     ## calculate the sd among recovered  -->
<!--     Recover_iqr = map(Recover, ~str_c( -->
<!--       quantile(.x$age, probs = c(0.25, 0.75), na.rm = TRUE),  -->
<!--       collapse = ", " -->
<!--       )), -->
<!--     ## using both grouped data sets compare age distribution with a wilcox test -->
<!--     ## keep only the p.value -->
<!--     wilcox = map2(Death, Recover, ~wilcox.test(.x$age, .y$age)$p.value) -->
<!--   ) %>%  -->
<!--   ## drop datasets  -->
<!--   select(-Death, -Recover) %>%  -->
<!--   ## return a dataset with the medians and p.value (drop missing) -->
<!--   unnest(cols = everything()) -->
<!-- ``` -->
<!-- ### Kruskal-wallis test {.unnumbered} -->
<!-- ```{r kruskal_dplyr} -->
<!-- linelist %>%  -->
<!--   ## only keep variables of interest -->
<!--   select(age, outcome) %>%  -->
<!--   ## drop those missing outcome  -->
<!--   filter(!is.na(outcome)) %>%  -->
<!--   ## specify the grouping variable -->
<!--   group_by(outcome) %>%  -->
<!--   ## create a subset of data for each group (as a list) -->
<!--   nest() %>%  -->
<!--   ## spread in to wide format -->
<!--   pivot_wider(names_from = outcome, values_from = data) %>%  -->
<!--   mutate( -->
<!--     ## calculate the median age for the death group -->
<!--     Death_median = map(Death, ~median(.x$age, na.rm = TRUE)), -->
<!--     ## calculate the sd among dead  -->
<!--     Death_iqr = map(Death, ~str_c( -->
<!--       quantile(.x$age, probs = c(0.25, 0.75), na.rm = TRUE),  -->
<!--       collapse = ", " -->
<!--       )), -->
<!--     ## calculate the median age for the recover group -->
<!--     Recover_median = map(Recover, ~median(.x$age, na.rm = TRUE)),  -->
<!--     ## calculate the sd among recovered  -->
<!--     Recover_iqr = map(Recover, ~str_c( -->
<!--       quantile(.x$age, probs = c(0.25, 0.75), na.rm = TRUE),  -->
<!--       collapse = ", " -->
<!--       )), -->
<!--     ## using the original data set compare age distribution with a kruskal test -->
<!--     ## keep only the p.value -->
<!--     kruskal = kruskal.test(linelist$age, linelist$outcome)$p.value -->
<!--   ) %>%  -->
<!--   ## drop datasets  -->
<!--   select(-Death, -Recover) %>%  -->
<!--   ## return a dataset with the medians and p.value (drop missing) -->
<!--   unnest(cols = everything()) -->
<!-- ``` -->
<!-- ### Chi-squared test {.unnumbered}  -->
<!-- ```{r} -->
<!-- linelist %>%  -->
<!--   ## do everything by gender  -->
<!--   group_by(outcome) %>%  -->
<!--   ## count the variable of interest -->
<!--   count(gender) %>%  -->
<!--   ## calculate proportion  -->
<!--   ## note that the denominator here is the sum of each gender -->
<!--   mutate(percentage = n / sum(n) * 100) %>%  -->
<!--   pivot_wider(names_from = outcome, values_from = c(n, percentage)) %>%  -->
<!--   filter(!is.na(gender)) %>%  -->
<!--   mutate(pval = chisq.test(linelist$gender, linelist$outcome)$p.value) -->
<!-- ``` -->
<!-- ======================================================= -->
</div>
</div>
<div id="correlations" class="section level2" number="18.5">
<h2><span class="header-section-number">18.5</span> Correlations</h2>
<p>Correlation between numeric variables can be investigated using the <strong>tidyverse</strong><br />
<strong>corrr</strong> package. It allows you to compute correlations using Pearson, Kendall
tau or Spearman rho. The package creates a table and also has a function to
automatically plot the values.</p>
<!-- ======================================================= -->
</div>
<div id="resources-11" class="section level2" number="18.6">
<h2><span class="header-section-number">18.6</span> Resources</h2>
<p>Much of the information in this page is adapted from these resources and vignettes online:</p>
<p><a href="http://www.danieldsjoberg.com/gtsummary/articles/tbl_summary.html">gtsummary</a>
<a href="https://dplyr.tidyverse.org/articles/grouping.html">dplyr</a>
<a href="https://corrr.tidymodels.org/articles/using-corrr.html">corrr</a>
<a href="http://www.sthda.com/english/wiki/correlation-test-between-two-variables-in-r">sthda correlation</a></p>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2021-05-30.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
