# ヘルプ

この章では、R や R パッケージに関する質問やバグ（不具合）を Github に Issue （イシュー）として投稿する方法や、R や R パッケージについて質問・疑問点があった場合に、再現可能なサンプルコード（英語で reprex と呼ばれる）を用いてStack Overflow等のオンラインフォーラムに投稿する方法を解説します。

## Github に Issue（質問やバグ）を投稿する

多くの R パッケージやプロジェクトは、コードが Github.com にアップロードされています。Githubに Issue を投稿することで、パッケージやプロジェクトの作成者に直に連絡をとることができます。

作成した R パッケージやプロジェクトを Github にアップロードする方法については、第46章「Git と Github を使用したバージョン管理と共同作業」のページで詳しく説明しています。

Githubでは、各プロジェクトがリポジトリに保管されています。各リポジトリには、コード、データ、アウトプット、ヘルプドキュメントなどが含まれています。また、「Issues」と呼ばれる作成者とのコミュニケーションの手段もあります。

下の図は、**incidence2** パッケージ（流行曲線・エピカーブを作成するために使用）の Github ページです。黄色で着色された箇所が「Issues」タブです。このパッケージには、5つの Issue （未解決の問題点や修正点）があることがわかります。

```{r, warning=F, message=F, echo=F}
knitr::include_graphics(here::here("images", "errors_Github_issues.png"))
```

「Issues」タブを開くと、現在までに投稿された Issue が表示されます。自分の質問や疑問点・修正点を新たに Issue として投稿する前に、既に投稿されている Issue に目を通し、同じ質問や疑問点・修正点がすでに投稿または解決されていないかを確認しましょう。まだ投稿されていない場合は、右側にある緑色の「New issue」ボタンをクリックし、新しい Issue を作成することができます。新しい Issue の作成には、Github アカウントが必要です。

```{r, warning=F, message=F, echo=F}
knitr::include_graphics(here::here("images", "errors_Github_issues2.png"))
```

新たに Issue を投稿する際は、以下で説明する方法で、最低限の再現可能なサンプルコード（reprex）を提示してください。また、Issue を投稿する際は R パッケージやプロジェクトの作成者に敬意を払い、あなたの質問や疑問点、修正点について、丁寧に説明しましょう。作成者の多くは、R パッケージやプロジェクトを空き時間にボランティアで開発しています。（このハンドブックもそのような有志が集まって作成されました！）

自分の Github リポジトリに投稿された Issue の取り扱い方法については、 [Issue に関する Github のページ](https://docs.github.com/en/issues/tracking-your-work-with-issues/about-issues)をご覧ください。

## 再現可能なサンプルコードを作成する

オンラインフォーラムや Github の Issue に投稿する際には、再現可能なサンプルコード（英語で reprex と呼ばれる）を記載することが重要です。多くの人は、あなたが投稿した質問や疑問点を解決するために、力を貸したいと思っています。第三者があなたの質問を理解し、解決の手助けをするためには、その問題を手元で再現できるサンプルコードが必要です。サンプルコードに必要な要件は以下の通りです。

-   ヘルプが必要な質問や問題を明確に説明する\
-   問題を再現するのに必要な[最小限の]{.ul}データとコードを含む\
-   データ等のすべてのオブジェクトやパッケージを読み込むコード （`library()` や `p_load()`）が含まれているなど、[再現性がある]{.ul}

[投稿する際は、機密データを含まないように注意してください！]{.ul} 投稿する際は、機密データを含まないように注意してください。機密上の理由または他の理由で、実際に使用したデータをオンラインフォーラムや Github に投稿したくない、またはすべきでない場合は、データフレーム（data frame）を用いて別の異なるデータセットを作成する、または、R に組み込まれているデータフレームを使用することをおすすめします。（`data()` を入力すると、R に組み込まれているデータセットのリストが表示されます。）

### The **reprex** package {.unnumbered}

The **reprex** package can assist you with making a reproducible example:

1)  **reprex** is installed with **tidyverse**, so load either package

```{r, eval=F}
# install/load tidyverse (which includes reprex)
pacman::p_load(tidyverse)
```

2)  Begin an R script that creates your problem, step-by-step, starting from loading packages and data.

```{r, eval=F}
# load packages
pacman::p_load(
     tidyverse,  # data mgmt and vizualization
     outbreaks)  # example outbreak datasets

# flu epidemic case linelist
outbreak_raw <- outbreaks::fluH7N9_china_2013  # retrieve dataset from outbreaks package

# Clean dataset
outbreak <- outbreak_raw %>% 
     mutate(across(contains("date"), as.Date))

# Plot epidemic

ggplot(data = outbreak)+
     geom_histogram(
          mapping = aes(x = date_of_onset),
          binwidth = 7
     )+
  scale_x_date(
    date_format = "%d %m"
  )

```

*Copy* all the code to your clipboard, and run the following command:

```{r, eval=F}
reprex::reprex()
```

You will see an HTML output appear in the RStudio Viewer pane. It will contain all your code and any warnings, errors, or plot outputs. This output is also copied to your clipboard, so you can post it directly into a Github issue or a forum post.

```{r, out.width=c('100%', '100%'), warning=F, message=F, echo=F}
knitr::include_graphics(here::here("images", "errors_reprex_RStudio1.png"))
```

-   If you set `session_info = TRUE` the output of `sessioninfo::session_info()` with your R and R package versions will be included\
-   You can provide a working directory to `wd =`\
-   You can read more about the arguments and possible variations at the [documentation]() or by entering `?reprex`

In the example above, the `ggplot()` command did not run because the arguemnt `date_format =` is not correct - it should be `date_labels =`.

### Minimal data {.unnumbered}

The helpers need to be able to use your data - ideally they need to be able to create it *with code*.

To create a minumal dataset, consider anonymising and using only a subset of the observations.

UNDER CONSTRUCTION - you can also use the function `dput()` to create minimal dataset.

## Posting to a forum

Read lots of forum posts. Get an understanding for which posts are well-written, and which ones are not.

1)  First, decide whether to ask the question at all. Have you *thoroughly* reviewed the forum website, trying various search terms, to see if your question has already been asked?

2)  Give your question an informative title (not "Help! this isn't working").

3)  Write your question:

-   Introduce your situation and problem\
-   Link to posts of similar issues and explain how they do not answer your question\
-   Include any relevant information to help someone who does not know the context of your work\
-   Give a minimal reproducible example with your R session information\
-   Use proper spelling, grammar, punctuation, and break your question into paragraphs so that it is easier to read

4)  Monitor your question once posted to respond to any requests for clarification. Be courteous and gracious - often the people answering are volunteering their time to help you. If you have a follow-up question consider whether it should be a separate posted question.

5)  Mark the question as answered, *if* you get an answer that meets the *original* request. This helps others later quickly recognize the solution.

Read these posts about [how to ask a good question](https://stackoverflow.com/help/how-to-ask) the [Stack overflow code of conduct](https://stackoverflow.com/conduct).

<!-- ======================================================= -->

## Resources

Tidyverse page on how to [get help!](https://www.tidyverse.org/help/#:~:text=When%20you%20want%20to%20make,to%20load%20the%20reprex%20package.&text=Enter%20reprex()%20in%20the,preview%20of%20your%20rendered%20reprex.)

Tips on [producing a minimal dataset](https://xiangxing98.github.io/R_Learning/R_Reproducible.nb.html#producing-a-minimal-dataset)

Documentation for the [dput function](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/dput)
