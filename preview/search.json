<<<<<<< HEAD
[{"path":"index.html","id":"section","chapter":"","heading":"","text":"DRAFT.REVIEWING BOOK, PLEASE PROVIDE FEEDBACK PAGE LINK","code":""},{"path":"index.html","id":"about-this-handbook","chapter":"","heading":"About this handbook","text":"open-access R reference manual applied epidemiologists public health practitioners.book strives :Serve quick R code reference manualProvide task-centered examples addressing common epidemiological problemsAssist epidemiologists transitioning R SAS, STATA, SPSS, ExcelBe accessible settings low internet-connectivity via offline version ([instructions ][Download book data])different R books?written epidemiologists, epidemiologists - leveraging experience local, national, academic, emergency settingsIt provides examples epidemic curves, transmission chains, epidemic modeling projections, age sex pyramids standardization, record matching, outbreak detection, survey analysis, causal diagrams, survival analysis, GIS basics, phylogenetic trees, automated reports, etc…","code":""},{"path":"index.html","id":"how-to-read-this-handbook","chapter":"","heading":"How to read this handbook","text":"Online versionSearch via search box Table ContentsClick “copy” icons copy codeSee “Resources” section page resourcesTo download data “follow-along”, see [Download book data] pageOffline versionTo download offline version, follow step--step instructions [Download book data] page.LanguagesWe actively seeking translate book languages English. can help, please contact us epiRhandbook@gmail.com.","code":""},{"path":"index.html","id":"edit-or-contribute","chapter":"","heading":"Edit or contribute","text":"Want share use book? Want offer fix addition?\r\nEmail us epiRhandbook@gmail.com. welcome comments suggestions.can also submit issue pull request Github repository, provide structured feedback via Google survey.","code":""},{"path":"index.html","id":"acknowledgements","chapter":"","heading":"Acknowledgements","text":"","code":""},{"path":"index.html","id":"contributors","chapter":"","heading":"Contributors","text":"book produced collaboration epidemiologists around world, drawing upon experiences organizations including local, state, provincial, national health departments ministries, World Health Organization (), MSF (Médecins Sans Frontières / Doctors without Borders), hospital systems, academic institutions.Editor--Chief: Neale BatraCore team: Neale Batra, Alex Spina, Amrish Baidjoe, Pat Keating, Henry Laurenson-Schafer, Finlay CampbellAuthors: Neale Batra, Alex Spina, Paula Blomquist, Finlay Campbell, Henry Laurenson-Schafer, Isaac Florence, Natalie Fischer, Aminata Ndiaye, Liza Coyer, Jonny Polonski, Yurie Izawa, Daniel Molling, Sara Hollis, Isha Berry, Wen LinReviewers:","code":""},{"path":"index.html","id":"funding-and-programmatic-support","chapter":"","heading":"Funding and programmatic support","text":"handbook approved product specific organization. Although strive accuracy, provide guarantee content book.handbook project received funding via COVID-19 emergency capacity-building grant Training Programs Epidemiology Public Health Interventions Network (TEPHINET). handbook supported Cooperative Agreement number NU2GGH001873, funded Centers Disease Control Prevention TEPHINET, program Task Force Global Health. contents solely responsibility authors necessarily represent official views Centers Disease Control Prevention, Department Health Human Services, Task Force Global Health, Inc. TEPHINET.Programmatic support provided EPIET Alumni Network (EAN) also MSF’s Manson Unit.","code":""},{"path":"index.html","id":"inspiration","chapter":"","heading":"Inspiration","text":"multitude tutorials vignettes provided knowledge development handbook content credited within respective pages.generally, following sources provided inspiration laid groundwork handbook:“R4Epis” project (collaboration MSF RECON)R Epidemics Consortium (RECON)R Data Science book (R4DS)bookdown: Authoring Books Technical Documents R MarkdownNetlify hosts website","code":""},{"path":"index.html","id":"image-credits","chapter":"","heading":"Image credits","text":"Images logo (US CDC Public Health Image Library):2013 Yemen looking mosquito breeding sitesEbola virusSurvey Rajasthan","code":""},{"path":"index.html","id":"terms-of-use-and-license","chapter":"","heading":"Terms of Use and License","text":"work licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.","code":""},{"path":"phylogenetic-trees.html","id":"phylogenetic-trees","chapter":"1 Phylogenetic trees","heading":"1 Phylogenetic trees","text":"","code":""},{"path":"phylogenetic-trees.html","id":"overview","chapter":"1 Phylogenetic trees","heading":"1.1 Overview","text":"Phylogenetic trees used visualize describe relatedness evolution organisms based sequence genetic code.can constructed genetic sequences using distance-based methods (neighbor-joining method) character-based methods (maximum likelihood Bayesian Markov Chain Monte Carlo method). Next-generation sequencing (NGS) become affordable becoming widely used public health describe pathogens causing infectious diseases. Portable sequencing devices decrease turn around time hold promises make data available support outbreak investigation real-time. NGS data can used identify origin source outbreak strain propagation, well determine presence antimicrobial resistance genes. visualize genetic relatedness samples phylogenetic tree constructed.page learn use **ggtree* package, allows combined visualization phylogenetic trees additional sample data form dataframe order help observe patterns improve understanding outbreak dynamic.","code":""},{"path":"phylogenetic-trees.html","id":"preparation","chapter":"1 Phylogenetic trees","heading":"1.2 Preparation","text":"","code":""},{"path":"phylogenetic-trees.html","id":"load-packages","chapter":"1 Phylogenetic trees","heading":"Load packages","text":"code chunk shows loading required packages. handbook emphasize p_load() pacman, installs package necessary loads use. can also load packages library() base R. See page [R basics] information R packages.","code":"\npacman::p_load(\n  rio,             # import/export\n  here,            # relative file paths\n  tidyverse,       # general data management and visualization\n  ape,           \n  ggtree,\n  treeio,\n  ggnewscale)"},{"path":"phylogenetic-trees.html","id":"import-data","chapter":"1 Phylogenetic trees","heading":"Import data","text":"several different formats phylogenetic tree can stored (eg. Newick, NEXUS, Phylip). common one, also use example Newick file format (.nwk), standard representing trees computer-readable form. means entire tree can expressed string format “((t2:0.04,t1:0.34):0.89,(t5:0.37,(t4:0.03,t3:0.67):0.9):0.59);”, listing nodes tips relationship (branch length) .important understand phylogenetic tree file contain sequencing data, merely result genetic distances sequences. therefore extract sequencing data tree file.use ape() package import Newick phylogenetic tree file .txt format, store list object class “phylo”.inspect tree object see contains 299 tips (samples) 236 nodes.Second import table additional information sequenced sample, gender, country origin attributes antimicrobial resistance:first 50 rows data:","code":"\n# In this case the newick tree is saved as a .txt file for easier handling and downloading.\ntree <- ape::read.tree(\"Shigella_tree.txt\")\n# inspect the tree file:\ntree## \r\n## Phylogenetic tree with 299 tips and 236 internal nodes.\r\n## \r\n## Tip labels:\r\n##   SRR5006072, SRR4192106, S18BD07865, S18BD00489, S17BD08906, S17BD05939, ...\r\n## Node labels:\r\n##   17, 29, 100, 67, 100, 100, ...\r\n## \r\n## Rooted; includes branch lengths.\n# We read in a .csv file into a dataframe format:\nsample_data <- import(\"sample_data_Shigella_tree.csv\")"},{"path":"phylogenetic-trees.html","id":"clean-and-inspect","chapter":"1 Phylogenetic trees","heading":"Clean and inspect","text":"clean inspect data: order assign correct sample data phylogenetic tree, values column Sample_ID sample_data data frame need match tip.labels values tree file:also make sure first column sample_data data frame Sample_ID.look Sample_IDs data frame make sure formatting tip.label (eg. letters capitals, extra underscores _ letters numbers, etc.)can also compare samples present tree file vice versa generating logical vector TRUE FALSE match. printed , simplicity.can use vectors show sample IDs tree (none).Upon inspection can see format Sample_ID dataframe corresponds format sample names tree tips. sorted order matched.ready go!","code":"\n# We check the formatting of the tip labels in the tree file: \nhead(tree$tip.label) # these are the sample names in the tree - we inspect the first 6 with head()## [1] \"SRR5006072\" \"SRR4192106\" \"S18BD07865\" \"S18BD00489\" \"S17BD08906\" \"S17BD05939\"\ncolnames(sample_data)   ##  [1] \"Sample_ID\"                  \"serotype\"                   \"Country\"                    \"Continent\"                 \r\n##  [5] \"Travel_history\"             \"Year\"                       \"Belgium\"                    \"Source\"                    \r\n##  [9] \"Gender\"                     \"gyrA_mutations\"             \"macrolide_resistance_genes\" \"MIC_AZM\"                   \r\n## [13] \"MIC_CIP\"\nhead(sample_data$Sample_ID) # we inspect only the first 6 using head()## [1] \"S17BD05944\" \"S15BD07413\" \"S18BD07247\" \"S19BD07384\" \"S18BD07338\" \"S18BD02657\"\nsample_data$Sample_ID %in% tree$tip.label\n\ntree$tip.label %in% sample_data$Sample_ID\nsample_data$Sample_ID[!tree$tip.label %in% sample_data$Sample_ID]## character(0)"},{"path":"phylogenetic-trees.html","id":"simple-tree-visualization","chapter":"1 Phylogenetic trees","heading":"1.3 Simple tree visualization","text":"","code":""},{"path":"phylogenetic-trees.html","id":"different-tree-layouts","chapter":"1 Phylogenetic trees","heading":"Different tree layouts","text":"ggtree offers many different layout formats may suitable specific purpose others. demonstrations. options see online book.","code":"\n# Example tree layouts:\nggtree(tree)                                            # simple linear tree\nggtree(tree,  branch.length = \"none\")                   # simple linear tree with all tips aligned\nggtree(tree, layout=\"circular\")                         # simple circular tree\nggtree(tree, layout=\"circular\", branch.length = \"none\") # simple circular tree with all tips aligned"},{"path":"phylogenetic-trees.html","id":"simple-tree-with-addition-of-sample-data","chapter":"1 Phylogenetic trees","heading":"Simple tree with addition of sample data","text":"easy annotation tree addition sample names tips, well coloring tip points desired branches:can export tree plot ggsave() ggplot object. Writen way, ggsave() saves last image produced file path specify. Remember can use () relative file paths easily save subfolders, etc.","code":"\n# A: Plot Circular tree:\nggtree(tree, layout = \"circular\", branch.length = 'none') %<+% sample_data + # %<+% adds dataframe with sample data to tree\n  aes(color = I(Belgium))+                       # color the branches according to a variable in your dataframe\n  scale_color_manual(\n    name = \"Sample Origin\",                      # name of your color scheme (will show up in the legend like this)\n    breaks = c(\"Yes\", \"No\"),                     # the different options in your variable\n    labels = c(\"NRCSS Belgium\", \"Other\"),        # how you want the different options named in your legend, allows for formatting\n    values= c(\"blue\", \"black\"),                  # the color you want to assign to the variable \n    na.value = \"black\") +                        # color NA values in black as well\n  new_scale_color()+                             # allows to add an additional color scheme for another variable\n    geom_tippoint(\n      mapping = aes(color = Continent),          # tip color by continent. You may change shape adding \"shape = \"\n      size = 1.5)+\n  scale_color_brewer(\n    name = \"Continent\",                    # name of your color scheme (will show up in the legend like this)\n    palette = \"Set1\",                      # we choose a set of colors coming with the brewer package\n    na.value = \"grey\")+                    # for the NA values we choose the color grey\n  geom_tiplab(                             # adds name of sample to tip of its branch \n    color = 'black',                       # (add as many text lines as you wish with + , but you may need to adjust offset value to place them next to each other)\n    offset = 1,\n    size = 1,\n    geom = \"text\",\n    align = TRUE)+    \n  ggtitle(\"Phylogenetic tree of Shigella sonnei\")+       # title of your graph\n  theme(\n    axis.title.x = element_blank(), # removes x-axis title\n    axis.title.y = element_blank(), # removes y-axis title\n    legend.title = element_text(    # defines font size and format of the legend title\n      face = \"bold\",\n      size =12),   \n    legend.text=element_text(       # defines font size and format of the legend text\n      face = \"bold\",\n      size =10),  \n    plot.title = element_text(      # defines font size and format of the plot title\n      size = 12,\n      face = \"bold\"),  \n    legend.position = \"bottom\",     # defines placement of the legend\n    legend.box = \"vertical\",        # defines placement of the legend\n    legend.margin = margin())   \n# Export your tree graph:\nggsave(\"example_tree_circular_1.png\", width = 12, height = 14)"},{"path":"phylogenetic-trees.html","id":"tree-manipulation","chapter":"1 Phylogenetic trees","heading":"1.4 Tree manipulation","text":"Sometimes may large phylogenetic tree interested one part tree. example produced tree including historical international samples get large overview dataset might fit bigger picture. look closer data want inspect portion bigger tree.Since phylogenetic tree file just output sequencing data analysis, can manipulate order nodes branches file . already determined previous analysis raw NGS data. able though zoom parts, hide parts even subset part tree.","code":""},{"path":"phylogenetic-trees.html","id":"zoom-in","chapter":"1 Phylogenetic trees","heading":"Zoom in","text":"don’t want “cut” tree, inspect part closely can zoom view specific part:zoom one particular branch (sticking right), use viewClade() ggtree object p provide node number get closer look:","code":"\n# First we plot the whole tree:\np <- ggtree(tree,) %<+% sample_data +\n  geom_tiplab(size =1.5) +                # labels the tips of all branches with the sample name in the tree file\n  geom_text2(\n    mapping = aes(subset = !isTip,\n                  label=node),\n    size = 5,\n    color = \"darkred\",\n    hjust = 1,\n    vjust = 1)                            # labels all the nodes in the tree\n\np  # print\nviewClade(p, node = 452)"},{"path":"phylogenetic-trees.html","id":"collapsing-branches","chapter":"1 Phylogenetic trees","heading":"Collapsing branches","text":"However, may want ignore branch can collapse node using collapse(). tree defined p_collapsed. clarity, print p_collapsed, add geom_point2() (blue diamond) node collapsed branch.","code":"\n#First we collapse at node 452\np_collapsed <- collapse(p, node=452)\n\n#To not forget that we collapsed this node we assign a symbol to it:\np_collapsed + geom_point2(aes(subset=(node == 452)), size=5, shape=23, fill=\"steelblue\")"},{"path":"phylogenetic-trees.html","id":"subsetting-a-tree","chapter":"1 Phylogenetic trees","heading":"Subsetting a tree","text":"want make permanent change create new, reduced tree work can subset part tree_subset(). can save new newick tree file.First, inspect tree nodes tip labels order decide subset.Now, say decided subset tree node 528 (keep tips within branch node 528).Lets look subset tree:can also subset based one particular sample, specifying many nodes “backwards” want include. Let’s subset part tree based sample, case S17BD07692, going back 9 nodes:Lets look subset tree:can also save new tree either Newick type even text file:","code":"\nggtree(\n  tree,\n  branch.length = 'none',\n  layout = 'circular') %<+% sample_data +\n  geom_tiplab(size = 1)+                                # label tips of all branches with sample name in tree file\n  geom_text2(\n    mapping = aes(subset = !isTip, label=node),\n    size = 3,\n    color = \"darkred\") +                                # labels all the nodes in the tree\n theme(\n   legend.position = \"none\",                            # removes the legend all together\n   axis.title.x = element_blank(),\n   axis.title.y = element_blank(),\n   plot.title = element_text(size =12, face=\"bold\"))\n# A: Subset tree based on node:\nsub_tree1 <- tree_subset(\n  tree,\n  node = 528)                                            # we subset the tree at node 528\nggtree(sub_tree1)+\n  geom_tiplab(size =3) +\n  ggtitle(\"Subset tree 1\")\nsub_tree2 <- tree_subset(\n  tree,\n  \"S17BD07692\",\n  levels_back = 9) # levels back defines how many nodes backwards from the sample tip you want to go\nggtree(sub_tree2)+  geom_tiplab(size =3)  +\n  ggtitle(\"Subset tree 2\")\n# to save in .nwk format\nape::write.tree(sub_tree2, file='data/Shigella_subtree_2.nwk')\n\n# to save in .txt format\nape::write.tree(sub_tree2, file='data/Shigella_subtree_2.txt')"},{"path":"phylogenetic-trees.html","id":"rotating-nodes-in-a-tree","chapter":"1 Phylogenetic trees","heading":"Rotating nodes in a tree","text":"mentioned change order tips nodes tree, based genetic relatedness subject visual manipulation. can rote branches around nodes eases visualization.First plot new subset tree node labels choose node want manipulate:can manipulate nodes applying ggtree::rotate() ggtree::flip():","code":"\np <- ggtree(sub_tree2) +  geom_tiplab(size =4) +\n  geom_text2(aes(subset=!isTip, label=node), size =5, color = \"darkred\", hjust =1, vjust =1) # labels all the nodes in the tree\np\n# here we apply the geom_hilight() function to highlight the samples in the nodes we are interested in \np1 <- p + geom_hilight(39, \"steelblue\", extend =0.0015)+  # highlights the node 39 in blue\ngeom_hilight(37, \"yellow\", extend =0.0015)  +             # highlights the node 37 in yellow\nggtitle(\"Original tree\")\np1\n\n# we can rotate node 37 so that the samples on node 38 move to the top:\n\np2 <- rotate(p1, 37)+ggtitle(\"Rotated Node 37\")\np2\n\n# or we can use the flip command to rotate node 36 and switch node 37 to the top and node 39 to the bottom:\np3 <-  flip(p1, 39, 37)+ggtitle(\"Rotated Node 36\")\np3"},{"path":"phylogenetic-trees.html","id":"example-subtree-with-sample-data-annotation","chapter":"1 Phylogenetic trees","heading":"Example subtree with sample data annotation","text":"Lets say investigating cluster cases clonal expansion occurred 2017 2018 node 39 sub-tree. add year strain isolation well travel history color country see origin closely related strains:observation points towards import event strains Asia, circulated Belgium years seem caused latest outbreak.","code":"\n# Add sample data:\nggtree(sub_tree2) %<+% sample_data + \n  geom_tiplab(                          # labels the tips of all branches with the sample name in the tree file\n    size = 2.5,\n    offset = 0.001,\n    align = TRUE) + \n  theme_tree2()+\n  xlim(0, 0.015)+                       # set the x-axis limits of our tree\n  geom_tippoint(aes(color=Country),     # color the tip point by continent\n                size=1.5)+ \n  scale_color_brewer(\n    name = \"Country\", \n    palette = \"Set1\", \n    na.value = \"grey\")+\n  geom_tiplab(                          # add isolation year\n    aes(label = Year),\n    color='blue',\n    offset = 0.0045,\n    size = 3,\n    linetype = \"blank\" ,\n    geom = \"text\",\n    align=TRUE)+ \n  geom_tiplab(                          # add travel history\n    aes(label = Travel_history),\n    color = 'red',\n    offset = 0.006,\n    size = 3,\n    linetype = \"blank\",\n    geom = \"text\",\n    align = TRUE)+ \n  ggtitle(\"Phylogenetic tree of Belgian S. sonnei strains with travel history\")+  # add plot title\n  xlab(\"genetic distance (0.001 = 4 nucleotides difference)\")+                    # add a label to the x-axis \n  theme(\n    axis.title.x=element_text(size = 10),\n    axis.title.y=element_blank(),\n    legend.title=element_text(face=\"bold\", size =12),\n    legend.text=element_text(face=\"bold\", size =10),\n    plot.title = element_text(size =12, face=\"bold\"))## Warning: Duplicated aesthetics after name standardisation: size\r\n\r\n## Warning: Duplicated aesthetics after name standardisation: size\r\n\r\n## Warning: Duplicated aesthetics after name standardisation: size"},{"path":"phylogenetic-trees.html","id":"more-complex-trees-adding-heatmaps-of-sample-data","chapter":"1 Phylogenetic trees","heading":"1.5 More complex trees: adding heatmaps of sample data","text":"can add complex information, categorical presence antimicrobial resistance genes numeric values actually measured resistance antimicrobials form heatmap using ggtree::gheatmap() function.First need plot tree (can either linear circular): use sub_tree part 3.)Second prepare data. visualize different variables new color schemes, subset dataframe desired variable.example want look gender mutations confer resistance Ciprofloxacin, important first line antibiotic used treat Shigella infections:create first plot adding binary heatmap gender phylogenetic tree:add information mutations gyrA gene, confer resistance Ciprofloxacin:Note: presence chromosomal point mutations WGS data prior determined using PointFinder tool developed Zankari et al. (see reference additional references section)Next add continuous data actual measured resistance, determined laboratory\r\nestablishment minimum inhibitory concentration (MIC) Ciprofloxacin strain sample set:can exercise linear tree:add minimum inhibitory concentration determined laboratory (MIC):","code":"\n# A: Circular tree:\np <- ggtree(sub_tree2, branch.length='none', layout='circular') %<+% sample_data +\n  geom_tiplab(size =3) + \n theme(\n   legend.position = \"none\",\n    axis.title.x=element_blank(),\n    axis.title.y=element_blank(),\n    plot.title = element_text(\n      size = 12,\n      face = \"bold\",\n      hjust = 0.5,\n      vjust = -15))\np\n# Create your gender dataframe:\ngender <- data.frame(\"gender\" = sample_data[,c(\"Gender\")])\n# Its important to add the Sample_ID as rownames otherwise it cannot match the data to the tree tip.labels:\nrownames(gender) <- sample_data$Sample_ID\n\n# Create your Ciprofloxacin dataframe based on mutations in the gyrA gene:\ncipR <- data.frame(\"cipR\" = sample_data[,c(\"gyrA_mutations\")])\nrownames(cipR) <- sample_data$Sample_ID\n\n# Create your Ciprofloxacin dataframe based on the measured minimum inhibitory concentration (MIC) from the laboratory:\nMIC_Cip <- data.frame(\"mic_cip\" = sample_data[,c(\"MIC_CIP\")])\nrownames(MIC_Cip) <- sample_data$Sample_ID\n# First we add gender:\nh1 <-  gheatmap(p, gender, offset = 10, # offset shifts the heatmap to the right,\n                width=0.10, #width defines the width of the heatmap column,\n                color=NULL, #  color defines the boarder of the heatmap columns\n         colnames = FALSE)+ # hides column names for the heatmap\n  scale_fill_manual(name = \"Gender\", # define the coloring scheme and legend for gender\n                    values = c(\"#00d1b1\", \"purple\"),\n                    breaks = c(\"Male\", \"Female\"),\n                    labels = c(\"Male\", \"Female\"))+\n   theme(legend.position=\"bottom\",\n        legend.title = element_text(size=12),\n        legend.text = element_text(size =10),\n        legend.box=\"vertical\", legend.margin=margin())## Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale.## Scale for 'fill' is already present. Adding another scale for 'fill', which will replace the existing scale.\nh1\n# First we assign a new color scheme to our existing plot, this enables us to define and change the colors for our second variable\nh2 <- h1 + new_scale_fill() \n\n# then we combine these into a new plot:\nh3 <- gheatmap(h2, cipR,  offset = 12, width=0.10, # adds the second row of heatmap describing Ciprofloxacin resistance mutations\n                colnames = FALSE)+\n  scale_fill_manual(name = \"Ciprofloxacin resistance \\n conferring mutation\",\n                    values = c(\"#fe9698\",\"#ea0c92\"),\n                    breaks = c( \"gyrA D87Y\", \"gyrA S83L\"),\n                    labels = c( \"gyrA d87y\", \"gyrA s83l\"))+\n   theme(legend.position=\"bottom\",\n        legend.title = element_text(size=12),\n        legend.text = element_text(size =10),\n        legend.box=\"vertical\", legend.margin=margin())+\n  guides(fill=guide_legend(nrow=2,byrow=TRUE))## Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale.## Scale for 'fill' is already present. Adding another scale for 'fill', which will replace the existing scale.\nh3\n# First we add the new coloring scheme:\nh4 <- h3 + new_scale_fill()\n\n# then we combine the two into a new plot:\nh5 <- gheatmap(h4, MIC_Cip,  offset = 14, width=0.10,\n                colnames = FALSE)+\n  scale_fill_continuous(name = \"MIC for Ciprofloxacin\",\n                      low = \"yellow\", high = \"red\",\n                      breaks = c(0, 0.50, 1.00),\n                      na.value = \"white\")+\n   guides(fill = guide_colourbar(barwidth = 5, barheight = 1))+\n   theme(legend.position=\"bottom\",\n        legend.title = element_text(size=12),\n        legend.text = element_text(size =10),\n        legend.box=\"vertical\", legend.margin=margin())## Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale.## Scale for 'fill' is already present. Adding another scale for 'fill', which will replace the existing scale.\nh5\n# B: Linear tree:\np <- ggtree(sub_tree2) %<+% sample_data +\n  geom_tiplab(size =3) + # labels the tips\n  theme_tree2()+\n  xlab(\"genetic distance (0.001 = 4 nucleotides difference)\")+\n  xlim(0, 0.015)+\n theme(legend.position = \"none\",\n      axis.title.y=element_blank(),\n      plot.title = element_text(size =12, face=\"bold\",hjust = 0.5, vjust = -15))\n\n\n# First we add gender:\n\nh1 <-  gheatmap(p, gender, offset = 0.003, width=0.1, color=\"black\", \n         colnames = FALSE)+\n  scale_fill_manual(name = \"Gender\",\n                    values = c(\"#00d1b1\", \"purple\"),\n                    breaks = c(\"Male\", \"Female\"),\n                    labels = c(\"Male\", \"Female\"))+\n   theme(legend.position=\"bottom\",\n        legend.title = element_text(size=12),\n        legend.text = element_text(size =10),\n        legend.box=\"vertical\", legend.margin=margin())## Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale.## Scale for 'fill' is already present. Adding another scale for 'fill', which will replace the existing scale.\nh1\nh2 <- h1 + new_scale_fill()\nh3 <- gheatmap(h2, cipR,  offset = 0.004, width=0.1,color=\"black\",\n                colnames = FALSE)+\n  scale_fill_manual(name = \"Ciprofloxacin resistance \\n conferring mutation\",\n                    values = c(\"#fe9698\",\"#ea0c92\"),\n                    breaks = c( \"gyrA D87Y\", \"gyrA S83L\"),\n                    labels = c( \"gyrA d87y\", \"gyrA s83l\"))+\n   theme(legend.position=\"bottom\",\n        legend.title = element_text(size=12),\n        legend.text = element_text(size =10),\n        legend.box=\"vertical\", legend.margin=margin())+\n  guides(fill=guide_legend(nrow=2,byrow=TRUE))## Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale.## Scale for 'fill' is already present. Adding another scale for 'fill', which will replace the existing scale.\n h3\nh4 <- h3 + new_scale_fill()\nh5 <- gheatmap(h4, MIC_Cip, offset = 0.005, width=0.1, color=\"black\", \n                colnames = FALSE)+\n  scale_fill_continuous(name = \"MIC for Ciprofloxacin\",\n                      low = \"yellow\", high = \"red\",\n                      breaks = c(0,0.50,1.00),\n                      na.value = \"white\")+\n   guides(fill = guide_colourbar(barwidth = 5, barheight = 1))+\n   theme(legend.position=\"bottom\",\n        legend.title = element_text(size=10),\n        legend.text = element_text(size =8),\n        legend.box=\"horizontal\", legend.margin=margin())+\n  guides(shape = guide_legend(override.aes = list(size = 2)))## Scale for 'y' is already present. Adding another scale for 'y', which will replace the existing scale.## Scale for 'fill' is already present. Adding another scale for 'fill', which will replace the existing scale.\nh5"},{"path":"phylogenetic-trees.html","id":"resources","chapter":"1 Phylogenetic trees","heading":"1.6 Resources","text":"http://hydrodictyon.eeb.uconn.edu/eebedia/index.php/Ggtree# Clade_Colors\r\nhttps://bioconductor.riken.jp/packages/3.2/bioc/vignettes/ggtree/inst/doc/treeManipulation.html\r\nhttps://guangchuangyu.github.io/ggtree-book/chapter-ggtree.html\r\nhttps://bioconductor.riken.jp/packages/3.8/bioc/vignettes/ggtree/inst/doc/treeManipulation.htmlEa Zankari, Rosa Allesøe, Katrine G Joensen, Lina M Cavaco, Ole Lund, Frank M Aarestrup, PointFinder: novel web tool WGS-based detection antimicrobial resistance associated chromosomal point mutations bacterial pathogens, Journal Antimicrobial Chemotherapy, Volume 72, Issue 10, October 2017, Pages 2764–2768, https://doi.org/10.1093/jac/dkx217","code":""}]
=======
[{"path":"index.html","id":"section","chapter":"","heading":"","text":"DRAFT.BOOK REVIEWERS: PLEASE PROVIDE FEEDBACK PAGE LINK","code":""},{"path":"index.html","id":"about-this-handbook","chapter":"","heading":"About this handbook","text":"open-access R reference manual applied epidemiologists public health practitioners.book strives :Serve quick R code reference manualProvide task-centered examples addressing common epidemiological problemsAssist epidemiologists transitioning R SAS, STATA, SPSS, ExcelBe accessible settings low internet-connectivity via offline version ([instructions ][Download book data])different R books?written epidemiologists, epidemiologists - leveraging experience local, national, academic, emergency settingsIt provides examples epidemic curves, transmission chains, epidemic modeling projections, age sex pyramids standardization, record matching, outbreak detection, survey analysis, causal diagrams, survival analysis, GIS basics, phylogenetic trees, automated reports, etc…","code":""},{"path":"index.html","id":"how-to-read-this-handbook","chapter":"","heading":"How to read this handbook","text":"Online versionSearch via search box Table ContentsClick “copy” icons copy codeSee “Resources” section page resourcesTo download data “follow-along”, see [Download book data] pageOffline versionTo download offline version, follow step--step instructions [Download book data] page.LanguagesWe actively seeking translate book languages English. can help, please contact us epiRhandbook@gmail.com.","code":""},{"path":"index.html","id":"edit-or-contribute","chapter":"","heading":"Edit or contribute","text":"Want share use book? Want offer fix addition?\r\nEmail us epiRhandbook@gmail.com. welcome comments suggestions.can also submit issue pull request Github repository, provide structured feedback via Google survey.","code":""},{"path":"index.html","id":"acknowledgements","chapter":"","heading":"Acknowledgements","text":"","code":""},{"path":"index.html","id":"contributors","chapter":"","heading":"Contributors","text":"book produced collaboration epidemiologists around world, drawing upon experiences organizations including local, state, provincial, national health departments ministries, World Health Organization (), MSF (Médecins Sans Frontières / Doctors without Borders), hospital systems, academic institutions.Editor--Chief: Neale BatraCore team: Neale Batra, Alex Spina, Amrish Baidjoe, Pat Keating, Henry Laurenson-Schafer, Finlay CampbellAuthors: Neale Batra, Alex Spina, Paula Blomquist, Finlay Campbell, Henry Laurenson-Schafer, Isaac Florence, Natalie Fischer, Aminata Ndiaye, Liza Coyer, Jonny Polonski, Yurie Izawa, Daniel Molling, Sara Hollis, Isha Berry, Wen LinReviewers:","code":""},{"path":"index.html","id":"funding-and-programmatic-support","chapter":"","heading":"Funding and programmatic support","text":"handbook approved product specific organization. Although strive accuracy, provide guarantee content book.handbook project received funding via COVID-19 emergency capacity-building grant Training Programs Epidemiology Public Health Interventions Network (TEPHINET). handbook supported Cooperative Agreement number NU2GGH001873, funded Centers Disease Control Prevention TEPHINET, program Task Force Global Health. contents solely responsibility authors necessarily represent official views Centers Disease Control Prevention, Department Health Human Services, Task Force Global Health, Inc. TEPHINET.Programmatic support provided EPIET Alumni Network (EAN).","code":""},{"path":"index.html","id":"inspiration","chapter":"","heading":"Inspiration","text":"multitude tutorials vignettes provided knowledge development handbook content credited within respective pages.generally, following sources provided inspiration laid groundwork handbook:“R4Epis” project (collaboration MSF RECON)R Epidemics Consortium (RECON)R Data Science book (R4DS)bookdown: Authoring Books Technical Documents R MarkdownNetlify hosts website","code":""},{"path":"index.html","id":"image-credits","chapter":"","heading":"Image credits","text":"Images logo (US CDC Public Health Image Library):2013 Yemen looking mosquito breeding sitesEbola virusSurvey Rajasthan","code":""},{"path":"index.html","id":"terms-of-use-and-license","chapter":"","heading":"Terms of Use and License","text":"work licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.","code":""},{"path":"errors-help.html","id":"errors-help","chapter":"1 Errors & help","heading":"1 Errors & help","text":"PAGE CONSTRUCTIONThis page covers:Common errors suggests solutions troubleshooting themHow get help posting reproducible example (“reprex”) online forum","code":""},{"path":"errors-help.html","id":"interpreting-error-messages","chapter":"1 Errors & help","heading":"1.1 Interpreting error messages","text":"R errors can cryptic times, Google friend. Search error message “R” look recent posts StackExchange.com, stackoverflow.com, community.rstudio.com, twitter (#rstats), forums used programmers filed questions answers. Try find recent posts solved similar problems.much searching find answer problem, consider creating reproducible example (“reprex”) posting question . See sections posting reproducible examples forums.","code":""},{"path":"errors-help.html","id":"common-errors","chapter":"1 Errors & help","heading":"1.2 Common errors","text":", list common errors potential explanations/solutions. borrowed Noam Ross analyzed common forum posts Stack Overflow R error messages (see analysis )","code":""},{"path":"errors-help.html","id":"typo-errors","chapter":"1 Errors & help","heading":"Typo errors","text":"see “unexpected symbol”, check missing commas","code":"Error: unexpected symbol in:\r\n\"  geom_histogram(stat = \"identity\")+\r\n  tidyquant::geom_ma(n=7, size = 2, color = \"red\" lty\""},{"path":"errors-help.html","id":"package-errors","chapter":"1 Errors & help","heading":"Package errors","text":"likely means typed function name incorrectly, forgot install load package.think using dplyr::select() select() function masked MASS::select() - specify dplyr:: re-order package loading dplyr others.common masking errors stem : plyr::summarise() stats::filter(). Consider using conflicted package.","code":"could not find function \"x\"...Error in select(data, var) : unused argument (var)"},{"path":"errors-help.html","id":"object-errors","chapter":"1 Errors & help","heading":"Object errors","text":"see error like try export import: Check spelling file filepath, path contains slashes make sure forward / backward \\. Also make sure used correct file extension (e.g. .csv, .xlsx).means object referencing exist. Perhaps code run properly?means tried access something (element vector list) .","code":"No such file or directory:object 'x' not found Error in 'x': subscript out of bounds"},{"path":"errors-help.html","id":"function-syntax-errors","chapter":"1 Errors & help","heading":"Function syntax errors","text":"error (argument .x missing, default) common mutate() supplying function like recode() replace_na() expects provide column name first argument. easy forget.","code":"# ran recode without re-stating the x variable in mutate(x = recode(x, OLD = NEW)\r\nError: Problem with `mutate()` input `hospital`.\r\nx argument \".x\" is missing, with no default\r\ni Input `hospital` is `recode(...)`."},{"path":"errors-help.html","id":"logic-errors","chapter":"1 Errors & help","heading":"Logic errors","text":"likely means statement applied something TRUE FALSE.","code":"Error in if"},{"path":"errors-help.html","id":"factor-errors","chapter":"1 Errors & help","heading":"Factor errors","text":"see error invalid factor levels, likely column class Factor (contains pre-defined levels) tried add new value . Convert class Character adding new value.","code":"#Tried to add a value (\"Missing\") to a factor (with replace_na operating on a factor)\r\nProblem with `mutate()` input `age_cat`.\r\ni invalid factor level, NA generated\r\ni Input `age_cat` is `replace_na(age_cat, \"Missing\")`.invalid factor level, NA generated"},{"path":"errors-help.html","id":"plotting-errors","chapter":"1 Errors & help","heading":"Plotting errors","text":"Error: Insufficient values manual scale. 3 needed 2 provided.\r\nggplot() scale_fill_manual() values = c(“orange”, “purple”) … insufficient number factor levels … consider whether NA now factor level…probably extra + end ggplot command need delete.","code":"Can't add x object"},{"path":"errors-help.html","id":"miscellaneous","chapter":"1 Errors & help","heading":"Miscellaneous","text":"Consider whether re-arranged piped dplyr verbs didn’t replace pipe middle, didn’t remove pipe end re-arranging.","code":""},{"path":"errors-help.html","id":"github-issues","chapter":"1 Errors & help","heading":"1.3 Github issues","text":"Many R packages projects code hosted website Github.com. can communicate directly authors via website posting “Issue”.Read store work Github page [Collaboration Github].Github, project contained within repository. repository contains code, data, outputs, help documentation, etc. also vehicle communicate authors called “Issues”. See Github page incidence2 package (used make epidemic curves). can see “Issues” tab highlighted yellow. can see 5 open issues.Issues tab, can see open issues. Review ensure problem already addressed. can open new issue clicking green button right. need Github account .read advanced materials handling issues Github repository, check Github documentation Issues.","code":""},{"path":"errors-help.html","id":"reproducible-example","chapter":"1 Errors & help","heading":"1.4 Reproducible example","text":"Providing reproducible example (“reprex”) key getting help posting forum Github issue. People want help , give example can work computer. example :Demonstrate problem encounteredBe minimal, includes data code required reproduce problemBe reproducible, objects (e.g. data), package calls (e.g. library() p_load()) includedAlso, sure post sensitive data reprex! can create example data frames, use one data frames built R (enter data() open list datasets).","code":""},{"path":"errors-help.html","id":"the-reprex-package","chapter":"1 Errors & help","heading":"The reprex package","text":"reprex package can assist making reproducible example:reprex installed tidyverse, load either packageBegin R script creates problem, step--step, starting loading packages data.Copy code clipboard, run following command:see HTML output appear RStudio Viewer pane. contain code warnings, errors, plot outputs. output also copied clipboard, can post directly Github issue forum post.set session_info = TRUE output sessioninfo::session_info() R R package versions includedYou can provide working directory wd =can read arguments possible variations documentation entering ?reprexIn example , ggplot() command run arguemnt date_format = correct - date_labels =.","code":"\n# install/load tidyverse (which includes reprex)\npacman::p_load(tidyverse)\n# load packages\npacman::p_load(\n     tidyverse,  # data mgmt and vizualization\n     outbreaks)  # example outbreak datasets\n\n# flu epidemic case linelist\noutbreak_raw <- outbreaks::fluH7N9_china_2013  # retrieve dataset from outbreaks package\n\n# Clean dataset\noutbreak <- outbreak_raw %>% \n     mutate(across(contains(\"date\"), as.Date))\n\n# Plot epidemic\n\nggplot(data = outbreak)+\n     geom_histogram(\n          mapping = aes(x = date_of_onset),\n          binwidth = 7\n     )+\n  scale_x_date(\n    date_format = \"%d %m\"\n  )\nreprex::reprex()"},{"path":"errors-help.html","id":"posting-to-a-forum","chapter":"1 Errors & help","heading":"Posting to a forum","text":"Read lots forum posts. Get understanding posts well-written, ones .First, decide whether ask question . thoroughly reviewed forum website, trying various search terms, see question already asked?First, decide whether ask question . thoroughly reviewed forum website, trying various search terms, see question already asked?Give question informative title (“Help! isn’t working”).Give question informative title (“Help! isn’t working”).Write question:Write question:Introduce situation problemLink posts similar issues explain answer questionInclude relevant information help someone know context workGive minimal reproducible example R session informationUse proper spelling, grammar, punctuation, break question paragraphs easier readMonitor question posted respond requests clarification. courteous gracious - often people answering volunteering time help . follow-question consider whether separate posted question.Monitor question posted respond requests clarification. courteous gracious - often people answering volunteering time help . follow-question consider whether separate posted question.Mark question answered, get answer meets original request. helps others later quickly recognize solution.Mark question answered, get answer meets original request. helps others later quickly recognize solution.Read posts ask good question Stack overflow code conduct.","code":""},{"path":"errors-help.html","id":"resources","chapter":"1 Errors & help","heading":"1.5 Resources","text":"https://www.r-bloggers.com/2016/06/common-r-programming-errors-faced--beginners/Tidyverse get help!","code":""}]
>>>>>>> master
